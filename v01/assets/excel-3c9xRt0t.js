import{i as ee,r as v,j as e,p as Ge,c as Be,G as Ue,a as ze,b as Ke,R as He}from"./rtfParser-Dp1iI0vO.js";function Ye(s){const a=[];(!s.documentNumber||s.documentNumber.trim()==="")&&a.push("–ü–æ–ª–µ—Ç–æ –ù–æ–º–µ—Ä –µ –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–æ"),(!s.partnerName||s.partnerName.trim()==="")&&a.push("–ü–æ–ª–µ—Ç–æ –ü–∞—Ä—Ç–Ω—å–æ—Ä –µ –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–æ");const l=/^\d{2}\.\d{2}\.\d{4}$/;if(!s.documentDate||!l.test(s.documentDate))a.push("–ù–µ–≤–∞–ª–∏–¥–µ–Ω —Ñ–æ—Ä–º–∞—Ç –Ω–∞ –¥–∞—Ç–∞. –ò–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ dd.mm.yyyy");else{const[h,d,o]=s.documentDate.split(".").map(Number),p=new Date(o,d-1,h);(p.getDate()!==h||p.getMonth()!==d-1||p.getFullYear()!==o)&&a.push("–ù–µ–≤–∞–ª–∏–¥–Ω–∞ –¥–∞—Ç–∞")}return(typeof s.profitMarkupPercent!="number"||s.profitMarkupPercent<0)&&a.push("–ù–∞–¥—Ü–µ–Ω–∫–∞—Ç–∞ —Ç—Ä—è–±–≤–∞ –¥–∞ –±—ä–¥–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª–Ω–æ —á–∏—Å–ª–æ"),{valid:a.length===0,errors:a}}function Je(s,a){const l=parseFloat(s);if(isNaN(l))return s;const h=l*(1+a/100);return(Math.round(h*100)/100).toFixed(2)}function qe(s){let a=0;for(const d of s)if(d.length>15&&d[15]){const o=parseFloat(d[15]);isNaN(o)||(a+=o)}const l=0,h=a;return{totalValue:Math.round(a*100)/100,vatAmount:Math.round(l*100)/100,totalWithVAT:Math.round(h*100)/100}}function Xe(s,a){const l=s.map(d=>[...d]);for(let d=0;d<l.length;d++){const o=l[d];for(;o.length<44;)o.push("");if(o[0]="1",o[1]=a.documentDate,o[2]=a.documentNumber,o[3]=a.partnerName,o[4]=a.partnerEIK||"",o[5]=a.partnerVAT||"",o[14]){const p=Je(o[14],a.profitMarkupPercent);o[14]=p;const j=parseFloat(o[13])||1,E=parseFloat(p);if(!isNaN(E)&&!isNaN(j)){const N=E*j;o[15]=N.toFixed(2)}}o[16]="–î–î–°0",o[17]="2",o[21]="",o[22]="",o[23]="",o[24]="",o[25]="",o[26]="",o[27]="",o[28]="",o[29]="",o[30]="",o[31]="",o[32]="",o[33]="",o[34]="",o[35]="",o[36]="",o[37]="",o[38]="",o[39]="",o[40]="",o[41]="",o[42]="",o[43]=""}const h=qe(l);if(l.length>0){l[0][18]=h.totalWithVAT.toFixed(2),l[0][19]="0",l[0][20]=h.totalWithVAT.toFixed(2);for(let d=1;d<l.length;d++)l[d][18]="",l[d][19]="",l[d][20]=""}return l}async function Qe(s){try{if(typeof Excel>"u")throw new Error("Excel environment not available");if(s.length===0)throw new Error("No sales data to append");await Excel.run(async a=>{const l=a.workbook.worksheets.getActiveWorksheet(),h=l.getUsedRange();h.load(["rowIndex","rowCount"]),await a.sync();const d=h.rowIndex+h.rowCount,o=Math.max(...s.map(E=>E.length)),p=s.map(E=>{const N=[...E];for(;N.length<o;)N.push("");return N}),j=l.getRangeByIndexes(d,0,s.length,o);j.values=p,await a.sync()})}catch(a){throw console.error("Error appending sales data to Excel:",a),new Error("–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤—è–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏ –≤ Excel")}}async function Ze(){try{return typeof Excel>"u"?(console.error("Excel environment not available"),[]):await Excel.run(async s=>{const l=s.workbook.worksheets.getActiveWorksheet().getUsedRangeOrNullObject();if(l.load(["isNullObject","values","rowCount","columnCount"]),await s.sync(),l.isNullObject||l.rowCount===0)return[];const h=l.values,d=[],o=h[0],j=o&&o.some(E=>typeof E=="string"&&(E.includes("–í–∏–¥")||E.includes("–î–æ–∫—É–º–µ–Ω—Ç")||E.includes("–î–∞—Ç–∞")||E.includes("–ü–∞—Ä—Ç–Ω—å–æ—Ä")))?1:0;for(let E=j;E<h.length;E++){const N=h[E],F=[];for(let U=0;U<N.length;U++){const O=N[U],K=O==null?"":String(O);F.push(K)}F.length>0&&F[0]==="4"&&d.push(F)}return d})}catch(s){return console.error("Error reading all purchase invoices from Excel:",s),[]}}const J=s=>s==="7"?ze:ee;var ve;const ae=((ve=ee.columns.find(s=>s.columnNumber===8))==null?void 0:ve.allowedValues)||["–°—Ç–æ–∫–∏","–ú–∞—Ç–µ—Ä–∏–∞–ª–∏","–ü—Ä–æ–¥—É–∫—Ü–∏—è","–£—Å–ª—É–≥–∏","–†–∞–∑—Ö–æ–¥–∏ –∑–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–∏","–ê–≤–∞–Ω—Å","–ü—Ä–∏—Å–ø–∞–¥–∞–Ω–µ –Ω–∞ –∞–≤–∞–Ω—Å","–î—ä–ª–≥–æ—Ç—Ä–∞–π–Ω–∏ –∞–∫—Ç–∏–≤–∏"];var je;const le=((je=ee.columns.find(s=>s.columnNumber===7))==null?void 0:je.allowedValues)||["–°–¢–û–ö–ò","–ú–ê–¢–ï–†–ò–ê–õ–ò","–ü–†–û–î–£–ö–¶–ò–Ø"],B="__MANUAL__",be=(s,a)=>s===B?a.trim():(s||"").trim(),we=(s,a)=>s===B?a.trim():(s||"").trim(),de=[{code:"–ù–ï–†–ï–ì",desc:"–ù–µ—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–∞–Ω–æ –ª–∏—Ü–µ –ø–æ –î–î–°",group:"NO_VAT"},{code:"–î–î–°20",desc:"–û–±–ª. (20%)",group:"VAT_20"},{code:"–î–î–°9",desc:"–û–±–ª. (9%)",group:"VAT_9"},{code:"–î–î–°0",desc:"–û–î (0%)",group:"VAT_0"},{code:"–ë–î–ö",desc:"–ë–µ–∑ –ø—Ä–∞–≤–æ –Ω–∞ –î–ö",group:"NO_VAT"},{code:"–í–û–î",desc:"–í–û–î",group:"VAT_0"},{code:"–û–°–í",desc:"–û–î –∏ –û—Å–≤. –í–û–ü",group:"VAT_0"},{code:"–î–î–°20/9",desc:"–ö–æ–º–±–∏–Ω–∏—Ä–∞–Ω–∞ —Å–¥–µ–ª–∫–∞ 20%/9%/0%",group:"MIXED"},{code:"–î140",desc:"–î-–∫–∏ –ø–æ —á–ª. 140, 146, —á–ª. 173 –ó–î–î–°",group:"VAT_0"},{code:"–î21",desc:"–î-–∫–∏ –Ω–∞ —É-–≥–∏ –ø–æ —á–ª. 21(2) –ó–î–î–° (–ï–°)",group:"VAT_0"},{code:"–î69",desc:"–î-–∫–∏ –ø–æ —á–ª. 69(2) –∏ –¥–∏—Å—Ç. –ø—Ä–æ–¥-–±–∏ (–ï–°)",group:"VAT_0"},{code:"–î–ü–¢–û",desc:"–î-–∫–∏ –∫–∞—Ç–æ –ø–æ—Å—Ä–µ–¥–Ω–∏–∫ –≤ —Ç—Ä–∏—Å—Ç—Ä. –æ–ø–µ—Ä–∞—Ü–∏–∏",group:"VAT_0"},{code:"–ù20",desc:"–ù–∞—á–∏—Å–ª–µ–Ω –¥–∞–Ω—ä–∫ (20%) –≤ –¥—Ä. —Å–ª—É—á–∞–∏",group:"VAT_20"},{code:"–î143",desc:"–î-–∫–∏ –ø–æ —á–ª. 143 (1) –ó–î–î–°",group:"VAT_0"},{code:"–ù1139",desc:"–ù–µ–Ω–∞—á. –Ω–∞ –î–î–°, —Å—ä–≥–ª. —á–ª. 113 (9)",group:"NO_VAT"},{code:"–ü–¢–†",desc:"–ü—Ä–∏–¥–æ–±–∏–≤–∞–Ω–µ –∫–∞—Ç–æ –ø–æ—Å—Ä–µ–¥–Ω–∏–∫ –≤ —Ç—Ä–∏—Å—Ç—Ä–∞–Ω–Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏—è",group:"VAT_0"},{code:"–ü–†–ò–õ21",desc:"–ü—Ä–∏–ª. 2-–Ü/–î–æ—Å—Ç. –ø–æ –ø—Ä–∏–ª. 2 —á–∞—Å—Ç I",group:"NO_VAT"},{code:"–ü–†–ò–õ22",desc:"–ü—Ä–∏–ª. 2-II/–î–æ—Å—Ç. –ø–æ –ø—Ä–∏–ª. 2 —á–∞—Å—Ç II",group:"NO_VAT"},{code:"–ß–î–ö",desc:"–° –ø—Ä–∞–≤–æ –Ω–∞ —á–∞—Å—Ç–∏—á–µ–Ω –î–ö",group:"NO_VAT"}],et=new Set(de.map(s=>s.code)),ce=s=>{const a=(s??"").toString().trim();return a?a.split("-")[0].trim():""},ie=s=>{if(s==null)return NaN;const a=String(s).trim().replace(",",".");if(!a)return NaN;const l=Number(a);return Number.isFinite(l)?l:NaN},Ne=s=>["1","2","3","7"].includes(s),Ce=s=>["4","5","6"].includes(s),tt=s=>{const a=((s==null?void 0:s[0])??"").toString().trim(),l=((s==null?void 0:s[16])??"").toString().trim(),h=ie(s==null?void 0:s[19]),d=ie(s==null?void 0:s[25]),o=ie(s==null?void 0:s[26]),p=ce(l),j=de.find(N=>N.code===p);if(j)return j.group;if(Number.isFinite(h)&&h>0){const N=Number.isFinite(d)&&d>0,F=Number.isFinite(o)&&o>0;return N&&F?"MIXED":F?"VAT_9":"VAT_20"}return Number.isFinite(d)&&d>0||Number.isFinite(o)&&o>0?"ALL":Ne(a)?"VAT_0":(Ce(a),"ALL")},st=(s,a)=>{const l=new Set(["–î140","–î21","–î69","–î–ü–¢–û","–ù20","–î143","–ù1139"]),h=new Set(["–ü–¢–†","–ü–†–ò–õ21","–ü–†–ò–õ22","–ß–î–ö"]),d=Ne(s),o=Ce(s);return de.filter(p=>(a==="ALL"?!0:p.group===a)?l.has(p.code)?d:h.has(p.code)?o:!0:!1)},nt=(s,a)=>st(s,a).map(h=>h.code).join(","),ot=()=>{const[s,a]=v.useState([]),[l,h]=v.useState(!1),[d,o]=v.useState(!1),[p,j]=v.useState(null),[E,N]=v.useState(null),[F,U]=v.useState(""),[O,K]=v.useState("gemini-2.0-flash"),[Ee,z]=v.useState(!1),[q,X]=v.useState(!1),[Ae,ue]=v.useState(!1),[$,Se]=v.useState("4"),[Q,Te]=v.useState(ae[0]||"–°—Ç–æ–∫–∏"),[H,ke]=v.useState(le[0]||"–ú–ê–¢–ï–†–ò–ê–õ–ò"),[te,me]=v.useState(""),[se,ge]=v.useState(""),[Re,ne]=v.useState(!1),[he,oe]=v.useState(!1),[_,Y]=v.useState({documentNumber:"",partnerName:"",partnerEIK:"",partnerVAT:"",documentDate:(()=>{const t=new Date,n=String(t.getDate()).padStart(2,"0"),i=String(t.getMonth()+1).padStart(2,"0"),r=t.getFullYear();return`${n}.${i}.${r}`})(),profitMarkupPercent:40}),Z=v.useRef(null);v.useEffect(()=>{if(typeof Office<"u")Office.onReady(()=>{Fe()});else{const t=localStorage.getItem("gemini_api_key"),n=localStorage.getItem("gemini_model");t&&U(t),n&&K(n),t||z(!0)}},[]),v.useEffect(()=>{const t=n=>{q&&(n.target.closest(".model-selector-container")||X(!1))};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[q]);const Fe=()=>{try{if(typeof Office<"u"&&Office.context&&Office.context.roamingSettings){const t=Office.context.roamingSettings.get("gemini_api_key"),n=Office.context.roamingSettings.get("gemini_model");t&&U(t),n&&K(n),t||z(!0)}else{const t=localStorage.getItem("gemini_api_key"),n=localStorage.getItem("gemini_model");t&&U(t),n&&K(n),t||z(!0)}}catch(t){console.error("Error loading API keys:",t),z(!0)}},f=t=>{N(t),ue(!0)},_e=()=>{N(null),ue(!1)},xe=(t,n)=>{try{typeof Office<"u"&&Office.context&&Office.context.roamingSettings?(t&&Office.context.roamingSettings.set("gemini_api_key",t),Office.context.roamingSettings.set("gemini_model",n),Office.context.roamingSettings.saveAsync()):(t&&localStorage.setItem("gemini_api_key",t),localStorage.setItem("gemini_model",n)),t&&U(t),K(n),z(!1),N(null)}catch(i){console.error("Error saving API keys:",i),f("–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –∑–∞–ø–∞–∑–≤–∞–Ω–µ –Ω–∞ API –∫–ª—é—á–∞. –û–ø–∏—Ç–∞–π—Ç–µ –æ—Ç–Ω–æ–≤–æ.")}},Ve=t=>{const n=t.target.files;if(!n||n.length===0)return;const i=[];for(let r=0;r<n.length;r++){const u=n[r];let m=null;if(u.type.startsWith("image/")){const w=new FileReader;w.onload=y=>{var k;m=(k=y.target)==null?void 0:k.result,a(A=>[...A,{file:u,preview:m}])},w.readAsDataURL(u)}else i.push({file:u,preview:m})}i.length>0&&a(r=>[...r,...i]),j(null),N(null)},Ie=t=>{a(n=>n.filter((i,r)=>r!==t))},pe=()=>{a([]),j(null),N(null),ne(!1),oe(!1),Z.current&&(Z.current.value="")},Oe=(t,n,i)=>{var M,V;const r=J(t),u=((M=r.extractionSettings)==null?void 0:M.delimiter)||";",m=((V=r.extractionSettings)==null?void 0:V.minimumColumns)||44,w=r.columns.slice(0,m).map((I,C)=>`${C+1}. ${I.name} - ${I.description}`).join(`
`),k={1:"–§–∞–∫—Ç—É—Ä–∞ –ø—Ä–æ–¥–∞–∂–±–∞",2:"–î–µ–±–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø—Ä–æ–¥–∞–∂–±–∞",3:"–ö—Ä–µ–¥–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø—Ä–æ–¥–∞–∂–±–∞",4:"–§–∞–∫—Ç—É—Ä–∞ –ø–æ–∫—É–ø–∫–∞",5:"–î–µ–±–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø–æ–∫—É–ø–∫–∞",6:"–ö—Ä–µ–¥–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø–æ–∫—É–ø–∫–∞",7:"–ö–∞—Å–æ–≤–∏ –ø—Ä–æ–¥–∞–∂–±–∏",8:"–¢—Ä–∞–Ω—Å—Ñ–µ—Ä",9:"–ë—Ä–∞–∫ (–†–ê–ó–•–û–î)",10:"–ë—Ä–∞–∫ (–ú–û–õ)",11:"–°–∫–ª–∞–¥–æ–≤–æ –∏—Å–∫–∞–Ω–µ",12:"–°—Ç–æ–∫–æ–≤–∞ —Ä–∞–∑–ø–∏—Å–∫–∞ (–°–¢)",13:"–°–∫–ª–∞–¥–æ–≤–∞ —Ä–∞–∑–ø–∏—Å–∫–∞ (–°–†)",14:"–î–∞–≤–∞–Ω–µ —Å—Ç–æ–∫–∏ –Ω–∞ –∫–æ–Ω—Å–∏–≥–Ω–∞—Ü–∏—è (–ö–î) —Å—ä—Å —Å—á–µ—Ç. –æ–ø–µ—Ä–∞—Ü–∏–∏",15:"–î–∞–≤–∞–Ω–µ —Å—Ç–æ–∫–∏ –Ω–∞ –∫–æ–Ω—Å–∏–≥–Ω–∞—Ü–∏—è (–ö–î) –±–µ–∑ —Å—á–µ—Ç. –æ–ø–µ—Ä–∞—Ü–∏–∏"}[t]||"",A=`
–õ–û–ì–ò–ö–ê –ó–ê –û–ü–†–ï–î–ï–õ–Ø–ù–ï –ù–ê –ü–ê–†–¢–ù–¨–û–†–ê –°–ü–û–†–ï–î –í–ò–î. –î–û–ö–£–ú–ï–ù–¢ (${t}${k?` ‚Äì ${k}`:""}):

- –ê–∫–æ –í–∏–¥. –î–æ–∫—É–º–µ–Ω—Ç –µ 1, 2, 3 –∏–ª–∏ 7 (—Ñ–∞–∫—Ç—É—Ä–∞/–∏–∑–≤–µ—Å—Ç–∏–µ –ø—Ä–æ–¥–∞–∂–±–∞, –∫–∞—Å–æ–≤–∏ –ø—Ä–æ–¥–∞–∂–±–∏):
  ‚Ä¢ –ù–∞—à–∞—Ç–∞ —Ñ–∏—Ä–º–∞ –µ –ò–ó–î–ê–¢–ï–õ/–î–û–°–¢–ê–í–ß–ò–ö.
  ‚Ä¢ –ü–∞—Ä—Ç–Ω—å–æ—Ä (–∫–æ–ª–æ–Ω–∏ 4‚Äì6) –µ –ü–û–õ–£–ß–ê–¢–ï–õ/–ö–£–ü–£–í–ê–ß (–∫–ª–∏–µ–Ω—Ç—ä—Ç).

- –ê–∫–æ –í–∏–¥. –î–æ–∫—É–º–µ–Ω—Ç –µ 4, 5 –∏–ª–∏ 6 (—Ñ–∞–∫—Ç—É—Ä–∞/–∏–∑–≤–µ—Å—Ç–∏–µ –ø–æ–∫—É–ø–∫–∞):
  ‚Ä¢ –ù–∞—à–∞—Ç–∞ —Ñ–∏—Ä–º–∞ –µ –ü–û–õ–£–ß–ê–¢–ï–õ/–ö–£–ü–£–í–ê–ß.
  ‚Ä¢ –ü–∞—Ä—Ç–Ω—å–æ—Ä (–∫–æ–ª–æ–Ω–∏ 4‚Äì6) –µ –ò–ó–î–ê–¢–ï–õ/–î–û–°–¢–ê–í–ß–ò–ö (–¥–æ—Å—Ç–∞–≤—á–∏–∫—ä—Ç).

- –ê–∫–æ –í–∏–¥. –î–æ–∫—É–º–µ–Ω—Ç –µ –æ—Ç 8 –¥–æ 15:
  ‚Ä¢ –ê–∫–æ –¥–æ–∫—É–º–µ–Ω—Ç—ä—Ç —Å—ä–¥—ä—Ä–∂–∞ –≤—ä–Ω—à–µ–Ω –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç (–¥—Ä—É–≥–∞ —Ñ–∏—Ä–º–∞ –∏–∑–≤—ä–Ω –Ω–∞—à–∞—Ç–∞) ‚Äì –∏–∑–ø–æ–ª–∑–≤–∞–π –Ω–µ–≥–æ –∫–∞—Ç–æ –ü–∞—Ä—Ç–Ω—å–æ—Ä (–∫–æ–ª–æ–Ω–∏ 4‚Äì6).
  ‚Ä¢ –ê–∫–æ –¥–æ–∫—É–º–µ–Ω—Ç—ä—Ç –µ —á–∏—Å—Ç–æ –≤—ä—Ç—Ä–µ—à–µ–Ω (–º–µ–∂–¥—É –Ω–∞—à–∏ —Å–∫–ª–∞–¥–æ–≤–µ/–æ–±–µ–∫—Ç–∏) ‚Äì –æ—Å—Ç–∞–≤–∏ –∫–æ–ª–æ–Ω–∏ 4‚Äì6 –ø—Ä–∞–∑–Ω–∏.

–ö–æ–ª–æ–Ω–∞ 4 ‚Äû–ü–∞—Ä—Ç–Ω—å–æ—Ä‚Äú –∏ –∫–æ–ª–æ–Ω–∞ 5 ‚Äû–ï–ò–ö‚Äú –í–ò–ù–ê–ì–ò –æ–ø–∏—Å–≤–∞—Ç –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞ (–¥—Ä—É–≥–∞—Ç–∞ —Å—Ç—Ä–∞–Ω–∞ –ø–æ —Å–¥–µ–ª–∫–∞—Ç–∞), –∞ –Ω–µ –Ω–∞—à–∞—Ç–∞ —Ñ–∏—Ä–º–∞.
`.trim();return`–¢–∏ —Å–∏ –µ–∫—Å–ø–µ—Ä—Ç –ø–æ –∏–∑–≤–ª–∏—á–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏ –æ—Ç —Ñ–∞–∫—Ç—É—Ä–∏ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –Ω–∞ CSV —Ñ–∞–π–ª–æ–≤–µ –∑–∞ –±—ä–ª–≥–∞—Ä—Å–∫–∞ —Å—á–µ—Ç–æ–≤–æ–¥–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –ü–ª—é—Å –ú–∏–Ω—É—Å.

–í–ê–ñ–ù–ê –ò–ù–§–û–†–ú–ê–¶–ò–Ø:
- –¢–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç (–∏–∑–±—Ä–∞–Ω –æ—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è): ${t}${k?` ‚Äì ${k}`:""}
- –¢–æ–∑–∏ –Ω–æ–º–µ—Ä –¢–†–Ø–ë–í–ê –¥–∞ –±—ä–¥–µ –ø–æ—Å—Ç–∞–≤–µ–Ω –≤ –ö–û–õ–û–ù–ê 1 (–ø—ä—Ä–≤–∞—Ç–∞ –∫–æ–ª–æ–Ω–∞) –Ω–∞ –í–°–ï–ö–ò —Ä–µ–¥ –æ—Ç –∏–∑–≤–ª–µ—á–µ–Ω–∏—Ç–µ –¥–∞–Ω–Ω–∏.
- –í–∏–¥ –Ω–∞ –∞—Ä—Ç–∏–∫—É–ª–∞ (–∏–∑–±—Ä–∞–Ω –æ—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è): ${n}
- –¢–∞–∑–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç –¢–†–Ø–ë–í–ê –¥–∞ –±—ä–¥–µ –ø–æ—Å—Ç–∞–≤–µ–Ω–∞ –≤ –ö–û–õ–û–ù–ê 8 (–í–∏–¥) –Ω–∞ –í–°–ï–ö–ò —Ä–µ–¥ –æ—Ç –∏–∑–≤–ª–µ—á–µ–Ω–∏—Ç–µ –¥–∞–Ω–Ω–∏.
- –û–±–µ–∫—Ç–∏ (–∏–∑–±—Ä–∞–Ω –æ—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è): ${i}
- –¢–∞–∑–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç –¢–†–Ø–ë–í–ê –¥–∞ –±—ä–¥–µ –ø–æ—Å—Ç–∞–≤–µ–Ω–∞ –≤ –ö–û–õ–û–ù–ê 7 –Ω–∞ –í–°–ï–ö–ò —Ä–µ–¥ –æ—Ç –∏–∑–≤–ª–µ—á–µ–Ω–∏—Ç–µ –¥–∞–Ω–Ω–∏.

${A}

–í –ï–î–ò–ù PDF –ú–û–ñ–ï –î–ê –ò–ú–ê –ù–Ø–ö–û–õ–ö–û –î–û–ö–£–ú–ï–ù–¢–ê:
- –û–±—Ä–∞–±–æ—Ç–≤–∞–π –≤—Å–µ–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç –ø–æ–æ—Ç–¥–µ–ª–Ω–æ.
- –ó–∞ –≤—Å–µ–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç —Å—ä–∑–¥–∞–≤–∞–π –æ—Ç–¥–µ–ª–Ω–∏ —Ä–µ–¥–æ–≤–µ –≤ CSV.

–ï–î–ò–ù CSV –†–ï–î = –ï–î–ù–ê –ü–û–ó–ò–¶–ò–Ø –û–¢ –î–û–ö–£–ú–ï–ù–¢–ê:
- –ó–∞ –í–°–Ø–ö–ê –ü–û–ó–ò–¶–ò–Ø (–∞—Ä—Ç–∏–∫—É–ª, —Ä–µ–¥ –æ—Ç —Ñ–∞–∫—Ç—É—Ä–∞—Ç–∞) —Å—ä–∑–¥–∞–π –æ—Ç–¥–µ–ª–µ–Ω —Ä–µ–¥.
- –ù–∞—á–∞–ª–Ω–∏—Ç–µ –ø–æ–ª–µ—Ç–∞ (–∫–æ–ª–æ–Ω–∏ 1‚Äì${m}) —Å–∞ –µ–¥–Ω–∞–∫–≤–∏ –∑–∞ –≤—Å–∏—á–∫–∏ —Ä–µ–¥–æ–≤–µ –æ—Ç –µ–¥–∏–Ω –¥–æ–∫—É–º–µ–Ω—Ç.
- –ü–æ–ª–µ—Ç–∞—Ç–∞ –∑–∞ –æ–±—â–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ (–û–±—â–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç, –î–î–°, –ü–ª–∞—Ç–µ–Ω–æ –∏ —Ç.–Ω.) —Å–µ –ø–æ–ø—ä–ª–≤–∞—Ç –°–ê–ú–û –Ω–∞ –ü–™–†–í–ò–Ø —Ä–µ–¥ –∑–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞.

CSV –§–û–†–ú–ê–¢:
- –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª –Ω–∞ –∫–æ–ª–æ–Ω–∏: "${u}"
- –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª –Ω–∞ —Ä–µ–¥–æ–≤–µ: CRLF (\\r\\n)
- –ë–ï–ó –∑–∞–≥–ª–∞–≤–µ–Ω —Ä–µ–¥.
- –í—Å–µ–∫–∏ —Ä–µ–¥ = –ï–î–ù–ê –ø–æ–∑–∏—Ü–∏—è (–∞—Ä—Ç–∏–∫—É–ª) –æ—Ç –¥–∞–¥–µ–Ω –¥–æ–∫—É–º–µ–Ω—Ç.

–ö–û–õ–û–ù–ò (–ú–ò–ù–ò–ú–£–ú ${m} –∫–æ–ª–æ–Ω–∏):
${w}

–í–ê–ñ–ù–ò –ü–†–ê–í–ò–õ–ê:
1. –ö–û–õ–û–ù–ê 1 –í–ò–ù–ê–ì–ò —Å—ä–¥—ä—Ä–∂–∞ –Ω–æ–º–µ—Ä–∞ –Ω–∞ —Ç–∏–ø–∞ –¥–æ–∫—É–º–µ–Ω—Ç: ${t}
2. –ö–û–õ–û–ù–ê 7 –í–ò–ù–ê–ì–ò —Å—ä–¥—ä—Ä–∂–∞ –æ–±–µ–∫—Ç–∞: ${i}
3. –ö–û–õ–û–ù–ê 8 –í–ò–ù–ê–ì–ò —Å—ä–¥—ä—Ä–∂–∞ –≤–∏–¥–∞ –Ω–∞ –∞—Ä—Ç–∏–∫—É–ª–∞: ${n}
4. –í–ò–ù–ê–ì–ò –∏–∑–≤–µ–∂–¥–∞–π –ú–ò–ù–ò–ú–£–ú ${m} –∫–æ–ª–æ–Ω–∏ (1‚Äì${m}).
3. –ê–∫–æ –∏–º–∞—à –Ω–∞–¥–µ–∂–¥–Ω–∏ –¥–∞–Ω–Ω–∏ –∑–∞ –∫–æ–ª–æ–Ω–∏ —Å–ª–µ–¥ ${m}, –¥–æ–±–∞–≤–∏ –≥–∏ (–¥–æ –º–∞–∫—Å–∏–º—É–º ${ee.columns.length} –∫–æ–ª–æ–Ω–∏).
4. –ê–∫–æ –∫–æ–ª–æ–Ω–∞ –Ω—è–º–∞ –¥–∞–Ω–Ω–∏, –æ—Å—Ç–∞–≤–∏ —è –ø—Ä–∞–∑–Ω–∞ (–¥–≤–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–Ω–∏ "${u}").
5. –ö–æ–ª–æ–Ω–∞ 4 ‚Äû–ü–∞—Ä—Ç–Ω—å–æ—Ä‚Äú –∏ –∫–æ–ª–æ–Ω–∞ 5 ‚Äû–ï–ò–ö‚Äú –æ–ø–∏—Å–≤–∞—Ç –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞ (–¥—Ä—É–≥–∞—Ç–∞ —Å—Ç—Ä–∞–Ω–∞ –ø–æ —Å–¥–µ–ª–∫–∞—Ç–∞).

6. –î–∞—Ç–∏—Ç–µ —Å–∞ –≤—ä–≤ —Ñ–æ—Ä–º–∞—Ç dd.mm.yyyy.
7. –ß–∏—Å–ª–∞—Ç–∞ —Å–∞ –±–µ–∑ –≤–∞–ª—É—Ç–Ω–∏ —Å–∏–º–≤–æ–ª–∏.
8. –ù–µ –∏–∑–ø–æ–ª–∑–≤–∞–π —Å–∏–º–≤–æ–ª–∏ " ' / \\ & –≤ —Ç–µ–∫—Å—Ç–æ–≤–∏ –ø–æ–ª–µ—Ç–∞.

–î–û–ü–™–õ–ù–ò–¢–ï–õ–ù–ò –ò–ù–°–¢–†–£–ö–¶–ò–ò:
${r.extractionInstructions?r.extractionInstructions.map((I,C)=>`${C+1}. ${I}`).join(`
`):"–ù—è–º–∞ –¥–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∑–∞ —Ç–æ–∑–∏ —Ç–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç."}

–ò–ó–•–û–î:
–í—ä—Ä–Ω–∏ –°–ê–ú–û CSV –¥–∞–Ω–Ω–∏—Ç–µ, –±–µ–∑ –¥–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–µ–Ω —Ç–µ–∫—Å—Ç, –æ–±—è—Å–Ω–µ–Ω–∏—è –∏–ª–∏ markdown.
–ó–∞–ø–æ—á–Ω–∏ –¥–∏—Ä–µ–∫—Ç–Ω–æ —Å —Ä–µ–¥/—Ä–µ–¥–æ–≤–µ —Å –¥–∞–Ω–Ω–∏ (–ë–ï–ó –∑–∞–≥–ª–∞–≤–∏—è).
–í—Å–µ–∫–∏ —Ä–µ–¥ –¢–†–Ø–ë–í–ê –¥–∞ –∏–º–∞ –ú–ò–ù–ò–ú–£–ú ${m} —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ (–∫–æ–ª–æ–Ω–∏), —Ä–∞–∑–¥–µ–ª–µ–Ω–∏ —Å "${u}".
–ö–û–õ–û–ù–ê 1 –Ω–∞ –≤—Å–µ–∫–∏ —Ä–µ–¥ –¢–†–Ø–ë–í–ê –¥–∞ —Å—ä–¥—ä—Ä–∂–∞: ${t}
–ö–û–õ–û–ù–ê 7 –Ω–∞ –≤—Å–µ–∫–∏ —Ä–µ–¥ –¢–†–Ø–ë–í–ê –¥–∞ —Å—ä–¥—ä—Ä–∂–∞: ${i}
–ö–û–õ–û–ù–ê 8 –Ω–∞ –≤—Å–µ–∫–∏ —Ä–µ–¥ –¢–†–Ø–ë–í–ê –¥–∞ —Å—ä–¥—ä—Ä–∂–∞: ${n}`},fe=async()=>{var m,w,y,k,A,M,V,I;if(s.length===0)return;if(!$){f("–ú–æ–ª—è, –∏–∑–±–µ—Ä–µ—Ç–µ —Ç–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç.");return}if(!F){f("–ú–æ–ª—è, –≤—ä–≤–µ–¥–µ—Ç–µ Gemini API –∫–ª—é—á."),z(!0);return}const t=be(Q,te),n=we(H,se);if(!t){f('–ú–æ–ª—è, –∏–∑–±–µ—Ä–µ—Ç–µ "–í–∏–¥ –Ω–∞ –∞—Ä—Ç–∏–∫—É–ª–∞" –∏–ª–∏ –≤—ä–≤–µ–¥–µ—Ç–µ —Ä—ä—á–Ω–æ —Å—Ç–æ–π–Ω–æ—Å—Ç.');return}if(H!==B&&!n){f('–ú–æ–ª—è, –∏–∑–±–µ—Ä–µ—Ç–µ "–û–±–µ–∫—Ç–∏" –∏–ª–∏ –≤—ä–≤–µ–¥–µ—Ç–µ —Ä—ä—á–Ω–æ —Å—Ç–æ–π–Ω–æ—Å—Ç.');return}h(!0),N(null),j(null),X(!1);const i=J($),r=(m=i.extractionSettings)==null?void 0:m.delimiter,u=(w=i.extractionSettings)==null?void 0:w.minimumColumns;try{const C=[];for(let R=0;R<s.length;R++){const{file:P}=s[R],c=new FileReader,b=await new Promise((T,L)=>{c.onload=G=>{var ye;const re=((ye=G.target)==null?void 0:ye.result).split(",")[1];T(re)},c.onerror=L,c.readAsDataURL(P)}),g=Oe($,t,n);let x="";if(O==="gemini-2.5-flash"||O==="gemini-2.5-pro"){const T=`https://generativelanguage.googleapis.com/v1/models/${O}:generateContent?key=${F}`,L={contents:[{parts:[{text:g},{inline_data:{mime_type:P.type,data:b}}]}]},G=await fetch(T,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(L)});if(!G.ok){const re=await G.json();throw new Error(`Gemini API error: ${((y=re.error)==null?void 0:y.message)||G.statusText}`)}x=((I=(V=(M=(A=(k=(await G.json()).candidates)==null?void 0:k[0])==null?void 0:A.content)==null?void 0:M.parts)==null?void 0:V[0])==null?void 0:I.text)||""}else x=((await new Ue({apiKey:F}).chats.create({model:O}).sendMessage({message:[{text:g},{inlineData:{mimeType:P.type,data:b}}]})).text||"").trim();let S=x.trim();S.startsWith("```")&&(S=S.replace(/```csv\n?/gi,"").replace(/```\n?/g,"").trim());const W=S.split(/\r?\n/).map(T=>T.trim()).filter(T=>T.length>0);for(const T of W){const L=T.split(r);for(;L.length<u;)L.push("");C.push(L)}}if(C.length===0)f("–ù–µ –±—è—Ö–∞ –Ω–∞–º–µ—Ä–µ–Ω–∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏ –¥–∞–Ω–Ω–∏ –æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ç–µ –∏–ª–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç—ä—Ç –µ –ø—Ä–∞–∑–µ–Ω."),j(null);else{const R=`invoices_${Date.now()}.csv`;j({rows:C,fileName:R})}}catch(C){console.error(C),f(C instanceof Error?C.message:"–í—ä–∑–Ω–∏–∫–Ω–∞ –≥—Ä–µ—à–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞—Ç–∞ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ç–µ.")}finally{h(!1)}},$e=async()=>{if(s.length===0)return;if($!=="7"){f("RTF –æ–±—Ä–∞–±–æ—Ç–∫–∞—Ç–∞ –µ –¥–æ—Å—Ç—ä–ø–Ω–∞ —Å–∞–º–æ –∑–∞ –¥–æ–∫—É–º–µ–Ω—Ç —Ç–∏–ø 7 - –ö–∞—Å–æ–≤–∏ –ø—Ä–æ–¥–∞–∂–±–∏.");return}const t=be(Q,te),n=we(H,se);if(!t){f('–ú–æ–ª—è, –∏–∑–±–µ—Ä–µ—Ç–µ "–í–∏–¥ –Ω–∞ –∞—Ä—Ç–∏–∫—É–ª–∞" –∏–ª–∏ –≤—ä–≤–µ–¥–µ—Ç–µ —Ä—ä—á–Ω–æ —Å—Ç–æ–π–Ω–æ—Å—Ç.');return}if(H!==B&&!n){f('–ú–æ–ª—è, –∏–∑–±–µ—Ä–µ—Ç–µ "–û–±–µ–∫—Ç–∏" –∏–ª–∏ –≤—ä–≤–µ–¥–µ—Ç–µ —Ä—ä—á–Ω–æ —Å—Ç–æ–π–Ω–æ—Å—Ç.');return}o(!0),N(null),j(null);try{const i=[];for(let r=0;r<s.length;r++){const{file:u}=s[r],m=u.name.toLowerCase().endsWith(".rtf")||u.type==="application/rtf"||u.type==="text/rtf",w=u.name.toLowerCase().endsWith(".doc")||u.name.toLowerCase().endsWith(".docx")||u.type==="application/msword"||u.type==="application/vnd.openxmlformats-officedocument.wordprocessingml.document";if(!m&&!w){f(`–§–∞–π–ª—ä—Ç "${u.name}" –Ω–µ –µ RTF –∏–ª–∏ Word —Ñ–æ—Ä–º–∞—Ç. –ú–æ–ª—è, –∏–∑–±–µ—Ä–µ—Ç–µ .rtf –∏–ª–∏ .doc/.docx —Ñ–∞–π–ª.`);continue}const y=new FileReader,k=await new Promise((V,I)=>{y.onload=C=>{var P;const R=(P=C.target)==null?void 0:P.result;V(R)},y.onerror=I,y.readAsText(u,"utf-8")}),A=Ge(k),M=Be(A,$,t,n);i.push(...M)}if(i.length===0)f("–ù–µ –±—è—Ö–∞ –Ω–∞–º–µ—Ä–µ–Ω–∏ –¥–∞–Ω–Ω–∏ –∑–∞ –∏–∑–≤–ª–∏—á–∞–Ω–µ –æ—Ç RTF —Ñ–∞–π–ª–æ–≤–µ—Ç–µ."),j(null);else{const r=`cash_sales_rtf_${Date.now()}.csv`;j({rows:i,fileName:r})}}catch(i){console.error(i),f(i instanceof Error?i.message:"–í—ä–∑–Ω–∏–∫–Ω–∞ –≥—Ä–µ—à–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞—Ç–∞ –Ω–∞ RTF —Ñ–∞–π–ª–æ–≤–µ—Ç–µ.")}finally{o(!1)}},Me=async()=>{try{if(typeof Excel>"u"){f("Excel –æ–±–∫—Ä—ä–∂–µ–Ω–∏–µ—Ç–æ –Ω–µ –µ –Ω–∞–ª–∏—á–Ω–æ. –¢–∞–∑–∏ —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞–±–æ—Ç–∏ —Å–∞–º–æ –∫–∞—Ç–æ Excel Add-in.");return}await Excel.run(async t=>{var g;const i=t.workbook.worksheets.getActiveWorksheet().getUsedRangeOrNullObject();if(i.load(["isNullObject","values","rowCount","columnCount"]),await t.sync(),i.isNullObject||i.rowCount===0){f("–ù—è–º–∞ –¥–∞–Ω–Ω–∏ –≤ Excel —Ç–∞–±–ª–∏—Ü–∞—Ç–∞ –∑–∞ –µ–∫—Å–ø–æ—Ä—Ç–∏—Ä–∞–Ω–µ.");return}const r=i.values,m=((g=J("4").extractionSettings)==null?void 0:g.delimiter)||";",w=[],y=r[0],A=y&&y.some(x=>typeof x=="string"&&(x.includes("–í–∏–¥")||x.includes("–î–æ–∫—É–º–µ–Ω—Ç")||x.includes("–î–∞—Ç–∞")||x.includes("–ü–∞—Ä—Ç–Ω—å–æ—Ä")))?1:0;for(let x=A;x<r.length;x++){const S=r[x].map(W=>W==null?"":String(W)).join(m);w.push(S)}if(w.length===0){f("–ù—è–º–∞ –¥–∞–Ω–Ω–∏ –∑–∞ –µ–∫—Å–ø–æ—Ä—Ç–∏—Ä–∞–Ω–µ (—Å–∞–º–æ –∑–∞–≥–ª–∞–≤–µ–Ω —Ä–µ–¥).");return}const M=w.join(`\r
`),V=`excel_export_${Date.now()}.csv`,I="\uFEFF",C=new Blob([I+M],{type:"text/csv;charset=utf-8;"}),R=document.createElement("a"),P=URL.createObjectURL(C);R.setAttribute("href",P),R.setAttribute("download",V),R.style.visibility="hidden",document.body.appendChild(R),R.click(),document.body.removeChild(R),URL.revokeObjectURL(P);const c=`–£—Å–ø–µ—Ö! –ï–∫—Å–ø–æ—Ä—Ç–∏—Ä–∞–Ω–∏ ${w.length} —Ä–µ–¥–∞ –≤ ${V}`,b=document.createElement("div");b.className="fixed top-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-50",b.textContent=c,document.body.appendChild(b),setTimeout(()=>{document.body.removeChild(b)},3e3)})}catch(t){console.error(t),f(t instanceof Error?t.message:"–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –µ–∫—Å–ø–æ—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ –æ—Ç Excel.")}},Pe=async()=>{if(!(!p||!p.rows.length))try{if(typeof Excel>"u"){f("Excel –æ–±–∫—Ä—ä–∂–µ–Ω–∏–µ—Ç–æ –Ω–µ –µ –Ω–∞–ª–∏—á–Ω–æ. –¢–∞–∑–∏ —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞–±–æ—Ç–∏ —Å–∞–º–æ –∫–∞—Ç–æ Excel Add-in.");return}await Excel.run(async t=>{var R,P;const n=t.workbook.worksheets.getActiveWorksheet(),i=J($),r=Math.min(i.columns.length,100),u=p.rows,m=u.length;if(m===0){f("–ù—è–º–∞ –¥–∞–Ω–Ω–∏ –∑–∞ –≤–º—ä–∫–≤–∞–Ω–µ.");return}if(m>1e6){f("–¢–≤—ä—Ä–¥–µ –º–Ω–æ–≥–æ —Ä–µ–¥–æ–≤–µ –¥–∞–Ω–Ω–∏. Excel –ø–æ–¥–¥—ä—Ä–∂–∞ –º–∞–∫—Å–∏–º—É–º 1,048,576 —Ä–µ–¥–∞.");return}const w=i.columns.slice(0,r).map(c=>c.name);let y=0,k=!1;const A=n.getUsedRangeOrNullObject();if(A.load(["isNullObject","rowCount","columnCount","rowIndex"]),await t.sync(),A.isNullObject||A.rowCount===0)k=!0,y=1;else{const c=Math.max(3,Math.min(r,A.columnCount||r)),b=n.getRangeByIndexes(0,0,1,c);b.load("values"),await t.sync();const g=(((R=b.values)==null?void 0:R[0])||[]).map(D=>String(D??"").trim());k=!(g[0]===w[0]&&g[1]===w[1]&&g[2]===w[2])&&A.rowCount===0,y=A.rowIndex+A.rowCount}const M=u.map((c,b)=>{const g=[...c];for(;g.length<r;)g.push("");return g.length>r&&(g.length=r),g.map((x,D)=>{if(x==null)return"";const S=String(x);return S.length>32767?(console.warn(`Cell [${b}][${D}] truncated - too long for Excel`),S.substring(0,32767)):D===16?ce(S):S})});if(k){const c=n.getRangeByIndexes(0,0,1,r);c.values=[w],c.format.font.bold=!0,c.format.fill.color="#4472C4",c.format.font.color="#FFFFFF",await t.sync(),y=1}const V=n.getRangeByIndexes(y,0,m,r);try{[3,5,6,12].forEach(b=>{if(b<=r){const g=n.getRangeByIndexes(y,b-1,m,1);g.numberFormat="@"}}),await t.sync()}catch(c){console.warn("Could not apply text formatting:",c)}try{V.values=M,await t.sync()}catch(c){throw console.error("Error setting values:",c),new Error("–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –∑–∞–ø–∏—Å–≤–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ –≤ Excel. –ú–æ–ª—è, –ø—Ä–æ–≤–µ—Ä–µ—Ç–µ —Ñ–æ—Ä–º–∞—Ç–∞ –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ.")}try{[15,16,19,20,21,26,27,33,34,35,39,40,41].forEach(b=>{if(b<=r){const g=n.getRangeByIndexes(y,b-1,m,1);g.numberFormat="0.00##########"}}),await t.sync()}catch(c){console.warn("Could not apply money formatting:",c)}try{if(7<=r){const c=n.getRangeByIndexes(y,6,m,1),b=le.join(",");c.dataValidation.rule={list:{inCellDropDown:!0,source:b}},c.dataValidation.errorAlert={showAlert:!1,title:"–°—Ç–æ–π–Ω–æ—Å—Ç –∏–∑–≤—ä–Ω —Å–ø–∏—Å—ä–∫–∞",message:"–ú–æ–∂–µ—Ç–µ –¥–∞ –≤—ä–≤–µ–¥–µ—Ç–µ —Ä—ä—á–Ω–æ —Å—Ç–æ–π–Ω–æ—Å—Ç –∏–∑–≤—ä–Ω —Å–ø–∏—Å—ä–∫–∞.",style:"information"}}}catch(c){console.warn("Could not add column 7 validation:",c)}try{if(8<=r){const c=n.getRangeByIndexes(y,7,m,1),b=ae.join(",");c.dataValidation.rule={list:{inCellDropDown:!0,source:b}},c.dataValidation.errorAlert={showAlert:!1,title:"–°—Ç–æ–π–Ω–æ—Å—Ç –∏–∑–≤—ä–Ω —Å–ø–∏—Å—ä–∫–∞",message:"–ú–æ–∂–µ—Ç–µ –¥–∞ –≤—ä–≤–µ–¥–µ—Ç–µ —Ä—ä—á–Ω–æ —Å—Ç–æ–π–Ω–æ—Å—Ç –∏–∑–≤—ä–Ω —Å–ø–∏—Å—ä–∫–∞.",style:"information"}}}catch(c){console.warn("Could not add column 8 validation:",c)}try{if(17<=r){for(let g=0;g<m;g++){const x=n.getRangeByIndexes(y+g,16,1,1),D=M[g]||[],S=(D[0]??"").toString().trim(),W=tt(D),T=nt(S,W);x.dataValidation.rule={list:{inCellDropDown:!0,source:T}}}await t.sync();const c=n.customProperties;c.load("items"),await t.sync(),((P=c.items)==null?void 0:P.some(g=>g.key==="vat_ddsvid_handler_installed"&&g.value==="1"))||(n.onChanged.add(async g=>{try{if(!g.address)return;await Excel.run(async x=>{var L,G;const S=x.workbook.worksheets.getActiveWorksheet().getRange(g.address);if(S.load(["columnIndex","values"]),await x.sync(),S.columnIndex!==16)return;const W=(G=(L=S.values)==null?void 0:L[0])==null?void 0:G[0],T=ce(W);T&&T!==W&&et.has(T)&&(S.values=[[T]],await x.sync())})}catch(x){console.warn("VAT onChanged handler error:",x)}}),c.add("vat_ddsvid_handler_installed","1"),await t.sync())}}catch(c){console.warn("Could not add column 17 validation:",c)}try{V.format.autofitColumns(),await t.sync()}catch(c){console.warn("Could not autofit columns:",c)}$==="4"&&ne(!0);const I=`–£—Å–ø–µ—Ö! ${m} —Ä–µ–¥–∞ —Å–∞ –¥–æ–±–∞–≤–µ–Ω–∏ –Ω–∞ —Ä–µ–¥ ${y+1}.`,C=document.createElement("div");C.className="fixed top-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-50",C.textContent=I,document.body.appendChild(C),setTimeout(()=>{document.body.removeChild(C)},3e3)})}catch(t){console.error(t),f(t instanceof Error?t.message:"–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –≤–º—ä–∫–≤–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ –≤ Excel.")}},Le=(t,n,i)=>{j(r=>{if(!r)return r;const u=r.rows.map((m,w)=>w===t?[...m]:m);if(!u[t])return r;for(;u[t].length<=n;)u[t].push("");return u[t][n]=i,{...r,rows:u}})},De=async()=>{try{const t=Ye(_);if(!t.valid){f(t.errors.join(`
`));return}const n=await Ze();if(n.length===0){f("–ù—è–º–∞ –Ω–∞–º–µ—Ä–µ–Ω–∏ —Ñ–∞–∫—Ç—É—Ä–∏ –∑–∞ –ø–æ–∫—É–ø–∫–∞ –≤ Excel —Ç–∞–±–ª–∏—Ü–∞—Ç–∞");return}const i=Xe(n,_);await Qe(i),oe(!1),ne(!1);const r=`–£—Å–ø–µ—Ö! ${i.length} —Ä–µ–¥–∞ —Å–∞ –¥–æ–±–∞–≤–µ–Ω–∏ –∫–∞—Ç–æ –ø—Ä–æ–¥–∞–∂–±–∏ (–æ—Ç ${n.length} –ø–æ–∫—É–ø–∫–∏).`,u=document.createElement("div");u.className="fixed top-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-50",u.textContent=r,document.body.appendChild(u),setTimeout(()=>{document.body.removeChild(u)},3e3)}catch(t){console.error(t),f(t instanceof Error?t.message:"–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ.")}};return Ee?e.jsx("div",{className:"max-w-xl mx-auto p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞ Gemini API"}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"–í—ä–≤–µ–¥–µ—Ç–µ Gemini API –∫–ª—é—á. –ö–ª—é—á—ä—Ç —Å–µ –∑–∞–ø–∞–∑–≤–∞ –≤ roaming settings (–≤ Excel) –∏–ª–∏ –≤ localStorage (–≤ –±—Ä–∞—É–∑—ä—Ä–∞)."}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-white font-medium mb-2",children:"Gemini API –∫–ª—é—á:"}),e.jsx("input",{type:"password",value:F,onChange:t=>U(t.target.value),className:"w-full px-3 py-2 rounded bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("button",{onClick:()=>xe(F,O),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-medium",children:"–ó–∞–ø–∞–∑–∏"}),F&&e.jsx("button",{onClick:()=>z(!1),className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg text-sm font-medium",children:"–ü—Ä–æ–¥—ä–ª–∂–∏"})]})]})}):e.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 shadow-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("div",{children:e.jsx("h2",{className:"text-2xl font-bold text-white",children:"–ò–∑–≤–ª–∏—á–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏ –æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∏"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative model-selector-container",children:[e.jsxs("button",{onClick:()=>X(!q),className:"text-sm text-blue-400 hover:text-blue-300 flex items-center gap-1",children:["ü§ñ"," ",O==="gemini-2.0-flash"?"Gemini 2.0 Flash":O==="gemini-2.5-flash"?"Gemini 2.5 Flash":"Gemini 2.5 Pro",e.jsx("span",{className:"text-xs",children:"‚ñº"})]}),q&&e.jsx("div",{className:"absolute right-0 top-full mt-1 bg-gray-700 border border-gray-600 rounded-lg shadow-lg z-50 min-w-[200px]",children:e.jsxs("div",{className:"p-2",children:[e.jsx("div",{className:"text-xs text-gray-300 mb-2 font-medium",children:"–ò–∑–±–µ—Ä–µ—Ç–µ –º–æ–¥–µ–ª:"}),[{value:"gemini-2.0-flash",label:"Gemini 2.0 Flash ‚Äì –±—ä—Ä–∑ –∏ –µ–≤—Ç–∏–Ω"},{value:"gemini-2.5-flash",label:"Gemini 2.5 Flash ‚Äì –ø–æ–¥–æ–±—Ä–µ–Ω–∞ —Ç–æ—á–Ω–æ—Å—Ç"},{value:"gemini-2.5-pro",label:"Gemini 2.5 Pro ‚Äì –Ω–∞–π-—Ç–æ—á–µ–Ω"}].map(t=>e.jsx("button",{onClick:()=>{const n=t.value;K(n),xe(F,n),X(!1)},className:`w-full text-left px-3 py-2 text-xs rounded hover:bg-gray-600 transition-colors ${O===t.value?"bg-blue-600 text-white":"text-gray-300"}`,children:t.label},t.value))]})})]}),e.jsx("button",{onClick:()=>z(!0),className:"text-sm text-blue-400 hover:text-blue-300",children:"‚öôÔ∏è API –Ω–∞—Å—Ç—Ä–æ–π–∫–∏"})]})]}),e.jsx("p",{className:"text-gray-400 mb-6",children:"–ö–∞—á–µ—Ç–µ –µ–¥–∏–Ω –∏–ª–∏ –ø–æ–≤–µ—á–µ PDF/–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å —Ñ–∞–∫—Ç—É—Ä–∏. –î–∞–Ω–Ω–∏—Ç–µ —â–µ –±—ä–¥–∞—Ç –ø—Ä–µ–æ–±—Ä–∞–∑—É–≤–∞–Ω–∏ –¥–æ —Ä–µ–¥–æ–≤–µ, –≥–æ—Ç–æ–≤–∏ –∑–∞ –≤–º—ä–∫–≤–∞–Ω–µ –≤ Excel."}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-white font-medium mb-2",children:["–¢–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç: ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("select",{value:$,onChange:t=>Se(t.target.value),className:"w-full px-4 py-3 bg-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:l,children:[e.jsx("option",{value:"1",children:"1 - –§–∞–∫—Ç—É—Ä–∞ –ø—Ä–æ–¥–∞–∂–±–∞"}),e.jsx("option",{value:"2",children:"2 - –î–µ–±–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø—Ä–æ–¥–∞–∂–±–∞"}),e.jsx("option",{value:"3",children:"3 - –ö—Ä–µ–¥–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø—Ä–æ–¥–∞–∂–±–∞"}),e.jsx("option",{value:"4",children:"4 - –§–∞–∫—Ç—É—Ä–∞ –ø–æ–∫—É–ø–∫–∞"}),e.jsx("option",{value:"5",children:"5 - –î–µ–±–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø–æ–∫—É–ø–∫–∞"}),e.jsx("option",{value:"6",children:"6 - –ö—Ä–µ–¥–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø–æ–∫—É–ø–∫–∞"}),e.jsx("option",{value:"7",children:"7 - –ö–∞—Å–æ–≤–∏ –ø—Ä–æ–¥–∞–∂–±–∏"}),e.jsx("option",{value:"8",children:"8 - –¢—Ä–∞–Ω—Å—Ñ–µ—Ä"}),e.jsx("option",{value:"9",children:"9 - –ë—Ä–∞–∫ (–†–ê–ó–•–û–î)"}),e.jsx("option",{value:"10",children:"10 - –ë—Ä–∞–∫ (–ú–û–õ)"}),e.jsx("option",{value:"11",children:"11 - –°–∫–ª–∞–¥–æ–≤–æ –∏—Å–∫–∞–Ω–µ"}),e.jsx("option",{value:"12",children:"12 - –°—Ç–æ–∫–æ–≤–∞ —Ä–∞–∑–ø–∏—Å–∫–∞ (–°–¢)"}),e.jsx("option",{value:"13",children:"13 - –°–∫–ª–∞–¥–æ–≤–∞ —Ä–∞–∑–ø–∏—Å–∫–∞ (–°–†)"}),e.jsx("option",{value:"14",children:"14 - –î–∞–≤–∞–Ω–µ —Å—Ç–æ–∫–∏ –Ω–∞ –∫–æ–Ω—Å–∏–≥–Ω–∞—Ü–∏—è (–ö–î) —Å—ä—Å —Å—á–µ—Ç. –æ–ø–µ—Ä–∞—Ü–∏–∏"}),e.jsx("option",{value:"15",children:"15 - –î–∞–≤–∞–Ω–µ —Å—Ç–æ–∫–∏ –Ω–∞ –∫–æ–Ω—Å–∏–≥–Ω–∞—Ü–∏—è (–ö–î) –±–µ–∑ —Å—á–µ—Ç. –æ–ø–µ—Ä–∞—Ü–∏–∏"})]}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"–ò–∑–±–µ—Ä–µ—Ç–µ —Ç–∏–ø–∞ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞. –ù–æ–º–µ—Ä—ä—Ç —â–µ –±—ä–¥–µ –ø–æ—Å—Ç–∞–≤–µ–Ω –≤ –ø—ä—Ä–≤–∞—Ç–∞ –∫–æ–ª–æ–Ω–∞ –Ω–∞ –≤—Å–µ–∫–∏ —Ä–µ–¥."})]}),e.jsxs("div",{className:"mb-6 grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-white font-medium mb-1 text-sm",children:["–û–±–µ–∫—Ç–∏: ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("select",{value:H,onChange:t=>{const n=t.target.value;ke(n),n!==B&&ge("")},className:"w-full px-3 py-2 bg-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",disabled:l,children:[le.map(t=>e.jsx("option",{value:t,children:t},t)),e.jsx("option",{value:B,children:"–î—Ä—É–≥–æ (—Ä—ä—á–Ω–æ)‚Ä¶"})]}),H===B&&e.jsx("input",{value:se,onChange:t=>ge(t.target.value),placeholder:"–í—ä–≤–µ–¥–µ—Ç–µ —Ä—ä—á–Ω–æ –æ–±–µ–∫—Ç‚Ä¶",className:"mt-2 w-full px-3 py-2 bg-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",disabled:l}),e.jsx("p",{className:"text-gray-400 text-xs mt-1",children:"–°—Ç–æ–π–Ω–æ—Å—Ç—Ç–∞ —â–µ –±—ä–¥–µ –ø–æ—Å—Ç–∞–≤–µ–Ω–∞ –≤ –∫–æ–ª–æ–Ω–∞ 7 –Ω–∞ –≤—Å–µ–∫–∏ —Ä–µ–¥."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-white font-medium mb-1 text-sm",children:["–í–∏–¥ –Ω–∞ –∞—Ä—Ç–∏–∫—É–ª–∞: ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("select",{value:Q,onChange:t=>{const n=t.target.value;Te(n),n!==B&&me("")},className:"w-full px-3 py-2 bg-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",disabled:l,children:[ae.map(t=>e.jsx("option",{value:t,children:t},t)),e.jsx("option",{value:B,children:"–î—Ä—É–≥–æ (—Ä—ä—á–Ω–æ)‚Ä¶"})]}),Q===B&&e.jsx("input",{value:te,onChange:t=>me(t.target.value),placeholder:"–í—ä–≤–µ–¥–µ—Ç–µ —Ä—ä—á–Ω–æ –≤–∏–¥ –Ω–∞ –∞—Ä—Ç–∏–∫—É–ª–∞‚Ä¶",className:"mt-2 w-full px-3 py-2 bg-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",disabled:l}),e.jsx("p",{className:"text-gray-400 text-xs mt-1",children:"–°—Ç–æ–π–Ω–æ—Å—Ç—Ç–∞ —â–µ –±—ä–¥–µ –ø–æ—Å—Ç–∞–≤–µ–Ω–∞ –≤ –∫–æ–ª–æ–Ω–∞ 8 (–í–∏–¥) –Ω–∞ –≤—Å–µ–∫–∏ —Ä–µ–¥."})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("input",{ref:Z,type:"file",multiple:!0,accept:"image/*,.pdf,.rtf,.doc,.docx",onChange:Ve,className:"hidden"}),e.jsx("button",{onClick:()=>{var t;return(t=Z.current)==null?void 0:t.click()},disabled:l||d,className:"w-full py-3 px-4 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-colors",children:s.length>0?"–î–æ–±–∞–≤–∏ –æ—â–µ —Ñ–∞–π–ª–æ–≤–µ":"–ò–∑–±–µ—Ä–∏ —Ñ–∞–π–ª–æ–≤–µ"})]}),s.length>0&&e.jsxs("div",{className:"mb-6 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-white font-medium",children:["–ò–∑–±—Ä–∞–Ω–∏ —Ñ–∞–π–ª–æ–≤–µ (",s.length,")"]}),e.jsx("button",{onClick:pe,className:"text-red-400 hover:text-red-300 text-sm",children:"–ò–∑—á–∏—Å—Ç–∏ –≤—Å–∏—á–∫–∏"})]}),s.map((t,n)=>e.jsxs("div",{className:"p-4 bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:t.file.name}),e.jsxs("p",{className:"text-gray-400 text-sm",children:[(t.file.size/1024).toFixed(2)," KB"]})]}),e.jsx("button",{onClick:()=>Ie(n),className:"text-red-400 hover:text-red-300 text-sm",children:"–ü—Ä–µ–º–∞—Ö–Ω–∏"})]}),t.preview&&e.jsx("img",{src:t.preview,alt:"Preview",className:"max-w-full max-h-48 rounded-lg mx-auto"})]},n))]}),s.length>0&&!p&&e.jsxs(e.Fragment,{children:[$==="7"&&s.some(t=>t.file.name.toLowerCase().endsWith(".rtf")||t.file.name.toLowerCase().endsWith(".doc")||t.file.name.toLowerCase().endsWith(".docx"))?e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 mb-6",children:[e.jsx("button",{onClick:$e,disabled:l||d,className:"py-3 px-4 bg-green-600 hover:bg-green-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-colors",children:d?"–û–±—Ä–∞–±–æ—Ç–≤–∞ RTF...":"üîß –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∏–∑–≤–ª–∏—á–∞–Ω–µ"}),e.jsx("button",{onClick:fe,disabled:l||d,className:"py-3 px-4 bg-orange-600 hover:bg-orange-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-colors",children:l?"–û–±—Ä–∞–±–æ—Ç–≤–∞ AI...":"ü§ñ AI –∏–∑–≤–ª–∏—á–∞–Ω–µ"})]}):e.jsx("button",{onClick:fe,disabled:l||d,className:"w-full py-3 px-4 bg-green-600 hover:bg-green-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-colors mb-6",children:l?"–û–±—Ä–∞–±–æ—Ç–≤–∞ —Å–µ‚Ä¶":"–ò–∑–≤–ª–µ—á–∏ –¥–∞–Ω–Ω–∏"}),$==="7"&&s.some(t=>t.file.name.toLowerCase().endsWith(".rtf")||t.file.name.toLowerCase().endsWith(".doc")||t.file.name.toLowerCase().endsWith(".docx"))&&e.jsxs("div",{className:"mb-6 p-4 bg-blue-900/30 border border-blue-500 rounded-lg",children:[e.jsxs("p",{className:"text-blue-200 text-sm",children:[e.jsx("strong",{children:"üîß –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∏–∑–≤–ª–∏—á–∞–Ω–µ:"})," –ë—ä—Ä–∑–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ RTF —Ç–∞–±–ª–∏—Ü–∏ –±–µ–∑ –∏–∑–ø–æ–ª–∑–≤–∞–Ω–µ –Ω–∞ AI –º–æ–¥–µ–ª–∏."]}),e.jsxs("p",{className:"text-blue-200 text-sm mt-1",children:[e.jsx("strong",{children:"ü§ñ AI –∏–∑–≤–ª–∏—á–∞–Ω–µ:"})," –ò–∑–ø–æ–ª–∑–≤–∞ AI –º–æ–¥–µ–ª–∏ –∑–∞ –ø–æ-—Å–ª–æ–∂–Ω–∏ —Å–ª—É—á–∞–∏, –Ω–æ –º–æ–∂–µ –¥–∞ –∏–º–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø—Ä–∏ –≥–æ–ª–µ–º–∏ —Ñ–∞–π–ª–æ–≤–µ."]})]})]}),p&&e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"p-4 bg-green-900/30 border border-green-500 rounded-lg",children:[e.jsx("p",{className:"text-green-200 font-medium",children:"‚úì –î–∞–Ω–Ω–∏—Ç–µ —Å–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏ —É—Å–ø–µ—à–Ω–æ!"}),e.jsxs("p",{className:"text-green-200 text-sm mt-1",children:["–ò–∑–≤–ª–µ—á–µ–Ω–∏ —Ä–µ–¥–æ–≤–µ: ",p.rows.length]})]}),e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-white font-medium mb-3",children:"–ü—Ä–µ–≥–ª–µ–¥ –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ (—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º–æ):"}),e.jsx("div",{className:"overflow-x-auto max-h-96 overflow-y-auto",children:e.jsxs("table",{className:"text-xs text-gray-300 w-full border-collapse",children:[e.jsx("thead",{className:"sticky top-0 bg-gray-800",children:e.jsx("tr",{children:J($).columns.slice(0,Math.max(...p.rows.map(t=>t.length))).map((t,n)=>e.jsx("th",{className:"border border-gray-600 px-2 py-2 text-left font-medium bg-gray-800",children:t.name},n))})}),e.jsx("tbody",{children:p.rows.map((t,n)=>e.jsxs("tr",{className:n%2===0?"bg-gray-800":"bg-gray-750",children:[t.map((i,r)=>e.jsx("td",{className:"border border-gray-600 px-1 py-1",children:e.jsx("input",{value:i??"",onChange:u=>Le(n,r,u.target.value),className:"w-full bg-transparent text-gray-200 text-xs outline-none",title:i})},r)),Array.from({length:Math.max(...p.rows.map(i=>i.length))-t.length}).map((i,r)=>e.jsx("td",{className:"border border-gray-600 px-2 py-1",children:"-"},`empty-${r}`))]},n))})]})}),e.jsx("p",{className:"text-gray-400 text-xs mt-2",children:"–ú–æ–∂–µ—Ç–µ –¥–∞ –∫–æ—Ä–∏–≥–∏—Ä–∞—Ç–µ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ –¥–∏—Ä–µ–∫—Ç–Ω–æ –≤ —Ç–∞–±–ª–∏—Ü–∞—Ç–∞ –ø—Ä–µ–¥–∏ –≤–º—ä–∫–≤–∞–Ω–µ –≤ Excel."})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx("button",{onClick:Pe,className:"flex-1 min-w-[150px] py-3 px-4 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:"üìã –í–º—ä–∫–Ω–∏ –≤ Excel"}),Re&&$==="4"&&e.jsx("button",{onClick:()=>oe(!he),className:"flex-1 min-w-[150px] py-3 px-4 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-medium transition-colors",children:"üîÑ –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–∞–π –≤ –ø—Ä–æ–¥–∞–∂–±–∞"}),e.jsx("button",{onClick:Me,className:"flex-1 min-w-[150px] py-3 px-4 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium transition-colors",children:"üíæ –ó–∞–ø–∞–∑–∏ –∫–∞—Ç–æ CSV"}),e.jsx("button",{onClick:pe,className:"flex-1 min-w-[150px] py-3 px-4 bg-gray-700 hover:bg-gray-800 text-white rounded-lg font-medium transition-colors",children:"üîÑ –ù–æ–≤ –∞–Ω–∞–ª–∏–∑"})]}),he&&e.jsxs("div",{className:"mt-4 p-4 bg-gray-700 rounded-lg",children:[e.jsx("h3",{className:"text-white font-medium mb-3",children:"–î–∞–Ω–Ω–∏ –∑–∞ –ø—Ä–æ–¥–∞–∂–±–∞—Ç–∞:"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 mb-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-white text-sm mb-1",children:["–ù–æ–º–µ—Ä: ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",value:_.documentNumber,onChange:t=>Y({..._,documentNumber:t.target.value}),className:"w-full px-3 py-2 bg-gray-600 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"–ù–æ–º–µ—Ä –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-white text-sm mb-1",children:["–ü–∞—Ä—Ç–Ω—å–æ—Ä: ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",value:_.partnerName,onChange:t=>Y({..._,partnerName:t.target.value}),className:"w-full px-3 py-2 bg-gray-600 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"–ò–º–µ –Ω–∞ –ø–∞—Ä—Ç–Ω—å–æ—Ä–∞"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-white text-sm mb-1",children:"–ï–ò–ö:"}),e.jsx("input",{type:"text",value:_.partnerEIK,onChange:t=>Y({..._,partnerEIK:t.target.value}),className:"w-full px-3 py-2 bg-gray-600 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"–ï–ò–ö (–æ–ø—Ü–∏–æ–Ω–∞–ª–Ω–æ)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-white text-sm mb-1",children:"–ò–ù –ø–æ –î–î–°:"}),e.jsx("input",{type:"text",value:_.partnerVAT,onChange:t=>Y({..._,partnerVAT:t.target.value}),className:"w-full px-3 py-2 bg-gray-600 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"–ò–ù –ø–æ –î–î–° (–æ–ø—Ü–∏–æ–Ω–∞–ª–Ω–æ)"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-white text-sm mb-1",children:["–î–∞—Ç–∞: ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",value:_.documentDate,onChange:t=>Y({..._,documentDate:t.target.value}),className:"w-full px-3 py-2 bg-gray-600 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"dd.mm.yyyy"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-white text-sm mb-1",children:["–ù–∞–¥—Ü–µ–Ω–∫–∞ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç: ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"number",value:_.profitMarkupPercent,onChange:t=>Y({..._,profitMarkupPercent:parseFloat(t.target.value)||0}),className:"w-full px-3 py-2 bg-gray-600 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"40",min:"0",step:"0.1"})]})]}),e.jsx("button",{onClick:De,className:"w-full py-3 px-4 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-medium transition-colors",children:"‚úì –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–∞–π"})]})]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-gray-800 rounded-lg",children:[e.jsx("h3",{className:"text-white font-medium mb-2",children:"–ü–æ–¥–¥—ä—Ä–∂–∞–Ω–∏ —Ñ–æ—Ä–º–∞—Ç–∏:"}),e.jsxs("ul",{className:"text-gray-400 text-sm space-y-1",children:[e.jsx("li",{children:"‚Ä¢ PDF –¥–æ–∫—É–º–µ–Ω—Ç–∏"}),e.jsx("li",{children:"‚Ä¢ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (JPG, PNG, WEBP)"}),e.jsx("li",{children:"‚Ä¢ RTF —Ñ–∞–π–ª–æ–≤–µ (–∑–∞ –∫–∞—Å–æ–≤–∏ –ø—Ä–æ–¥–∞–∂–±–∏)"}),e.jsx("li",{children:"‚Ä¢ Word –¥–æ–∫—É–º–µ–Ω—Ç–∏ (.doc, .docx)"}),e.jsx("li",{children:"‚Ä¢ –§–∞–∫—Ç—É—Ä–∏ –∑–∞ —É—Å–ª—É–≥–∏"}),e.jsx("li",{children:"‚Ä¢ –ú–Ω–æ–∂–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤–µ –Ω–∞–≤–µ–¥–Ω—ä–∂"})]})]}),Ae&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4 shadow-xl",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-red-600 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-sm font-bold",children:"!"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("h3",{className:"text-lg font-medium text-white",children:"–ì—Ä–µ—à–∫–∞"})})]}),e.jsx("div",{className:"mb-6",children:e.jsx("p",{className:"text-gray-300 text-sm",children:E})}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:_e,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:"–ó–∞—Ç–≤–æ—Ä–∏"})})]})})]})},rt=Ke.createRoot(document.getElementById("root"));rt.render(e.jsx(He.StrictMode,{children:e.jsx("div",{className:"bg-gray-900 text-gray-200 h-full antialiased overflow-y-auto",children:e.jsx(ot,{})})}));
