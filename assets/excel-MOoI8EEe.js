import{i as ee,r as T,j as e,p as Ge,c as Ue,G as Be,a as We,b as ze,R as Ke}from"./rtfParser-Dp1iI0vO.js";const He={outputFormat:"csv",dateFormat:"dd.mm.yyyy",delimiter:";",rowDelimiter:`\r
`,includeHeaders:!1,encoding:"windows-1251",minimumColumns:44,note:"–í–∏–Ω–∞–≥–∏ –∏–∑–≤–µ–∂–¥–∞–π –¢–û–ß–ù–û 44 –∫–æ–ª–æ–Ω–∏ (—Ç–æ—á–Ω–æ 43 ';' –Ω–∞ —Ä–µ–¥). –ê–∫–æ –∑–∞ –∫–æ–ª–æ–Ω–∞ –Ω—è–º–∞ –¥–∞–Ω–Ω–∏, –æ—Å—Ç–∞–≤–∏ –ø—Ä–∞–∑–Ω–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç –º–µ–∂–¥—É —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏—Ç–µ (;)."},Ye=[{columnNumber:1,name:"–í–∏–¥. –î–æ–∫—É–º–µ–Ω—Ç",nameEN:"Document_Type",required:!0,dataType:"number",description:"–ß–∏—Å–ª–æ –æ–ø—Ä–µ–¥–µ–ª—è—â–æ –≤–∏–¥–∞ –Ω–∞ —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä–∏—Ä–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç",allowedValues:{1:"–§–∞–∫—Ç—É—Ä–∞ –ø—Ä–æ–¥–∞–∂–±–∞",2:"–î–µ–±–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø—Ä–æ–¥–∞–∂–±–∞",3:"–ö—Ä–µ–¥–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø—Ä–æ–¥–∞–∂–±–∞",4:"–§–∞–∫—Ç—É—Ä–∞ –ø–æ–∫—É–ø–∫–∞",5:"–î–µ–±–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø–æ–∫—É–ø–∫–∞",6:"–ö—Ä–µ–¥–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø–æ–∫—É–ø–∫–∞",7:"–ö–∞—Å–æ–≤–∏ –ø—Ä–æ–¥–∞–∂–±–∏",8:"–¢—Ä–∞–Ω—Å—Ñ–µ—Ä (–≤—ä—Ç—Ä–µ—à–µ–Ω)",9:"–ü—Ä–æ—Ç–æ–∫–æ–ª",10:"–ê–≤–∞–Ω—Å",11:"–ê–≤–∞–Ω—Å–æ–≤–∞ —Ñ–∞–∫—Ç—É—Ä–∞",12:"–§–∞–∫—Ç—É—Ä–∞ –∞–≤–∞–Ω—Å",13:"–°—Ç–æ—Ä–Ω–æ",14:"–î–µ–±–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –∞–≤–∞–Ω—Å",15:"–ö—Ä–µ–¥–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –∞–≤–∞–Ω—Å"}},{columnNumber:2,name:"–î–∞—Ç–∞",nameEN:"Date",required:!0,dataType:"date",description:"–î–∞—Ç–∞ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –≤—ä–≤ —Ñ–æ—Ä–º–∞—Ç dd.mm.yyyy"},{columnNumber:3,name:"–ù–æ–º–µ—Ä",nameEN:"Document_Number",required:!0,dataType:"string",description:"–ù–æ–º–µ—Ä –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞"},{columnNumber:4,name:"–ü–∞—Ä—Ç–Ω—å–æ—Ä",nameEN:"Partner_Name",required:!1,dataType:"string",description:`–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –Ω–∞ –ø–∞—Ä—Ç–Ω—å–æ—Ä–∞ (–∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç). –î–∞ –Ω–µ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞—Ç —Å–∏–º–≤–æ–ª–∏ " ' / \\ &`},{columnNumber:5,name:"–ï–ò–ö",nameEN:"Partner_EIK",required:!1,dataType:"string",description:"–ë—É–ª—Å—Ç–∞—Ç/–ï–ò–ö –Ω–∞ –ø–∞—Ä—Ç–Ω—å–æ—Ä–∞. –ê–∫–æ –µ –ø–æ–ø—ä–ª–Ω–µ–Ω, —â–µ —Å–µ —Ç—ä—Ä—Å–∏ –ø–∞—Ä—Ç–Ω—å–æ—Ä –ø–æ –ï–ò–ö –≤ –±–∞–∑–∞—Ç–∞."},{columnNumber:6,name:"–ò–ù –ø–æ –î–î–°",nameEN:"Partner_VAT_Number",required:!1,dataType:"string",description:"–î–î–° –Ω–æ–º–µ—Ä –Ω–∞ –ø–∞—Ä—Ç–Ω—å–æ—Ä–∞"},{columnNumber:7,name:"–û–±–µ–∫—Ç",nameEN:"Object",required:!1,dataType:"string",description:"–û–±–µ–∫—Ç (–∏–∑–±—Ä–∞–Ω –æ—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è –≤ UI). –ü–æ –ø–æ–¥—Ä–∞–∑–±–∏—Ä–∞–Ω–µ —Å–µ –ø–æ–¥–∞–≤–∞ –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞ –∏ –¢–†–Ø–ë–í–ê –¥–∞ –µ –µ–¥–Ω–∞ –∏ —Å—ä—â–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç –Ω–∞ –≤—Å–µ–∫–∏ —Ä–µ–¥ –∑–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞. –ù–µ –∏–∑–º–∏—Å–ª—è–π —Å—Ç–æ–π–Ω–æ—Å—Ç–∏.",allowedValues:["–°–¢–û–ö–ê","–ú–ê–¢–ï–†–ò–ê–õ–ò","–ü–†–û–î–£–ö–¶–ò–Ø"]},{columnNumber:8,name:"–í–∏–¥",nameEN:"Entity_Type",required:!1,dataType:"string",description:"–í–∏–¥ –Ω–∞ –ø–æ–¥–∞–≤–∞–Ω–∏—Ç–µ –¥–∞–Ω–Ω–∏.",allowedValues:["–°—Ç–æ–∫–∏","–ú–∞—Ç–µ—Ä–∏–∞–ª–∏","–ü—Ä–æ–¥—É–∫—Ü–∏—è","–£—Å–ª—É–≥–∏","–†–∞–∑—Ö–æ–¥–∏ –∑–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–∏","–ê–≤–∞–Ω—Å","–ü—Ä–∏—Å–ø–∞–¥–∞–Ω–µ –Ω–∞ –∞–≤–∞–Ω—Å","–î—ä–ª–≥–æ—Ç—Ä–∞–π–Ω–∏ –∞–∫—Ç–∏–≤–∏"]},{columnNumber:9,name:"–ì—Ä—É–ø–∞",nameEN:"Group",required:!1,dataType:"string",description:"–ì—Ä—É–ø–∞. –û–±–∏–∫–Ω–æ–≤–µ–Ω–æ –ø—Ä–∞–∑–Ω–æ."},{columnNumber:10,name:"–ü–æ–¥ –≥—Ä—É–ø–∞",nameEN:"Subgroup",required:!1,dataType:"string",description:"–ü–æ–¥ –≥—Ä—É–ø–∞. –û–±–∏–∫–Ω–æ–≤–µ–Ω–æ –ø—Ä–∞–∑–Ω–æ."},{columnNumber:11,name:"–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ",nameEN:"Item_Name",required:!0,dataType:"string",description:"–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –Ω–∞ –∞—Ä—Ç–∏–∫—É–ª–∞"},{columnNumber:12,name:"–ö–æ–¥/–ë–∞—Ä–∫–æ–¥",nameEN:"Barcode",required:!1,dataType:"string",description:"–†–µ–∑–µ—Ä–≤–∏—Ä–∞–Ω–∞. –ü—Ä–∞–∑–Ω–∞."},{columnNumber:13,name:"–ú—è—Ä–∫–∞",nameEN:"Unit",required:!1,dataType:"string",description:"–ú–µ—Ä–Ω–∞ –µ–¥–∏–Ω–∏—Ü–∞"},{columnNumber:14,name:"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ",nameEN:"Quantity",required:!1,dataType:"number",description:"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ"},{columnNumber:15,name:"–ï–¥. –¶–µ–Ω–∞",nameEN:"Unit_Price",required:!1,dataType:"number",description:"–ï–¥. —Ü–µ–Ω–∞ –±–µ–∑ –î–î–° (—Å–ª–µ–¥ –æ—Ç—Å—Ç—ä–ø–∫–∞)."},{columnNumber:16,name:"–°—Ç–æ–π–Ω–æ—Å—Ç",nameEN:"Line_Total",required:!1,dataType:"number",description:"–°—Ç–æ–π–Ω–æ—Å—Ç –±–µ–∑ –î–î–° (—Å–ª–µ–¥ –æ—Ç—Å—Ç—ä–ø–∫–∞)."},{columnNumber:17,name:"–î–î–° –í–∏–¥",nameEN:"VAT_Type",required:!1,dataType:"string",description:"–î–î–°20/–î–î–°9/–î–î–°0."},{columnNumber:18,name:"–í–∏–¥ –ø–ª–∞—â–∞–Ω–µ",nameEN:"Payment_Type",required:!1,dataType:"number",description:"1/2/4/9",allowedValues:{1:"–í –±—Ä–æ–π",2:"–ü–æ —Å–º–µ—Ç–∫–∞",4:"–° –∫–∞—Ä—Ç–∞",9:"–°–º–µ—Å–µ–Ω–æ –ø–ª–∞—â–∞–Ω–µ"}},{columnNumber:19,name:"–û–±—â–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç —Å –î–î–° (–¥–æ–∫—É–º–µ–Ω—Ç)",nameEN:"Document_Total_With_VAT",required:!1,dataType:"number",description:"–°–∞–º–æ –Ω–∞ –ø—ä—Ä–≤–∏ —Ä–µ–¥."},{columnNumber:20,name:"–î–î–° (–¥–æ–∫—É–º–µ–Ω—Ç)",nameEN:"Document_VAT",required:!1,dataType:"number",description:"–°–∞–º–æ –Ω–∞ –ø—ä—Ä–≤–∏ —Ä–µ–¥."},{columnNumber:21,name:"–ü–ª–∞—Ç–µ–Ω–æ",nameEN:"Paid_Total",required:!1,dataType:"number",description:"–°–∞–º–æ –Ω–∞ –ø—ä—Ä–≤–∏ —Ä–µ–¥."},{columnNumber:22,name:"–¶–µ–Ω–∞ –Ω–∞ –∏–∑–ø–∏—Å–≤–∞–Ω–µ",nameEN:"WriteOff_Price",required:!1,dataType:"number",description:"–û–±–∏–∫–Ω–æ–≤–µ–Ω–æ –ø—Ä–∞–∑–Ω–∞."},{columnNumber:23,name:"–í–∞–ª—É—Ç–∞",nameEN:"Currency",required:!1,dataType:"string",description:"BGN/EUR/USD/GBP.",allowedValues:["BGN","EUR","USD","GBP",""]},{columnNumber:24,name:"–ö—É—Ä—Å",nameEN:"Exchange_Rate",required:!1,dataType:"number",description:"–ê–∫–æ –Ω—è–º–∞ –¥–∞ –±—ä–¥–µ –ø—Ä–∞–∑–Ω–æ"},{columnNumber:25,name:"–ö–æ–º–µ–Ω—Ç–∞—Ä",nameEN:"Comment",required:!1,dataType:"string",description:"–°–∞–º–æ –Ω–∞ –ø—ä—Ä–≤–∏ —Ä–µ–¥."},{columnNumber:26,name:"–î–∞–Ω—ä—á–Ω–∞ –æ—Å–Ω–æ–≤–∞ 20%",nameEN:"Tax_Base_20",required:!1,dataType:"number",description:"–°–∞–º–æ –Ω–∞ –ø—ä—Ä–≤–∏ —Ä–µ–¥, –∞–∫–æ –µ –Ω–∞–ª–∏—á–Ω–æ."},{columnNumber:27,name:"–î–∞–Ω—ä—á–Ω–∞ –æ—Å–Ω–æ–≤–∞ 9%",nameEN:"Tax_Base_9",required:!1,dataType:"number",description:"–°–∞–º–æ –Ω–∞ –ø—ä—Ä–≤–∏ —Ä–µ–¥, –∞–∫–æ –µ –Ω–∞–ª–∏—á–Ω–æ."},{columnNumber:28,name:"–û—Å–Ω–æ–≤–∞–Ω–∏–µ –∑–∞ –Ω–µ–Ω–∞—á–∏—Å–ª—è–≤–∞–Ω–µ",nameEN:"Reason for not adding VAT",required:!1,dataType:"string",description:"–†–µ–∑–µ—Ä–≤–∏—Ä–∞–Ω–∞. –ü—Ä–∞–∑–Ω–∞."},{columnNumber:29,name:"–î–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–µ–Ω –∫–æ–º–µ–Ω—Ç–∞—Ä",nameEN:"Additinal comments",required:!1,dataType:"string",description:"–†–µ–∑–µ—Ä–≤–∏—Ä–∞–Ω–∞. –ü—Ä–∞–∑–Ω–∞."},{columnNumber:30,name:"–ú–µ—Å–µ—Ü –î–î–°",nameEN:"Month to count VAT",required:!1,dataType:"string",description:"–†–µ–∑–µ—Ä–≤–∏—Ä–∞–Ω–∞. –ü—Ä–∞–∑–Ω–∞."},{columnNumber:31,name:"–î–∞—Ç–∞ –Ω–∞ —Å—á–µ—Ç–æ–≤–æ–¥–Ω–∏—Ç–µ –æ–ø–µ—Ä–∞—Ü–∏–∏",nameEN:"Column_31",required:!1,dataType:"string",description:"–†–µ–∑–µ—Ä–≤–∏—Ä–∞–Ω–∞. –ü—Ä–∞–∑–Ω–∞."},{columnNumber:32,name:"–ü–∞–¥–µ–∂",nameEN:"Column_32",required:!1,dataType:"string",description:"–†–µ–∑–µ—Ä–≤–∏—Ä–∞–Ω–∞. –ü—Ä–∞–∑–Ω–∞."},{columnNumber:33,name:"–°—É–º–∞ –ß–î–ö 20%",nameEN:"Column_33",required:!1,dataType:"string",description:"–†–µ–∑–µ—Ä–≤–∏—Ä–∞–Ω–∞. –ü—Ä–∞–∑–Ω–∞."},{columnNumber:34,name:"–°—É–º–∞ –ß–î–ö 9%",nameEN:"Column_34",required:!1,dataType:"string",description:"–†–µ–∑–µ—Ä–≤–∏—Ä–∞–Ω–∞. –ü—Ä–∞–∑–Ω–∞."},{columnNumber:35,name:"–°—É–º–∞ –ë–î–ö",nameEN:"Column_35",required:!1,dataType:"string",description:"–†–µ–∑–µ—Ä–≤–∏—Ä–∞–Ω–∞. –ü—Ä–∞–∑–Ω–∞."},{columnNumber:36,name:"–ê–Ω–∞–ª–∏—Ç–∏—á–µ–Ω –ø—Ä–∏–∑–Ω–∞–∫ –≥—Ä. 70",nameEN:"Analytics_Group_70",required:!1,dataType:"string",description:"–°–ò–°–¢–ï–ú–ù–û. –í–ò–ù–ê–ì–ò –ø—Ä–∞–∑–Ω–æ."},{columnNumber:37,name:"–ê–Ω–∞–ª–∏—Ç–∏—á–µ–Ω –ø—Ä–∏–∑–Ω–∞–∫ —Å–º–µ—Ç–∫–∞ 501",nameEN:"Analytics_Account_501",required:!1,dataType:"string",description:"–°–ò–°–¢–ï–ú–ù–û. –í–ò–ù–ê–ì–ò –ø—Ä–∞–∑–Ω–æ."},{columnNumber:38,name:"–ü–ª–∞—Ç–µ–Ω–æ –≤ –±—Ä–æ–π",nameEN:"Paid_Cash",required:!1,dataType:"number",description:"–°–∞–º–æ –Ω–∞ –ø—ä—Ä–≤–∏ —Ä–µ–¥."},{columnNumber:39,name:"–ü–ª–∞—Ç–µ–Ω–æ —Å –∫–∞—Ä—Ç–∞",nameEN:"Paid_Card",required:!1,dataType:"number",description:"–°–∞–º–æ –Ω–∞ –ø—ä—Ä–≤–∏ —Ä–µ–¥."},{columnNumber:40,name:"–í–∞—É—á–µ—Ä",nameEN:"Paid_Voucher",required:!1,dataType:"number",description:"–°–∞–º–æ –Ω–∞ –ø—ä—Ä–≤–∏ —Ä–µ–¥."},{columnNumber:41,name:"–î–∞–Ω. –û—Å–Ω–æ–≤–∞ –î–î–° 0% –ø–æ –≥—Ä. 3",nameEN:"Column_41",required:!1,dataType:"number",description:"–°–∞–º–æ –Ω–∞ –ø—ä—Ä–≤–∏ —Ä–µ–¥, –∞–∫–æ –µ –Ω–∞–ª–∏—á–Ω–æ."},{columnNumber:42,name:"–î–æ—Å—Ç–∞–≤–∫–∞ –Ω–∞ —Ö–ª—è–±",nameEN:"Column_42",required:!1,dataType:"string",description:"–†–µ–∑–µ—Ä–≤–∏—Ä–∞–Ω–∞. –ü—Ä–∞–∑–Ω–∞."},{columnNumber:43,name:"–î–æ—Å—Ç–∞–≤–∫–∞ –Ω–∞ –±—Ä–∞—à–Ω–æ",nameEN:"Column_43",required:!1,dataType:"string",description:"–†–µ–∑–µ—Ä–≤–∏—Ä–∞–Ω–∞. –ü—Ä–∞–∑–Ω–∞."},{columnNumber:44,name:"–¢–∏–ø –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç –≤ –ü–ª—é—Å –ú–∏–Ω—É—Å",nameEN:"Column_44",required:!1,dataType:"string",description:"–†–µ–∑–µ—Ä–≤–∏—Ä–∞–Ω–∞. –ü—Ä–∞–∑–Ω–∞."}],Qe={1:"–§–∞–∫—Ç—É—Ä–∞ –ø—Ä–æ–¥–∞–∂–±–∞",2:"–î–µ–±–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø—Ä–æ–¥–∞–∂–±–∞",3:"–ö—Ä–µ–¥–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø—Ä–æ–¥–∞–∂–±–∞",4:"–§–∞–∫—Ç—É—Ä–∞ –ø–æ–∫—É–ø–∫–∞",5:"–î–µ–±–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø–æ–∫—É–ø–∫–∞",6:"–ö—Ä–µ–¥–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø–æ–∫—É–ø–∫–∞",7:"–ö–∞—Å–æ–≤–∏ –ø—Ä–æ–¥–∞–∂–±–∏",8:"–¢—Ä–∞–Ω—Å—Ñ–µ—Ä (–≤—ä—Ç—Ä–µ—à–µ–Ω)",9:"–ü—Ä–æ—Ç–æ–∫–æ–ª",10:"–ê–≤–∞–Ω—Å",11:"–ê–≤–∞–Ω—Å–æ–≤–∞ —Ñ–∞–∫—Ç—É—Ä–∞",12:"–§–∞–∫—Ç—É—Ä–∞ –∞–≤–∞–Ω—Å",13:"–°—Ç–æ—Ä–Ω–æ",14:"–î–µ–±–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –∞–≤–∞–Ω—Å",15:"–ö—Ä–µ–¥–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –∞–≤–∞–Ω—Å"},Je=["–°—Ç–æ–∫–∏","–ú–∞—Ç–µ—Ä–∏–∞–ª–∏","–£—Å–ª—É–≥–∏","–ü—Ä–æ–¥—É–∫—Ü–∏—è","–†–∞–∑—Ö–æ–¥–∏ –∑–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–∏","–ê–≤–∞–Ω—Å","–ü—Ä–∏—Å–ø–∞–¥–∞–Ω–µ –Ω–∞ –∞–≤–∞–Ω—Å","–î—ä–ª–≥–æ—Ç—Ä–∞–π–Ω–∏ –∞–∫—Ç–∏–≤–∏"],Xe=["–°–¢–û–ö–ê","–ú–ê–¢–ï–†–ò–ê–õ–ò","–ü–†–û–î–£–ö–¶–ò–Ø"],Ze=["–î–î–°20","–î–î–°9","–î–î–°0"],et={1:"–í –±—Ä–æ–π",2:"–ü–æ —Å–º–µ—Ç–∫–∞",4:"–° –∫–∞—Ä—Ç–∞",9:"–°–º–µ—Å–µ–Ω–æ –ø–ª–∞—â–∞–Ω–µ"},tt=["–ö–†–ê–ô–ù–ò –°–£–ú–ò (–¢–û–¢–ê–õ–ò):","–ö—Ä–∞–π–Ω–∞—Ç–∞ —Å—É–º–∞ –∑–∞ –ø–ª–∞—â–∞–Ω–µ –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ —Å–µ –≤–∑–µ–º–∞ –¢–û–ß–ù–û –∫–∞–∫—Ç–æ –µ –∏–∑–ø–∏—Å–∞–Ω–∞.","–ù–ï –ø—Ä–µ–∏–∑—á–∏—Å–ª—è–≤–∞–π –∫—Ä–∞–π–Ω–∞ —Å—É–º–∞ –æ—Ç —Ä–µ–¥–æ–≤–µ, –î–î–° –∏–ª–∏ –æ—Ç—Å—Ç—ä–ø–∫–∏.","–ê–∫–æ –∏–º–∞ –Ω—è–∫–æ–ª–∫–æ —Å—É–º–∏ (–±–µ–∑ –î–î–°, –î–î–°, —Å –î–î–°, –≤ —Ä–∞–∑–ª–∏—á–Ω–∏ –≤–∞–ª—É—Ç–∏), –∏–∑–≤–ª–µ—á–∏ –≥–∏ —Å–∞–º–æ –∫–∞—Ç–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏, –±–µ–∑ –¥–∞ –≥–∏ —Å–≤—ä—Ä–∑–≤–∞—à —Å –∏–∑—á–∏—Å–ª–µ–Ω–∏—è.","–î–û–ö–£–ú–ï–ù–¢–ù–ò –î–î–° –°–¢–û–ô–ù–û–°–¢–ò (–ü–™–†–í–ò –†–ï–î):","–ê–∫–æ –∏–º–∞ —è—Å–Ω–æ –∏–∑–ø–∏—Å–∞–Ω–∞ –¥–∞–Ω—ä—á–Ω–∞ –æ—Å–Ω–æ–≤–∞ –∑–∞ 20% ‚Üí –ø–æ–ø—ä–ª–Ω–∏ –∫–æ–ª–æ–Ω–∞ 26.","–ê–∫–æ –∏–º–∞ —è—Å–Ω–æ –∏–∑–ø–∏—Å–∞–Ω–∞ –¥–∞–Ω—ä—á–Ω–∞ –æ—Å–Ω–æ–≤–∞ –∑–∞ 9% ‚Üí –ø–æ–ø—ä–ª–Ω–∏ –∫–æ–ª–æ–Ω–∞ 27.","–ê–∫–æ –∏–º–∞ —è—Å–Ω–æ –∏–∑–ø–∏—Å–∞–Ω–∞ –¥–∞–Ω—ä—á–Ω–∞ –æ—Å–Ω–æ–≤–∞ –∑–∞ 0% ‚Üí –ø–æ–ø—ä–ª–Ω–∏ –∫–æ–ª–æ–Ω–∞ 41.","–í–ê–ñ–ù–û:","–ö–æ–ª–æ–Ω–∏ 26, 27 –∏ 41 —Å–µ –ø–æ–ø—ä–ª–≤–∞—Ç –°–ê–ú–û –Ω–∞ –ø—ä—Ä–≤–∏—è —Ä–µ–¥.","–ê–†–ò–¢–ú–ï–¢–ò–ß–ù–ê –ó–ê–ë–†–ê–ù–ê (–ê–ù–ö–û–†):","–ù–ï –ø—Ä–æ–≤–µ—Ä—è–≤–∞–π –¥–∞–ª–∏ Quantity √ó Unit_Price = Line_Total.","–ù–ï –ø—Ä–æ–≤–µ—Ä—è–≤–∞–π –¥–∞–ª–∏ —Å–±–æ—Ä—ä—Ç –Ω–∞ —Ä–µ–¥–æ–≤–µ—Ç–µ = –∫—Ä–∞–π–Ω–∞ —Å—É–º–∞.","--------------------------------------------","METRO INLINE –û–¢–°–¢–™–ü–ö–ò (–ö–†–ò–¢–ò–ß–ù–û –ò–ó–ö–õ–Æ–ß–ï–ù–ò–ï)","--------------------------------------------","–ê–∫–æ –ø–æ–¥ –∞—Ä—Ç–∏–∫—É–ª –∏–º–∞ —Ä–µ–¥ —Å—ä–¥—ä—Ä–∂–∞—â '–û—Ç—Å—Ç—ä–ø–∫–∞', 'Discount' –∏–ª–∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª–Ω–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç ‚Äî —Ç–æ–≤–∞ –ù–ï –µ –Ω–æ–≤ –∞—Ä—Ç–∏–∫—É–ª.","–¢–æ–∑–∏ —Ä–µ–¥ –µ –æ—Ç—Å—Ç—ä–ø–∫–∞ –∑–∞ –ø—Ä–µ–¥—Ö–æ–¥–Ω–∏—è –∞—Ä—Ç–∏–∫—É–ª.","–ù–∏–∫–æ–≥–∞ –Ω–µ —Å—ä–∑–¥–∞–≤–∞–π –æ—Ç–¥–µ–ª–µ–Ω CSV —Ä–µ–¥ –∑–∞ –æ—Ç—Å—Ç—ä–ø–∫–∞.","–ê–∫–æ –∏–º–∞ –ø–æ–≤–µ—á–µ –æ—Ç –µ–¥–Ω–∞ –æ—Ç—Å—Ç—ä–ø–∫–∞ –ø–æ–¥ –∞—Ä—Ç–∏–∫—É–ª–∞ ‚Äî —Å—É–º–∏—Ä–∞–π –≥–∏.","–ü–†–ï–ò–ó–ß–ò–°–õ–ï–ù–ò–ï –ï –†–ê–ó–†–ï–®–ï–ù–û –°–ê–ú–û –ü–†–ò –û–¢–°–¢–™–ü–ö–ê –ù–ê –†–ï–î:","1. –ù–æ–≤ Line_Total = –û—Ä–∏–≥–∏–Ω–∞–ª–µ–Ω Line_Total ‚Äì –û–±—â–∞ –û—Ç—Å—Ç—ä–ø–∫–∞.","2. –ù–æ–≤ Unit_Price = –ù–æ–≤ Line_Total / Quantity.","3. –ó–∞–∫—Ä—ä–≥–ª—è–Ω–µ –¥–æ 2 –∑–Ω–∞–∫–∞ –°–ê–ú–û –Ω–∞ —Ñ–∏–Ω–∞–ª–Ω–∏—Ç–µ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏.","4. –ù–ï –∑–∞–∫—Ä—ä–≥–ª—è–π –º–µ–∂–¥–∏–Ω–Ω–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç–∏.","5. –ù–ï –ø—Ä–æ–º–µ–Ω—è–π Quantity.","6. –ù–ï –ø—Ä–æ–º–µ–Ω—è–π –î–î–° –í–∏–¥.","–ü–†–ï–î–ü–ê–ó–í–ê–ù–ï:","–ê–∫–æ –æ—Ç–ø–µ—á–∞—Ç–∞–Ω–∞—Ç–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç –≤–µ—á–µ –æ—Ç—Ä–∞–∑—è–≤–∞ –æ—Ç—Å—Ç—ä–ø–∫–∞—Ç–∞ ‚Äî –Ω–µ –ø—Ä–∏–ª–∞–≥–∞–π –ø–æ–≤—Ç–æ—Ä–Ω–æ –Ω–∞–º–∞–ª–µ–Ω–∏–µ.","--------------------------------------------","–¶–ï–õ: –ò–∑–≤–ª–µ—á–∏ –≤—Å–∏—á–∫–∏ –ø–æ–∑–∏—Ü–∏–∏ (–∞—Ä—Ç–∏–∫—É–ª–∏) –æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∏ –≤—ä—Ä–Ω–∏ –°–ê–ú–û CSV —Ä–µ–¥–æ–≤–µ. –ï–¥–∏–Ω —Ä–µ–¥ = –µ–¥–Ω–∞ –ø–æ–∑–∏—Ü–∏—è.","–°–¢–†–û–ì–û –§–û–†–ú–ê–¢–ò–†–ê–ù–ï: –í—Å–µ–∫–∏ CSV —Ä–µ–¥ —Ç—Ä—è–±–≤–∞ –¥–∞ —Å—ä–¥—ä—Ä–∂–∞ –¢–û–ß–ù–û 44 –∫–æ–ª–æ–Ω–∏ => –¢–û–ß–ù–û 43 —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è ';'.","–ù–ï –ò–ó–ü–û–õ–ó–í–ê–ô markdown, –ù–ï –∏–∑–ø–æ–ª–∑–≤–∞–π ```csv, –ù–ï –¥–æ–±–∞–≤—è–π –æ–±—è—Å–Ω–µ–Ω–∏—è.","–ù–ï –∏–∑–ø–∏—Å–≤–∞–π –±—É–∫–≤–∞–ª–Ω–æ '\\\\r\\\\n' –∏–ª–∏ '\\\\n'. –ò–∑–ø–æ–ª–∑–≤–∞–π —Ä–µ–∞–ª–Ω–∏ –Ω–æ–≤–∏ —Ä–µ–¥–æ–≤–µ CRLF (\\r\\n) –º–µ–∂–¥—É CSV —Ä–µ–¥–æ–≤–µ—Ç–µ.","–ö–û–õ–û–ù–ê 1 –≤–∏–Ω–∞–≥–∏ = –∏–∑–±—Ä–∞–Ω–∏—è –æ—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è docType.","–ö–û–õ–û–ù–ê 7 (–û–±–µ–∫—Ç) –≤–∏–Ω–∞–≥–∏ = –∏–∑–±—Ä–∞–Ω–∏—è –æ—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è –æ–±–µ–∫—Ç (objectType).","–ö–û–õ–û–ù–ê 8 (–í–∏–¥) –≤–∏–Ω–∞–≥–∏ = –∏–∑–±—Ä–∞–Ω–∏—è –æ—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è –≤–∏–¥ (entityType).","–ê–ù–ö–û–† (–∫—Ä–∏—Ç–∏—á–Ω–æ): –ê–∫–æ –∫–æ–ª–æ–Ω–∏ 9 (–ì—Ä—É–ø–∞) –∏ 10 (–ü–æ–¥ –≥—Ä—É–ø–∞) –Ω—è–º–∞—Ç –Ω–∞–¥–µ–∂–¥–Ω–∏ –¥–∞–Ω–Ω–∏, –æ—Å—Ç–∞–≤–∏ –ò –î–í–ï–¢–ï –ø—Ä–∞–∑–Ω–∏. –¢–æ–≤–∞ –æ–∑–Ω–∞—á–∞–≤–∞, —á–µ –º–µ–∂–¥—É –∫–æ–ª–æ–Ω–∞ 8 –∏ –∫–æ–ª–æ–Ω–∞ 11 —Ç—Ä—è–±–≤–∞ –¥–∞ –∏–º–∞ –¢–û–ß–ù–û ';;;'.","–ü—Ä–∏–º–µ—Ä –∑–∞ –ø—Ä–∞–≤–∏–ª–µ–Ω —à–∞–±–ª–æ–Ω –æ–∫–æ–ª–æ –∫–æ–ª–æ–Ω–∏ 8‚Äì12: ...;{col8};{col9};{col10};{col11};{col12};...","–ê–∫–æ col9 –∏ col10 —Å–∞ –ø—Ä–∞–∑–Ω–∏, —Ç–æ–≤–∞ —Ç—Ä—è–±–≤–∞ –¥–∞ –∏–∑–≥–ª–µ–∂–¥–∞ —Ç–∞–∫–∞: ...;{col8};;;{col11};{col12};... (—Ç—Ä–∏ ';' –ø–æ–¥—Ä–µ–¥ —Å–ª–µ–¥ col8).","–ü–ê–†–¢–ù–¨–û–† (–∫–æ–ª–æ–Ω–∏ 4‚Äì6): –ó–∞ docType 4 (–§–∞–∫—Ç—É—Ä–∞ –ø–æ–∫—É–ø–∫–∞) –ø–∞—Ä—Ç–Ω—å–æ—Ä –µ –î–û–°–¢–ê–í–ß–ò–ö–™–¢/–ò–ó–î–ê–¢–ï–õ–Ø–¢, –∞ –Ω–µ –Ω–∞—à–∞—Ç–∞ —Ñ–∏—Ä–º–∞.",`–¢–µ–∫—Å—Ç–æ–≤–∏ –ø–æ–ª–µ—Ç–∞ (–Ω–∞–ø—Ä. –∫–æ–ª–æ–Ω–∞ 4, 10, 11, 25): –ù–ï –∏–∑–ø–æ–ª–∑–≤–∞–π —Å–∏–º–≤–æ–ª–∏ " ' / \\\\ &`,"–û–ë–©–ò –°–¢–û–ô–ù–û–°–¢–ò: –ö–æ–ª–æ–Ω–∏ 19 (—Ç–æ—Ç–∞–ª —Å –î–î–°), 20 (–î–î–°), 21 (–ü–ª–∞—Ç–µ–Ω–æ) —Å–µ –ø–æ–ø—ä–ª–≤–∞—Ç –°–ê–ú–û –Ω–∞ –ø—ä—Ä–≤–∏—è —Ä–µ–¥ –∑–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞. –ù–∞ –≤—Å–∏—á–∫–∏ —Å–ª–µ–¥–≤–∞—â–∏ —Ä–µ–¥–æ–≤–µ —Å–∞ –ø—Ä–∞–∑–Ω–∏.","–í–ê–õ–£–¢–ê (–∫—Ä–∏—Ç–∏—á–Ω–æ –ø—Ä–∞–≤–∏–ª–æ):","–î–æ–∫—É–º–µ–Ω—Ç–Ω–∞ –≤–∞–ª—É—Ç–∞ = –≤–∞–ª—É—Ç–∞—Ç–∞ –Ω–∞ –∫—Ä–∞–π–Ω–∞—Ç–∞ —Å—É–º–∞ –∑–∞ –ø–ª–∞—â–∞–Ω–µ.","–ü–æ –ø–æ–¥—Ä–∞–∑–±–∏—Ä–∞–Ω–µ –ø—Ä–∏–µ–º–∞–π EUR –∞–∫–æ –Ω—è–º–∞ –∏–∑—Ä–∏—á–Ω–æ –ø–æ—Å–æ—á–µ–Ω–∞ –¥—Ä—É–≥–∞ –≤–∞–ª—É—Ç–∞.","–ê–∫–æ –¥–æ–∫—É–º–µ–Ω—Ç–Ω–∞—Ç–∞ –≤–∞–ª—É—Ç–∞ –µ EUR –∏–ª–∏ BGN ‚Üí –æ—Å—Ç–∞–≤–∏ –∫–æ–ª–æ–Ω–∞ 23 (Currency) –ø—Ä–∞–∑–Ω–∞.","–ê–∫–æ –¥–æ–∫—É–º–µ–Ω—Ç–Ω–∞—Ç–∞ –≤–∞–ª—É—Ç–∞ –µ EUR –∏–ª–∏ BGN ‚Üí –æ—Å—Ç–∞–≤–∏ –∫–æ–ª–æ–Ω–∞ 24 (Exchange_Rate) –ø—Ä–∞–∑–Ω–∞.","–ê–∫–æ –¥–æ–∫—É–º–µ–Ω—Ç–Ω–∞—Ç–∞ –≤–∞–ª—É—Ç–∞ –µ —Ä–∞–∑–ª–∏—á–Ω–∞ –æ—Ç EUR –∏ BGN (–Ω–∞–ø—Ä–∏–º–µ—Ä USD, GBP –∏ –¥—Ä.) ‚Üí","  - –ø–æ–ø—ä–ª–Ω–∏ –∫–æ–ª–æ–Ω–∞ 23 —Å –≤–∞–ª—É—Ç–Ω–∏—è –∫–æ–¥.","  - –ø–æ–ø—ä–ª–Ω–∏ –∫–æ–ª–æ–Ω–∞ 24 —Å –∫—É—Ä—Å–∞ (–∞–∫–æ –ª–∏–ø—Å–≤–∞ ‚Äì 1).","BGN —Å—Ç–æ–π–Ω–æ—Å—Ç–∏, –∏–∑–ø–∏—Å–∞–Ω–∏ –∫–∞—Ç–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ –ø—Ä–µ–∏–∑—á–∏—Å–ª–µ–Ω–∏–µ, –ù–ï –æ–ø—Ä–µ–¥–µ–ª—è—Ç –≤–∞–ª—É—Ç–∞—Ç–∞ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞.","–ß–ò–°–õ–ê: –î–µ—Å–µ—Ç–∏—á–µ–Ω —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª '.' –±–µ–∑ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏ –∑–∞ —Ö–∏–ª—è–¥–∏ (–ø—Ä–∏–º–µ—Ä 1234.50). –î–∞—Ç–∏ dd.mm.yyyy.","–°–ò–°–¢–ï–ú–ù–ò –ö–û–õ–û–ù–ò: –ö–æ–ª–æ–Ω–∞ 36 –∏ 37 —Å–∞ –°–ò–°–¢–ï–ú–ù–ò –∏ –í–ò–ù–ê–ì–ò –ø—Ä–∞–∑–Ω–∏. –ù–∏–∫–æ–≥–∞ –Ω–µ –∑–∞–ø–∏—Å–≤–∞–π —Å—É–º–∏ –∏–ª–∏ —Ç–µ–∫—Å—Ç –≤ –∫–æ–ª–æ–Ω–∞ 36 –∏–ª–∏ 37.","–ü–õ–ê–©–ê–ù–ï ‚Äî –ö–û–î (–∫–æ–ª–æ–Ω–∞ 18): 1=–í –±—Ä–æ–π, 2=–ü–æ —Å–º–µ—Ç–∫–∞, 4=–° –∫–∞—Ä—Ç–∞, 9=–°–º–µ—Å–µ–Ω–æ.","–ü–õ–ê–©–ê–ù–ï ‚Äî –ü–ò–ù: –ö–æ–ª–æ–Ω–∞ 38=–ü–ª–∞—Ç–µ–Ω–æ –≤ –±—Ä–æ–π, –∫–æ–ª–æ–Ω–∞ 39=–ü–ª–∞—Ç–µ–Ω–æ —Å –∫–∞—Ä—Ç–∞, –∫–æ–ª–æ–Ω–∞ 40=–í–∞—É—á–µ—Ä. –ù–µ —Ä–∞–∑–º–µ–Ω—è–π —Ç–µ–∑–∏ –∫–æ–ª–æ–Ω–∏.","–ü–õ–ê–©–ê–ù–ï ‚Äî –ü–†–ê–í–ò–õ–û: –ê–∫–æ –∫–æ–ª–æ–Ω–∞ 18=1 (–í –±—Ä–æ–π), —Ç–æ–≥–∞–≤–∞ –Ω–∞ –ü–™–†–í–ò–Ø —Ä–µ–¥: –∫–æ–ª–æ–Ω–∞ 38 = –∫–æ–ª–æ–Ω–∞ 21 (–∏–ª–∏ –∫–æ–ª–æ–Ω–∞ 19 –∞–∫–æ 21 –µ –ø—Ä–∞–∑–Ω–∞). –ö–æ–ª–æ–Ω–∏ 39 –∏ 40 –æ—Å—Ç–∞–≤–∞—Ç –ø—Ä–∞–∑–Ω–∏.","–ü–õ–ê–©–ê–ù–ï ‚Äî –ü–†–ê–í–ò–õ–û: –ê–∫–æ –∫–æ–ª–æ–Ω–∞ 18=4 (–° –∫–∞—Ä—Ç–∞), —Ç–æ–≥–∞–≤–∞ –Ω–∞ –ü–™–†–í–ò–Ø —Ä–µ–¥: –∫–æ–ª–æ–Ω–∞ 39 = –∫–æ–ª–æ–Ω–∞ 21 (–∏–ª–∏ –∫–æ–ª–æ–Ω–∞ 19 –∞–∫–æ 21 –µ –ø—Ä–∞–∑–Ω–∞). –ö–æ–ª–æ–Ω–∏ 38 –∏ 40 –æ—Å—Ç–∞–≤–∞—Ç –ø—Ä–∞–∑–Ω–∏.","–ü–õ–ê–©–ê–ù–ï ‚Äî –ü–†–ê–í–ò–õ–û: –ê–∫–æ –∫–æ–ª–æ–Ω–∞ 18=2 (–ü–æ —Å–º–µ—Ç–∫–∞), –æ—Å—Ç–∞–≤–∏ –∫–æ–ª–æ–Ω–∏ 38‚Äì40 –ø—Ä–∞–∑–Ω–∏ (–æ—Å–≤–µ–Ω –∞–∫–æ –¥–æ–∫—É–º–µ–Ω—Ç—ä—Ç –∏–∑—Ä–∏—á–Ω–æ —Ä–∞–∑–ø—Ä–µ–¥–µ–ª—è —Å—É–º–∏ –ø–æ –º–µ—Ç–æ–¥).","–ü–õ–ê–©–ê–ù–ï ‚Äî –°–ú–ï–°–ï–ù–û: –ê–∫–æ –∫–æ–ª–æ–Ω–∞ 18=9, –ø–æ–ø—ä–ª–Ω–∏ 38/39/40 —Å–∞–º–æ –∞–∫–æ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∏–º–∞ –Ø–°–ù–ò —Å—É–º–∏ –ø–æ –º–µ—Ç–æ–¥ (–ø—Ä–∏–º–µ—Ä '–≤ –±—Ä–æ–π 20', '—Å –∫–∞—Ä—Ç–∞ 60', '–≤–∞—É—á–µ—Ä 10'). –¢–æ–≥–∞–≤–∞ –∫–æ–ª–æ–Ω–∞ 21 = 38+39+40. –ê–∫–æ –Ω—è–º–∞ —è—Å–Ω–∏ —Å—É–º–∏ –ø–æ –º–µ—Ç–æ–¥ ‚Äî –ø–æ–ø—ä–ª–Ω–∏ —Å–∞–º–æ –∫–æ–ª–æ–Ω–∞ 21 –∏ –æ—Å—Ç–∞–≤–∏ 38‚Äì40 –ø—Ä–∞–∑–Ω–∏.","–ê–ù–¢–ò-–î–£–ë–õ–ò–†–ê–ù–ï: –ù–µ –¥—É–±–ª–∏—Ä–∞–π –ø–æ–∑–∏—Ü–∏–∏. –í—Å–µ–∫–∏ –∞—Ä—Ç–∏–∫—É–ª –æ—Ç —Ç–∞–±–ª–∏—á–Ω–∞—Ç–∞ —á–∞—Å—Ç —Å–µ –∏–∑–≤–µ–∂–¥–∞ —Ç–æ—á–Ω–æ –≤–µ–¥–Ω—ä–∂.","–ê–ù–¢–ò-–î–£–ë–õ–ò–†–ê–ù–ï (–µ–¥–Ω–æ–ø–æ–∑–∏—Ü–∏–æ–Ω–µ–Ω –¥–æ–∫—É–º–µ–Ω—Ç): –ê–∫–æ –¥–æ–∫—É–º–µ–Ω—Ç—ä—Ç —Å—ä–¥—ä—Ä–∂–∞ —Å–∞–º–æ 1 –ø–æ–∑–∏—Ü–∏—è (1 –∞—Ä—Ç–∏–∫—É–ª), –≤—ä—Ä–Ω–∏ –¢–û–ß–ù–û 1 CSV —Ä–µ–¥. –ù–µ –ø–æ–≤—Ç–∞—Ä—è–π —Ä–µ–¥–∞ –≤—Ç–æ—Ä–∏ –ø—ä—Ç.","–°–ê–ú–û–ö–û–ù–¢–†–û–õ –î–£–ë–õ–ò–†–ê–ù–ï: –ê–∫–æ –¥–≤–∞ —Ä–µ–¥–∞ –∏–º–∞—Ç –µ–¥–Ω–∞–∫–≤–∏ –∫–æ–ª–æ–Ω–∏ 1‚Äì16 –∏ –µ–¥–Ω–∞–∫–≤–∞ –∫–æ–ª–æ–Ω–∞ 11 (–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ), –æ—Å—Ç–∞–≤–∏ —Å–∞–º–æ –ø—ä—Ä–≤–∏—è –∏ –ø—Ä–µ–º–∞—Ö–Ω–∏ –ø–æ–≤—Ç–∞—Ä—è—â–∏—è —Å–µ —Ä–µ–¥.","–ê–ù–ö–û–† (–∫—Ä–∏—Ç–∏—á–Ω–æ) –ó–ê –ö–†–ê–Ø –ù–ê –†–ï–î–ê: –ö–æ–ª–æ–Ω–∏ 36 –∏ 37 —Å–∞ –≤–∏–Ω–∞–≥–∏ –ø—Ä–∞–∑–Ω–∏, —Ç–∞–∫–∞ —á–µ –º–µ–∂–¥—É –∫–æ–ª–æ–Ω–∞ 35 –∏ –∫–æ–ª–æ–Ω–∞ 38 –≤–∏–Ω–∞–≥–∏ –∏–º–∞ –¢–û–ß–ù–û ';;;'.","–®–ê–ë–õ–û–ù –ó–ê –ö–û–õ–û–ù–ò 34‚Äì44 (–∑–∞–∫–æ—Ç–≤—è–Ω–µ –Ω–∞ –∫—Ä–∞—è): {col34};{col35};;;{col38};{col39};{col40};{col41};{col42};{col43};{col44}. –¢–æ–≤–∞ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–∞, —á–µ –∫–æ–ª–æ–Ω–∞ 38 –µ '–ü–ª–∞—Ç–µ–Ω–æ –≤ –±—Ä–æ–π', –∞ –∫–æ–ª–æ–Ω–∞ 37 –æ—Å—Ç–∞–≤–∞ –ø—Ä–∞–∑–Ω–∞.","–ó–ê–ë–†–ê–ù–ê: –ù–∏–∫–æ–≥–∞ –Ω–µ –ø–æ—Å—Ç–∞–≤—è–π —Å—É–º–∞ –≤ –∫–æ–ª–æ–Ω–∞ 36 –∏–ª–∏ 37. –ê–∫–æ –∏–º–∞ —Å—É–º–∞ –∑–∞ –ø–ª–∞—â–∞–Ω–µ –≤ –±—Ä–æ–π, —Ç—è –º–æ–∂–µ –¥–∞ –±—ä–¥–µ —Å–∞–º–æ –≤ –∫–æ–ª–æ–Ω–∞ 38 (–Ω–∞ –ø—ä—Ä–≤–∏—è —Ä–µ–¥).","–°–ê–ú–û–ö–û–ù–¢–†–û–õ –ü–†–ï–î–ò –ò–ó–•–û–î: –ó–∞ –≤—Å–µ–∫–∏ —Ä–µ–¥ –ø—Ä–µ–±—Ä–æ–π ';' ‚Äî —Ç—Ä—è–±–≤–∞ –¥–∞ —Å–∞ —Ç–æ—á–Ω–æ 43. –ê–∫–æ —Å–∞ 42 –∏–ª–∏ 44+, –∫–æ—Ä–∏–≥–∏—Ä–∞–π –ø—Ä–∞–∑–Ω–∏—Ç–µ –ø–æ–ª–µ—Ç–∞ —Ç–∞–∫–∞ —á–µ –¥–∞ —Å—Ç–∞–Ω–∞—Ç —Ç–æ—á–Ω–æ 43."],nt={format:"–í—Å–µ–∫–∏ —Ä–µ–¥ —Ç—Ä—è–±–≤–∞ –¥–∞ –∏–º–∞ —Ç–æ—á–Ω–æ 43 ';' (–¢–û–ß–ù–û 44 –∫–æ–ª–æ–Ω–∏).",anchors:"–ê–∫–æ –Ω—è–º–∞ –≥—Ä—É–ø–∞ –∏ –ø–æ–¥–≥—Ä—É–ø–∞, —Å–ª–µ–¥ col8 —Ç—Ä—è–±–≤–∞ –¥–∞ –∏–º–∞ ';;;', –∑–∞ –¥–∞ –ø–æ–ø–∞–¥–Ω–µ –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –≤ col11. –û—Å–≤–µ–Ω —Ç–æ–≤–∞, –º–µ–∂–¥—É col35 –∏ col38 —Ç—Ä—è–±–≤–∞ –¥–∞ –∏–º–∞ ';;;' (col36 –∏ col37 –≤–∏–Ω–∞–≥–∏ –ø—Ä–∞–∑–Ω–∏).",systemCols:"–ö–æ–ª–æ–Ω–∏ 36 –∏ 37 –≤–∏–Ω–∞–≥–∏ –ø—Ä–∞–∑–Ω–∏ (–Ω–µ —Å—ä–¥—ä—Ä–∂–∞—Ç —Ç–µ–∫—Å—Ç/—Å—É–º–∏).",paymentSplit:"–ö–æ–ª–æ–Ω–∞ 38=–ö–µ—à, 39=–ö–∞—Ä—Ç–∞, 40=–í–∞—É—á–µ—Ä (—Å–∞–º–æ –ø—ä—Ä–≤–∏ —Ä–µ–¥).",noDupes:"–ù–µ –¥—É–±–ª–∏—Ä–∞–π –ø–æ–∑–∏—Ü–∏–∏: –µ–¥–∏–Ω –∞—Ä—Ç–∏–∫—É–ª = –µ–¥–∏–Ω CSV —Ä–µ–¥. –ê–∫–æ –∏–º–∞ —Å–∞–º–æ 1 –ø–æ–∑–∏—Ü–∏—è, –≤—ä—Ä–Ω–∏ —Ç–æ—á–Ω–æ 1 —Ä–µ–¥."},st={extractionSettings:He,columns:Ye,documentTypes:Qe,entityTypes:Je,objectTypes:Xe,vatTypes:Ze,paymentTypes:et,extractionInstructions:tt,validationRules:nt};function rt(n){const a=[];(!n.documentNumber||n.documentNumber.trim()==="")&&a.push("–ü–æ–ª–µ—Ç–æ –ù–æ–º–µ—Ä –µ –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–æ"),(!n.partnerName||n.partnerName.trim()==="")&&a.push("–ü–æ–ª–µ—Ç–æ –ü–∞—Ä—Ç–Ω—å–æ—Ä –µ –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–æ");const l=/^\d{2}\.\d{2}\.\d{4}$/;if(!n.documentDate||!l.test(n.documentDate))a.push("–ù–µ–≤–∞–ª–∏–¥–µ–Ω —Ñ–æ—Ä–º–∞—Ç –Ω–∞ –¥–∞—Ç–∞. –ò–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ dd.mm.yyyy");else{const[g,d,r]=n.documentDate.split(".").map(Number),x=new Date(r,d-1,g);(x.getDate()!==g||x.getMonth()!==d-1||x.getFullYear()!==r)&&a.push("–ù–µ–≤–∞–ª–∏–¥–Ω–∞ –¥–∞—Ç–∞")}return(typeof n.profitMarkupPercent!="number"||n.profitMarkupPercent<0)&&a.push("–ù–∞–¥—Ü–µ–Ω–∫–∞—Ç–∞ —Ç—Ä—è–±–≤–∞ –¥–∞ –±—ä–¥–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª–Ω–æ —á–∏—Å–ª–æ"),{valid:a.length===0,errors:a}}function ot(n,a){const l=parseFloat(n);if(isNaN(l))return n;const g=l*(1+a/100);return(Math.round(g*100)/100).toFixed(2)}function at(n){let a=0;for(const d of n)if(d.length>15&&d[15]){const r=parseFloat(d[15]);isNaN(r)||(a+=r)}const l=0,g=a;return{totalValue:Math.round(a*100)/100,vatAmount:Math.round(l*100)/100,totalWithVAT:Math.round(g*100)/100}}function lt(n,a){const l=n.map(d=>[...d]);for(let d=0;d<l.length;d++){const r=l[d];for(;r.length<44;)r.push("");if(r[0]="1",r[1]=a.documentDate,r[2]=a.documentNumber,r[3]=a.partnerName,r[4]=a.partnerEIK||"",r[5]=a.partnerVAT||"",r[14]){const x=ot(r[14],a.profitMarkupPercent);r[14]=x;const E=parseFloat(r[13])||1,_=parseFloat(x);if(!isNaN(_)&&!isNaN(E)){const C=_*E;r[15]=C.toFixed(2)}}r[16]="–î–î–°0",r[17]="2",r[21]="",r[22]="",r[23]="",r[24]="",r[25]="",r[26]="",r[27]="",r[28]="",r[29]="",r[30]="",r[31]="",r[32]="",r[33]="",r[34]="",r[35]="",r[36]="",r[37]="",r[38]="",r[39]="",r[40]="",r[41]="",r[42]="",r[43]=""}const g=at(l);if(l.length>0){l[0][18]=g.totalWithVAT.toFixed(2),l[0][19]="0",l[0][20]=g.totalWithVAT.toFixed(2);for(let d=1;d<l.length;d++)l[d][18]="",l[d][19]="",l[d][20]=""}return l}async function it(n){try{if(typeof Excel>"u")throw new Error("Excel environment not available");if(n.length===0)throw new Error("No sales data to append");await Excel.run(async a=>{const l=a.workbook.worksheets.getActiveWorksheet(),g=l.getUsedRange();g.load(["rowIndex","rowCount"]),await a.sync();const d=g.rowIndex+g.rowCount,r=Math.max(...n.map(_=>_.length)),x=n.map(_=>{const C=[..._];for(;C.length<r;)C.push("");return C}),E=l.getRangeByIndexes(d,0,n.length,r);E.values=x,await a.sync()})}catch(a){throw console.error("Error appending sales data to Excel:",a),new Error("–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤—è–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏ –≤ Excel")}}async function ct(){try{return typeof Excel>"u"?(console.error("Excel environment not available"),[]):await Excel.run(async n=>{const l=n.workbook.worksheets.getActiveWorksheet().getUsedRangeOrNullObject();if(l.load(["isNullObject","values","rowCount","columnCount"]),await n.sync(),l.isNullObject||l.rowCount===0)return[];const g=l.values,d=[],r=g[0],E=r&&r.some(_=>typeof _=="string"&&(_.includes("–í–∏–¥")||_.includes("–î–æ–∫—É–º–µ–Ω—Ç")||_.includes("–î–∞—Ç–∞")||_.includes("–ü–∞—Ä—Ç–Ω—å–æ—Ä")))?1:0;for(let _=E;_<g.length;_++){const C=g[_],R=[];for(let O=0;O<C.length;O++){const B=C[O],te=B==null?"":String(B);R.push(te)}const W=R.length>0?R[0]:"";(W==="4"||W==="4-METRO")&&d.push(R)}return d})}catch(n){return console.error("Error reading all purchase invoices from Excel:",n),[]}}const Y=n=>n==="7"?We:n==="4-METRO"?st:ee,dt=n=>n==="4-METRO"?"4":n;var ve;const le=((ve=ee.columns.find(n=>n.columnNumber===8))==null?void 0:ve.allowedValues)||["–°—Ç–æ–∫–∏","–ú–∞—Ç–µ—Ä–∏–∞–ª–∏","–ü—Ä–æ–¥—É–∫—Ü–∏—è","–£—Å–ª—É–≥–∏","–†–∞–∑—Ö–æ–¥–∏ –∑–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–∏","–ê–≤–∞–Ω—Å","–ü—Ä–∏—Å–ø–∞–¥–∞–Ω–µ –Ω–∞ –∞–≤–∞–Ω—Å","–î—ä–ª–≥–æ—Ç—Ä–∞–π–Ω–∏ –∞–∫—Ç–∏–≤–∏"];var je;const ie=((je=ee.columns.find(n=>n.columnNumber===7))==null?void 0:je.allowedValues)||["–°–¢–û–ö–ò","–ú–ê–¢–ï–†–ò–ê–õ–ò","–ü–†–û–î–£–ö–¶–ò–Ø"],U="__MANUAL__",Ne=(n,a)=>n===U?a.trim():(n||"").trim(),we=(n,a)=>n===U?a.trim():(n||"").trim(),ue=[{code:"–ù–ï–†–ï–ì",desc:"–ù–µ—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–∞–Ω–æ –ª–∏—Ü–µ –ø–æ –î–î–°",group:"NO_VAT"},{code:"–î–î–°20",desc:"–û–±–ª. (20%)",group:"VAT_20"},{code:"–î–î–°9",desc:"–û–±–ª. (9%)",group:"VAT_9"},{code:"–î–î–°0",desc:"–û–î (0%)",group:"VAT_0"},{code:"–ë–î–ö",desc:"–ë–µ–∑ –ø—Ä–∞–≤–æ –Ω–∞ –î–ö",group:"NO_VAT"},{code:"–í–û–î",desc:"–í–û–î",group:"VAT_0"},{code:"–û–°–í",desc:"–û–î –∏ –û—Å–≤. –í–û–ü",group:"VAT_0"},{code:"–î–î–°20/9",desc:"–ö–æ–º–±–∏–Ω–∏—Ä–∞–Ω–∞ —Å–¥–µ–ª–∫–∞ 20%/9%/0%",group:"MIXED"},{code:"–î140",desc:"–î-–∫–∏ –ø–æ —á–ª. 140, 146, —á–ª. 173 –ó–î–î–°",group:"VAT_0"},{code:"–î21",desc:"–î-–∫–∏ –Ω–∞ —É-–≥–∏ –ø–æ —á–ª. 21(2) –ó–î–î–° (–ï–°)",group:"VAT_0"},{code:"–î69",desc:"–î-–∫–∏ –ø–æ —á–ª. 69(2) –∏ –¥–∏—Å—Ç. –ø—Ä–æ–¥-–±–∏ (–ï–°)",group:"VAT_0"},{code:"–î–ü–¢–û",desc:"–î-–∫–∏ –∫–∞—Ç–æ –ø–æ—Å—Ä–µ–¥–Ω–∏–∫ –≤ —Ç—Ä–∏—Å—Ç—Ä. –æ–ø–µ—Ä–∞—Ü–∏–∏",group:"VAT_0"},{code:"–ù20",desc:"–ù–∞—á–∏—Å–ª–µ–Ω –¥–∞–Ω—ä–∫ (20%) –≤ –¥—Ä. —Å–ª—É—á–∞–∏",group:"VAT_20"},{code:"–î143",desc:"–î-–∫–∏ –ø–æ —á–ª. 143 (1) –ó–î–î–°",group:"VAT_0"},{code:"–ù1139",desc:"–ù–µ–Ω–∞—á. –Ω–∞ –î–î–°, —Å—ä–≥–ª. —á–ª. 113 (9)",group:"NO_VAT"},{code:"–ü–¢–†",desc:"–ü—Ä–∏–¥–æ–±–∏–≤–∞–Ω–µ –∫–∞—Ç–æ –ø–æ—Å—Ä–µ–¥–Ω–∏–∫ –≤ —Ç—Ä–∏—Å—Ç—Ä–∞–Ω–Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏—è",group:"VAT_0"},{code:"–ü–†–ò–õ21",desc:"–ü—Ä–∏–ª. 2-–Ü/–î–æ—Å—Ç. –ø–æ –ø—Ä–∏–ª. 2 —á–∞—Å—Ç I",group:"NO_VAT"},{code:"–ü–†–ò–õ22",desc:"–ü—Ä–∏–ª. 2-II/–î–æ—Å—Ç. –ø–æ –ø—Ä–∏–ª. 2 —á–∞—Å—Ç II",group:"NO_VAT"},{code:"–ß–î–ö",desc:"–° –ø—Ä–∞–≤–æ –Ω–∞ —á–∞—Å—Ç–∏—á–µ–Ω –î–ö",group:"NO_VAT"}],ut=new Set(ue.map(n=>n.code)),de=n=>{const a=(n??"").toString().trim();return a?a.split("-")[0].trim():""},ce=n=>{if(n==null)return NaN;const a=String(n).trim().replace(",",".");if(!a)return NaN;const l=Number(a);return Number.isFinite(l)?l:NaN},Te=n=>["1","2","3","7"].includes(n),Ee=n=>["4","5","6"].includes(n),mt=n=>{const a=((n==null?void 0:n[0])??"").toString().trim(),l=((n==null?void 0:n[16])??"").toString().trim(),g=ce(n==null?void 0:n[19]),d=ce(n==null?void 0:n[25]),r=ce(n==null?void 0:n[26]),x=de(l),E=ue.find(C=>C.code===x);if(E)return E.group;if(Number.isFinite(g)&&g>0){const C=Number.isFinite(d)&&d>0,R=Number.isFinite(r)&&r>0;return C&&R?"MIXED":R?"VAT_9":"VAT_20"}return Number.isFinite(d)&&d>0||Number.isFinite(r)&&r>0?"ALL":Te(a)?"VAT_0":(Ee(a),"ALL")},pt=(n,a)=>{const l=new Set(["–î140","–î21","–î69","–î–ü–¢–û","–ù20","–î143","–ù1139"]),g=new Set(["–ü–¢–†","–ü–†–ò–õ21","–ü–†–ò–õ22","–ß–î–ö"]),d=Te(n),r=Ee(n);return ue.filter(x=>(a==="ALL"?!0:x.group===a)?l.has(x.code)?d:g.has(x.code)?r:!0:!1)},gt=(n,a)=>pt(n,a).map(g=>g.code).join(","),ht=()=>{const[n,a]=T.useState([]),[l,g]=T.useState(!1),[d,r]=T.useState(!1),[x,E]=T.useState(null),[_,C]=T.useState(null),[R,W]=T.useState(""),[O,B]=T.useState("gemini-2.0-flash"),[te,z]=T.useState(!1),[Q,J]=T.useState(!1),[Ce,me]=T.useState(!1),[V,_e]=T.useState("4"),[X,Se]=T.useState(le[0]||"–°—Ç–æ–∫–∏"),[K,Ae]=T.useState(ie[0]||"–ú–ê–¢–ï–†–ò–ê–õ–ò"),[ne,pe]=T.useState(""),[se,ge]=T.useState(""),[Re,re]=T.useState(!1),[he,oe]=T.useState(!1),[k,H]=T.useState({documentNumber:"",partnerName:"",partnerEIK:"",partnerVAT:"",documentDate:(()=>{const t=new Date,s=String(t.getDate()).padStart(2,"0"),i=String(t.getMonth()+1).padStart(2,"0"),o=t.getFullYear();return`${s}.${i}.${o}`})(),profitMarkupPercent:40}),Z=T.useRef(null);T.useEffect(()=>{if(typeof Office<"u")Office.onReady(()=>{Ve()});else{const t=localStorage.getItem("gemini_api_key"),s=localStorage.getItem("gemini_model");t&&W(t),s&&B(s),t||z(!0)}},[]),T.useEffect(()=>{const t=s=>{Q&&(s.target.closest(".model-selector-container")||J(!1))};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[Q]);const Ve=()=>{try{if(typeof Office<"u"&&Office.context&&Office.context.roamingSettings){const t=Office.context.roamingSettings.get("gemini_api_key"),s=Office.context.roamingSettings.get("gemini_model");t&&W(t),s&&B(s),t||z(!0)}else{const t=localStorage.getItem("gemini_api_key"),s=localStorage.getItem("gemini_model");t&&W(t),s&&B(s),t||z(!0)}}catch(t){console.error("Error loading API keys:",t),z(!0)}},f=t=>{C(t),me(!0)},ke=()=>{C(null),me(!1)},xe=(t,s)=>{try{typeof Office<"u"&&Office.context&&Office.context.roamingSettings?(t&&Office.context.roamingSettings.set("gemini_api_key",t),Office.context.roamingSettings.set("gemini_model",s),Office.context.roamingSettings.saveAsync()):(t&&localStorage.setItem("gemini_api_key",t),localStorage.setItem("gemini_model",s)),t&&W(t),B(s),z(!1),C(null)}catch(i){console.error("Error saving API keys:",i),f("–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –∑–∞–ø–∞–∑–≤–∞–Ω–µ –Ω–∞ API –∫–ª—é—á–∞. –û–ø–∏—Ç–∞–π—Ç–µ –æ—Ç–Ω–æ–≤–æ.")}},Fe=t=>{const s=t.target.files;if(!s||s.length===0)return;const i=[];for(let o=0;o<s.length;o++){const u=s[o];let m=null;if(u.type.startsWith("image/")){const y=new FileReader;y.onload=b=>{var F;m=(F=b.target)==null?void 0:F.result,a(w=>[...w,{file:u,preview:m}])},y.readAsDataURL(u)}else i.push({file:u,preview:m})}i.length>0&&a(o=>[...o,...i]),E(null),C(null)},Ie=t=>{a(s=>s.filter((i,o)=>o!==t))},fe=()=>{a([]),E(null),C(null),re(!1),oe(!1),Z.current&&(Z.current.value="")},Oe=(t,s,i)=>{var I,$;const o=Y(t),u=((I=o.extractionSettings)==null?void 0:I.delimiter)||";",m=(($=o.extractionSettings)==null?void 0:$.minimumColumns)||44,y=dt(t),b=o.columns.slice(0,m).map((v,j)=>`${j+1}. ${v.name} - ${v.description}`).join(`
`),w={1:"–§–∞–∫—Ç—É—Ä–∞ –ø—Ä–æ–¥–∞–∂–±–∞",2:"–î–µ–±–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø—Ä–æ–¥–∞–∂–±–∞",3:"–ö—Ä–µ–¥–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø—Ä–æ–¥–∞–∂–±–∞",4:"–§–∞–∫—Ç—É—Ä–∞ –ø–æ–∫—É–ø–∫–∞","4-METRO":"–§–∞–∫—Ç—É—Ä–∞ –ø–æ–∫—É–ø–∫–∞ –ú–ï–¢–†–û",5:"–î–µ–±–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø–æ–∫—É–ø–∫–∞",6:"–ö—Ä–µ–¥–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø–æ–∫—É–ø–∫–∞",7:"–ö–∞—Å–æ–≤–∏ –ø—Ä–æ–¥–∞–∂–±–∏",8:"–¢—Ä–∞–Ω—Å—Ñ–µ—Ä",9:"–ë—Ä–∞–∫ (–†–ê–ó–•–û–î)",10:"–ë—Ä–∞–∫ (–ú–û–õ)",11:"–°–∫–ª–∞–¥–æ–≤–æ –∏—Å–∫–∞–Ω–µ",12:"–°—Ç–æ–∫–æ–≤–∞ —Ä–∞–∑–ø–∏—Å–∫–∞ (–°–¢)",13:"–°–∫–ª–∞–¥–æ–≤–∞ —Ä–∞–∑–ø–∏—Å–∫–∞ (–°–†)",14:"–î–∞–≤–∞–Ω–µ —Å—Ç–æ–∫–∏ –Ω–∞ –∫–æ–Ω—Å–∏–≥–Ω–∞—Ü–∏—è (–ö–î) —Å—ä—Å —Å—á–µ—Ç. –æ–ø–µ—Ä–∞—Ü–∏–∏",15:"–î–∞–≤–∞–Ω–µ —Å—Ç–æ–∫–∏ –Ω–∞ –∫–æ–Ω—Å–∏–≥–Ω–∞—Ü–∏—è (–ö–î) –±–µ–∑ —Å—á–µ—Ç. –æ–ø–µ—Ä–∞—Ü–∏–∏"}[t]||"",M=`
–õ–û–ì–ò–ö–ê –ó–ê –û–ü–†–ï–î–ï–õ–Ø–ù–ï –ù–ê –ü–ê–†–¢–ù–¨–û–†–ê –°–ü–û–†–ï–î –í–ò–î. –î–û–ö–£–ú–ï–ù–¢ (${y}${w?` ‚Äì ${w}`:""}):

- –ê–∫–æ –í–∏–¥. –î–æ–∫—É–º–µ–Ω—Ç –µ 1, 2, 3 –∏–ª–∏ 7 (—Ñ–∞–∫—Ç—É—Ä–∞/–∏–∑–≤–µ—Å—Ç–∏–µ –ø—Ä–æ–¥–∞–∂–±–∞, –∫–∞—Å–æ–≤–∏ –ø—Ä–æ–¥–∞–∂–±–∏):
  ‚Ä¢ –ù–∞—à–∞—Ç–∞ —Ñ–∏—Ä–º–∞ –µ –ò–ó–î–ê–¢–ï–õ/–î–û–°–¢–ê–í–ß–ò–ö.
  ‚Ä¢ –ü–∞—Ä—Ç–Ω—å–æ—Ä (–∫–æ–ª–æ–Ω–∏ 4‚Äì6) –µ –ü–û–õ–£–ß–ê–¢–ï–õ/–ö–£–ü–£–í–ê–ß (–∫–ª–∏–µ–Ω—Ç—ä—Ç).

- –ê–∫–æ –í–∏–¥. –î–æ–∫—É–º–µ–Ω—Ç –µ 4, 5 –∏–ª–∏ 6 (—Ñ–∞–∫—Ç—É—Ä–∞/–∏–∑–≤–µ—Å—Ç–∏–µ –ø–æ–∫—É–ø–∫–∞):
  ‚Ä¢ –ù–∞—à–∞—Ç–∞ —Ñ–∏—Ä–º–∞ –µ –ü–û–õ–£–ß–ê–¢–ï–õ/–ö–£–ü–£–í–ê–ß.
  ‚Ä¢ –ü–∞—Ä—Ç–Ω—å–æ—Ä (–∫–æ–ª–æ–Ω–∏ 4‚Äì6) –µ –ò–ó–î–ê–¢–ï–õ/–î–û–°–¢–ê–í–ß–ò–ö (–¥–æ—Å—Ç–∞–≤—á–∏–∫—ä—Ç).

- –ê–∫–æ –í–∏–¥. –î–æ–∫—É–º–µ–Ω—Ç –µ –æ—Ç 8 –¥–æ 15:
  ‚Ä¢ –ê–∫–æ –¥–æ–∫—É–º–µ–Ω—Ç—ä—Ç —Å—ä–¥—ä—Ä–∂–∞ –≤—ä–Ω—à–µ–Ω –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç (–¥—Ä—É–≥–∞ —Ñ–∏—Ä–º–∞ –∏–∑–≤—ä–Ω –Ω–∞—à–∞—Ç–∞) ‚Äì –∏–∑–ø–æ–ª–∑–≤–∞–π –Ω–µ–≥–æ –∫–∞—Ç–æ –ü–∞—Ä—Ç–Ω—å–æ—Ä (–∫–æ–ª–æ–Ω–∏ 4‚Äì6).
  ‚Ä¢ –ê–∫–æ –¥–æ–∫—É–º–µ–Ω—Ç—ä—Ç –µ —á–∏—Å—Ç–æ –≤—ä—Ç—Ä–µ—à–µ–Ω (–º–µ–∂–¥—É –Ω–∞—à–∏ —Å–∫–ª–∞–¥–æ–≤–µ/–æ–±–µ–∫—Ç–∏) ‚Äì –æ—Å—Ç–∞–≤–∏ –∫–æ–ª–æ–Ω–∏ 4‚Äì6 –ø—Ä–∞–∑–Ω–∏.

–ö–æ–ª–æ–Ω–∞ 4 ‚Äû–ü–∞—Ä—Ç–Ω—å–æ—Ä‚Äú –∏ –∫–æ–ª–æ–Ω–∞ 5 ‚Äû–ï–ò–ö‚Äú –í–ò–ù–ê–ì–ò –æ–ø–∏—Å–≤–∞—Ç –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞ (–¥—Ä—É–≥–∞—Ç–∞ —Å—Ç—Ä–∞–Ω–∞ –ø–æ —Å–¥–µ–ª–∫–∞—Ç–∞), –∞ –Ω–µ –Ω–∞—à–∞—Ç–∞ —Ñ–∏—Ä–º–∞.
`.trim();return`–¢–∏ —Å–∏ –µ–∫—Å–ø–µ—Ä—Ç –ø–æ –∏–∑–≤–ª–∏—á–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏ –æ—Ç —Ñ–∞–∫—Ç—É—Ä–∏ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –Ω–∞ CSV —Ñ–∞–π–ª–æ–≤–µ –∑–∞ –±—ä–ª–≥–∞—Ä—Å–∫–∞ —Å—á–µ—Ç–æ–≤–æ–¥–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –ü–ª—é—Å –ú–∏–Ω—É—Å.

–í–ê–ñ–ù–ê –ò–ù–§–û–†–ú–ê–¶–ò–Ø:
- –¢–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç (–∏–∑–±—Ä–∞–Ω –æ—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è): ${t}${w?` ‚Äì ${w}`:""}
- –¢–æ–∑–∏ –Ω–æ–º–µ—Ä –¢–†–Ø–ë–í–ê –¥–∞ –±—ä–¥–µ –ø–æ—Å—Ç–∞–≤–µ–Ω –≤ –ö–û–õ–û–ù–ê 1 (–ø—ä—Ä–≤–∞—Ç–∞ –∫–æ–ª–æ–Ω–∞) –Ω–∞ –í–°–ï–ö–ò —Ä–µ–¥ –æ—Ç –∏–∑–≤–ª–µ—á–µ–Ω–∏—Ç–µ –¥–∞–Ω–Ω–∏: ${y}
- –í–∏–¥ –Ω–∞ –∞—Ä—Ç–∏–∫—É–ª–∞ (–∏–∑–±—Ä–∞–Ω –æ—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è): ${s}
- –¢–∞–∑–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç –¢–†–Ø–ë–í–ê –¥–∞ –±—ä–¥–µ –ø–æ—Å—Ç–∞–≤–µ–Ω–∞ –≤ –ö–û–õ–û–ù–ê 8 (–í–∏–¥) –Ω–∞ –í–°–ï–ö–ò —Ä–µ–¥ –æ—Ç –∏–∑–≤–ª–µ—á–µ–Ω–∏—Ç–µ –¥–∞–Ω–Ω–∏.
- –û–±–µ–∫—Ç–∏ (–∏–∑–±—Ä–∞–Ω –æ—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è): ${i}
- –¢–∞–∑–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç –¢–†–Ø–ë–í–ê –¥–∞ –±—ä–¥–µ –ø–æ—Å—Ç–∞–≤–µ–Ω–∞ –≤ –ö–û–õ–û–ù–ê 7 –Ω–∞ –í–°–ï–ö–ò —Ä–µ–¥ –æ—Ç –∏–∑–≤–ª–µ—á–µ–Ω–∏—Ç–µ –¥–∞–Ω–Ω–∏.

${M}

–í –ï–î–ò–ù PDF –ú–û–ñ–ï –î–ê –ò–ú–ê –ù–Ø–ö–û–õ–ö–û –î–û–ö–£–ú–ï–ù–¢–ê:
- –û–±—Ä–∞–±–æ—Ç–≤–∞–π –≤—Å–µ–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç –ø–æ–æ—Ç–¥–µ–ª–Ω–æ.
- –ó–∞ –≤—Å–µ–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç —Å—ä–∑–¥–∞–≤–∞–π –æ—Ç–¥–µ–ª–Ω–∏ —Ä–µ–¥–æ–≤–µ –≤ CSV.

–ï–î–ò–ù CSV –†–ï–î = –ï–î–ù–ê –ü–û–ó–ò–¶–ò–Ø –û–¢ –î–û–ö–£–ú–ï–ù–¢–ê:
- –ó–∞ –í–°–Ø–ö–ê –ü–û–ó–ò–¶–ò–Ø (–∞—Ä—Ç–∏–∫—É–ª, —Ä–µ–¥ –æ—Ç —Ñ–∞–∫—Ç—É—Ä–∞—Ç–∞) —Å—ä–∑–¥–∞–π –æ—Ç–¥–µ–ª–µ–Ω —Ä–µ–¥.
- –ù–∞—á–∞–ª–Ω–∏—Ç–µ –ø–æ–ª–µ—Ç–∞ (–∫–æ–ª–æ–Ω–∏ 1‚Äì${m}) —Å–∞ –µ–¥–Ω–∞–∫–≤–∏ –∑–∞ –≤—Å–∏—á–∫–∏ —Ä–µ–¥–æ–≤–µ –æ—Ç –µ–¥–∏–Ω –¥–æ–∫—É–º–µ–Ω—Ç.
- –ü–æ–ª–µ—Ç–∞—Ç–∞ –∑–∞ –æ–±—â–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ (–û–±—â–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç, –î–î–°, –ü–ª–∞—Ç–µ–Ω–æ –∏ —Ç.–Ω.) —Å–µ –ø–æ–ø—ä–ª–≤–∞—Ç –°–ê–ú–û –Ω–∞ –ü–™–†–í–ò–Ø —Ä–µ–¥ –∑–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞.

CSV –§–û–†–ú–ê–¢:
- –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª –Ω–∞ –∫–æ–ª–æ–Ω–∏: "${u}"
- –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª –Ω–∞ —Ä–µ–¥–æ–≤–µ: CRLF (\\r\\n)
- –ë–ï–ó –∑–∞–≥–ª–∞–≤–µ–Ω —Ä–µ–¥.
- –í—Å–µ–∫–∏ —Ä–µ–¥ = –ï–î–ù–ê –ø–æ–∑–∏—Ü–∏—è (–∞—Ä—Ç–∏–∫—É–ª) –æ—Ç –¥–∞–¥–µ–Ω –¥–æ–∫—É–º–µ–Ω—Ç.

–ö–û–õ–û–ù–ò (–ú–ò–ù–ò–ú–£–ú ${m} –∫–æ–ª–æ–Ω–∏):
${b}

–í–ê–ñ–ù–Ü –ü–†–ê–í–ò–õ–ê:
1. –ö–û–õ–û–ù–ê 1 –í–ò–ù–ê–ì–ò —Å—ä–¥—ä—Ä–∂–∞ –Ω–æ–º–µ—Ä–∞ –Ω–∞ —Ç–∏–ø–∞ –¥–æ–∫—É–º–µ–Ω—Ç: ${y}
2. –ö–û–õ–û–ù–ê 7 –í–ò–ù–ê–ì–ò —Å—ä–¥—ä—Ä–∂–∞ –æ–±–µ–∫—Ç–∞: ${i}
3. –ö–û–õ–û–ù–ê 8 –í–ò–ù–ê–ì–ò —Å—ä–¥—ä—Ä–∂–∞ –≤–∏–¥–∞ –Ω–∞ –∞—Ä—Ç–∏–∫—É–ª–∞: ${s}
4. –í–ò–ù–ê–ì–ò –∏–∑–≤–µ–∂–¥–∞–π –ú–ò–ù–ò–ú–£–ú ${m} –∫–æ–ª–æ–Ω–∏ (1‚Äì${m}).
3. –ê–∫–æ –∏–º–∞—à –Ω–∞–¥–µ–∂–¥–Ω–∏ –¥–∞–Ω–Ω–∏ –∑–∞ –∫–æ–ª–æ–Ω–∏ —Å–ª–µ–¥ ${m}, –¥–æ–±–∞–≤–∏ –≥–∏ (–¥–æ –º–∞–∫—Å–∏–º—É–º ${ee.columns.length} –∫–æ–ª–æ–Ω–∏).
4. –ê–∫–æ –∫–æ–ª–æ–Ω–∞ –Ω—è–º–∞ –¥–∞–Ω–Ω–∏, –æ—Å—Ç–∞–≤–∏ —è –ø—Ä–∞–∑–Ω–∞ (–¥–≤–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–Ω–∏ "${u}").
5. –ö–æ–ª–æ–Ω–∞ 4 ‚Äû–ü–∞—Ä—Ç–Ω—å–æ—Ä‚Äú –∏ –∫–æ–ª–æ–Ω–∞ 5 ‚Äû–ï–ò–ö‚Äú –æ–ø–∏—Å–≤–∞—Ç –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞ (–¥—Ä—É–≥–∞—Ç–∞ —Å—Ç—Ä–∞–Ω–∞ –ø–æ —Å–¥–µ–ª–∫–∞—Ç–∞).

6. –î–∞—Ç–∏—Ç–µ —Å–∞ –≤—ä–≤ —Ñ–æ—Ä–º–∞—Ç dd.mm.yyyy.
7. –ß–∏—Å–ª–∞—Ç–∞ —Å–∞ –±–µ–∑ –≤–∞–ª—É—Ç–Ω–∏ —Å–∏–º–≤–æ–ª–∏.
8. –ù–µ –∏–∑–ø–æ–ª–∑–≤–∞–π —Å–∏–º–≤–æ–ª–∏ " ' / \\ & –≤ —Ç–µ–∫—Å—Ç–æ–≤–∏ –ø–æ–ª–µ—Ç–∞.

–î–û–ü–™–õ–ù–ò–¢–ï–õ–ù–ò –ò–ù–°–¢–†–£–ö–¶–ò–ò:
${o.extractionInstructions?o.extractionInstructions.map((v,j)=>`${j+1}. ${v}`).join(`
`):"–ù—è–º–∞ –¥–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∑–∞ —Ç–æ–∑–∏ —Ç–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç."}

–ò–ó–•–û–î:
–í—ä—Ä–Ω–∏ –°–ê–ú–û CSV –¥–∞–Ω–Ω–∏—Ç–µ, –±–µ–∑ –¥–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–µ–Ω —Ç–µ–∫—Å—Ç, –æ–±—è—Å–Ω–µ–Ω–∏—è –∏–ª–∏ markdown.
–ó–∞–ø–æ—á–Ω–∏ –¥–∏—Ä–µ–∫—Ç–Ω–æ —Å —Ä–µ–¥/—Ä–µ–¥–æ–≤–µ —Å –¥–∞–Ω–Ω–∏ (–ë–ï–ó –∑–∞–≥–ª–∞–≤–∏—è).
–í—Å–µ–∫–∏ —Ä–µ–¥ –¢–†–Ø–ë–í–ê –¥–∞ –∏–º–∞ –ú–ò–ù–ò–ú–£–ú ${m} —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ (–∫–æ–ª–æ–Ω–∏), —Ä–∞–∑–¥–µ–ª–µ–Ω–∏ —Å "${u}".
–ö–û–õ–û–ù–ê 1 –Ω–∞ –≤—Å–µ–∫–∏ —Ä–µ–¥ –¢–†–Ø–ë–í–ê –¥–∞ —Å—ä–¥—ä—Ä–∂–∞: ${y}
–ö–û–õ–û–ù–ê 7 –Ω–∞ –≤—Å–µ–∫–∏ —Ä–µ–¥ –¢–†–Ø–ë–í–ê –¥–∞ —Å—ä–¥—ä—Ä–∂–∞: ${i}
–ö–û–õ–û–ù–ê 8 –Ω–∞ –≤—Å–µ–∫–∏ —Ä–µ–¥ –¢–†–Ø–ë–í–ê –¥–∞ —Å—ä–¥—ä—Ä–∂–∞: ${s}`},ye=async()=>{var m,y,b,F,w,M,I,$;if(n.length===0)return;if(!V){f("–ú–æ–ª—è, –∏–∑–±–µ—Ä–µ—Ç–µ —Ç–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç.");return}if(!R){f("–ú–æ–ª—è, –≤—ä–≤–µ–¥–µ—Ç–µ Gemini API –∫–ª—é—á."),z(!0);return}const t=Ne(X,ne),s=we(K,se);if(!t){f('–ú–æ–ª—è, –∏–∑–±–µ—Ä–µ—Ç–µ "–í–∏–¥ –Ω–∞ –∞—Ä—Ç–∏–∫—É–ª–∞" –∏–ª–∏ –≤—ä–≤–µ–¥–µ—Ç–µ —Ä—ä—á–Ω–æ —Å—Ç–æ–π–Ω–æ—Å—Ç.');return}if(K!==U&&!s){f('–ú–æ–ª—è, –∏–∑–±–µ—Ä–µ—Ç–µ "–û–±–µ–∫—Ç–∏" –∏–ª–∏ –≤—ä–≤–µ–¥–µ—Ç–µ —Ä—ä—á–Ω–æ —Å—Ç–æ–π–Ω–æ—Å—Ç.');return}g(!0),C(null),E(null),J(!1);const i=Y(V),o=((m=i.extractionSettings)==null?void 0:m.delimiter)||";",u=((y=i.extractionSettings)==null?void 0:y.minimumColumns)||44;try{const v=[];for(let j=0;j<n.length;j++){const{file:P}=n[j],c=new FileReader,N=await new Promise((A,D)=>{c.onload=G=>{var be;const ae=((be=G.target)==null?void 0:be.result).split(",")[1];A(ae)},c.onerror=D,c.readAsDataURL(P)}),p=Oe(V,t,s);let h="";if(O==="gemini-2.5-flash"||O==="gemini-2.5-pro"){const A=`https://generativelanguage.googleapis.com/v1/models/${O}:generateContent?key=${R}`,D={contents:[{parts:[{text:p},{inline_data:{mime_type:P.type,data:N}}]}]},G=await fetch(A,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(D)});if(!G.ok){const ae=await G.json();throw new Error(`Gemini API error: ${((b=ae.error)==null?void 0:b.message)||G.statusText}`)}h=(($=(I=(M=(w=(F=(await G.json()).candidates)==null?void 0:F[0])==null?void 0:w.content)==null?void 0:M.parts)==null?void 0:I[0])==null?void 0:$.text)||""}else h=((await new Be({apiKey:R}).chats.create({model:O}).sendMessage({message:[{text:p},{inlineData:{mimeType:P.type,data:N}}]})).text||"").trim();let S=h.trim();S.startsWith("```")&&(S=S.replace(/```csv\n?/gi,"").replace(/```\n?/g,"").trim());const q=S.split(/\r?\n/).map(A=>A.trim()).filter(A=>A.length>0);for(const A of q){const D=A.split(o);for(;D.length<u;)D.push("");v.push(D)}}if(v.length===0)f("–ù–µ –±—è—Ö–∞ –Ω–∞–º–µ—Ä–µ–Ω–∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏ –¥–∞–Ω–Ω–∏ –æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ç–µ –∏–ª–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç—ä—Ç –µ –ø—Ä–∞–∑–µ–Ω."),E(null);else{const j=`invoices_${Date.now()}.csv`;E({rows:v,fileName:j})}}catch(v){console.error(v),f(v instanceof Error?v.message:"–í—ä–∑–Ω–∏–∫–Ω–∞ –≥—Ä–µ—à–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞—Ç–∞ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ç–µ.")}finally{g(!1)}},Pe=async()=>{if(n.length===0)return;if(V!=="7"){f("RTF –æ–±—Ä–∞–±–æ—Ç–∫–∞—Ç–∞ –µ –¥–æ—Å—Ç—ä–ø–Ω–∞ —Å–∞–º–æ –∑–∞ –¥–æ–∫—É–º–µ–Ω—Ç —Ç–∏–ø 7 - –ö–∞—Å–æ–≤–∏ –ø—Ä–æ–¥–∞–∂–±–∏.");return}const t=Ne(X,ne),s=we(K,se);if(!t){f('–ú–æ–ª—è, –∏–∑–±–µ—Ä–µ—Ç–µ "–í–∏–¥ –Ω–∞ –∞—Ä—Ç–∏–∫—É–ª–∞" –∏–ª–∏ –≤—ä–≤–µ–¥–µ—Ç–µ —Ä—ä—á–Ω–æ —Å—Ç–æ–π–Ω–æ—Å—Ç.');return}if(K!==U&&!s){f('–ú–æ–ª—è, –∏–∑–±–µ—Ä–µ—Ç–µ "–û–±–µ–∫—Ç–∏" –∏–ª–∏ –≤—ä–≤–µ–¥–µ—Ç–µ —Ä—ä—á–Ω–æ —Å—Ç–æ–π–Ω–æ—Å—Ç.');return}r(!0),C(null),E(null);try{const i=[];for(let o=0;o<n.length;o++){const{file:u}=n[o],m=u.name.toLowerCase().endsWith(".rtf")||u.type==="application/rtf"||u.type==="text/rtf",y=u.name.toLowerCase().endsWith(".doc")||u.name.toLowerCase().endsWith(".docx")||u.type==="application/msword"||u.type==="application/vnd.openxmlformats-officedocument.wordprocessingml.document";if(!m&&!y){f(`–§–∞–π–ª—ä—Ç "${u.name}" –Ω–µ –µ RTF –∏–ª–∏ Word —Ñ–æ—Ä–º–∞—Ç. –ú–æ–ª—è, –∏–∑–±–µ—Ä–µ—Ç–µ .rtf –∏–ª–∏ .doc/.docx —Ñ–∞–π–ª.`);continue}const b=new FileReader,F=await new Promise((I,$)=>{b.onload=v=>{var P;const j=(P=v.target)==null?void 0:P.result;I(j)},b.onerror=$,b.readAsText(u,"utf-8")}),w=Ge(F),M=Ue(w,V,t,s);i.push(...M)}if(i.length===0)f("–ù–µ –±—è—Ö–∞ –Ω–∞–º–µ—Ä–µ–Ω–∏ –¥–∞–Ω–Ω–∏ –∑–∞ –∏–∑–≤–ª–∏—á–∞–Ω–µ –æ—Ç RTF —Ñ–∞–π–ª–æ–≤–µ—Ç–µ."),E(null);else{const o=`cash_sales_rtf_${Date.now()}.csv`;E({rows:i,fileName:o})}}catch(i){console.error(i),f(i instanceof Error?i.message:"–í—ä–∑–Ω–∏–∫–Ω–∞ –≥—Ä–µ—à–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞—Ç–∞ –Ω–∞ RTF —Ñ–∞–π–ª–æ–≤–µ—Ç–µ.")}finally{r(!1)}},Me=async()=>{try{if(typeof Excel>"u"){f("Excel –æ–±–∫—Ä—ä–∂–µ–Ω–∏–µ—Ç–æ –Ω–µ –µ –Ω–∞–ª–∏—á–Ω–æ. –¢–∞–∑–∏ —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞–±–æ—Ç–∏ —Å–∞–º–æ –∫–∞—Ç–æ Excel Add-in.");return}await Excel.run(async t=>{var p;const i=t.workbook.worksheets.getActiveWorksheet().getUsedRangeOrNullObject();if(i.load(["isNullObject","values","rowCount","columnCount"]),await t.sync(),i.isNullObject||i.rowCount===0){f("–ù—è–º–∞ –¥–∞–Ω–Ω–∏ –≤ Excel —Ç–∞–±–ª–∏—Ü–∞—Ç–∞ –∑–∞ –µ–∫—Å–ø–æ—Ä—Ç–∏—Ä–∞–Ω–µ.");return}const o=i.values,m=((p=Y("4").extractionSettings)==null?void 0:p.delimiter)||";",y=[],b=o[0],w=b&&b.some(h=>typeof h=="string"&&(h.includes("–í–∏–¥")||h.includes("–î–æ–∫—É–º–µ–Ω—Ç")||h.includes("–î–∞—Ç–∞")||h.includes("–ü–∞—Ä—Ç–Ω—å–æ—Ä")))?1:0;for(let h=w;h<o.length;h++){const S=o[h].map(q=>q==null?"":String(q)).join(m);y.push(S)}if(y.length===0){f("–ù—è–º–∞ –¥–∞–Ω–Ω–∏ –∑–∞ –µ–∫—Å–ø–æ—Ä—Ç–∏—Ä–∞–Ω–µ (—Å–∞–º–æ –∑–∞–≥–ª–∞–≤–µ–Ω —Ä–µ–¥).");return}const M=y.join(`\r
`),I=`excel_export_${Date.now()}.csv`,$="\uFEFF",v=new Blob([$+M],{type:"text/csv;charset=utf-8;"}),j=document.createElement("a"),P=URL.createObjectURL(v);j.setAttribute("href",P),j.setAttribute("download",I),j.style.visibility="hidden",document.body.appendChild(j),j.click(),document.body.removeChild(j),URL.revokeObjectURL(P);const c=`–£—Å–ø–µ—Ö! –ï–∫—Å–ø–æ—Ä—Ç–∏—Ä–∞–Ω–∏ ${y.length} —Ä–µ–¥–∞ –≤ ${I}`,N=document.createElement("div");N.className="fixed top-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-50",N.textContent=c,document.body.appendChild(N),setTimeout(()=>{document.body.removeChild(N)},3e3)})}catch(t){console.error(t),f(t instanceof Error?t.message:"–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –µ–∫—Å–ø–æ—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ –æ—Ç Excel.")}},$e=async()=>{if(!(!x||!x.rows.length))try{if(typeof Excel>"u"){f("Excel –æ–±–∫—Ä—ä–∂–µ–Ω–∏–µ—Ç–æ –Ω–µ –µ –Ω–∞–ª–∏—á–Ω–æ. –¢–∞–∑–∏ —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞–±–æ—Ç–∏ —Å–∞–º–æ –∫–∞—Ç–æ Excel Add-in.");return}await Excel.run(async t=>{var j,P;const s=t.workbook.worksheets.getActiveWorksheet(),i=Y(V),o=Math.min(i.columns.length,100),u=x.rows,m=u.length;if(m===0){f("–ù—è–º–∞ –¥–∞–Ω–Ω–∏ –∑–∞ –≤–º—ä–∫–≤–∞–Ω–µ.");return}if(m>1e6){f("–¢–≤—ä—Ä–¥–µ –º–Ω–æ–≥–æ —Ä–µ–¥–æ–≤–µ –¥–∞–Ω–Ω–∏. Excel –ø–æ–¥–¥—ä—Ä–∂–∞ –º–∞–∫—Å–∏–º—É–º 1,048,576 —Ä–µ–¥–∞.");return}const y=i.columns.slice(0,o).map(c=>c.name);let b=0,F=!1;const w=s.getUsedRangeOrNullObject();if(w.load(["isNullObject","rowCount","columnCount","rowIndex"]),await t.sync(),w.isNullObject||w.rowCount===0)F=!0,b=1;else{const c=Math.max(3,Math.min(o,w.columnCount||o)),N=s.getRangeByIndexes(0,0,1,c);N.load("values"),await t.sync();const p=(((j=N.values)==null?void 0:j[0])||[]).map(L=>String(L??"").trim());F=!(p[0]===y[0]&&p[1]===y[1]&&p[2]===y[2])&&w.rowCount===0,b=w.rowIndex+w.rowCount}const M=u.map((c,N)=>{const p=[...c];for(;p.length<o;)p.push("");return p.length>o&&(p.length=o),p.map((h,L)=>{if(h==null)return"";const S=String(h);return S.length>32767?(console.warn(`Cell [${N}][${L}] truncated - too long for Excel`),S.substring(0,32767)):L===16?de(S):S})});if(F){const c=s.getRangeByIndexes(0,0,1,o);c.values=[y],c.format.font.bold=!0,c.format.fill.color="#4472C4",c.format.font.color="#FFFFFF",await t.sync(),b=1}const I=s.getRangeByIndexes(b,0,m,o);try{[3,5,6,12].forEach(N=>{if(N<=o){const p=s.getRangeByIndexes(b,N-1,m,1);p.numberFormat="@"}}),await t.sync()}catch(c){console.warn("Could not apply text formatting:",c)}try{I.values=M,await t.sync()}catch(c){throw console.error("Error setting values:",c),new Error("–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –∑–∞–ø–∏—Å–≤–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ –≤ Excel. –ú–æ–ª—è, –ø—Ä–æ–≤–µ—Ä–µ—Ç–µ —Ñ–æ—Ä–º–∞—Ç–∞ –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ.")}try{[15,16,19,20,21,26,27,33,34,35,39,40,41].forEach(N=>{if(N<=o){const p=s.getRangeByIndexes(b,N-1,m,1);p.numberFormat="0.00##########"}}),await t.sync()}catch(c){console.warn("Could not apply money formatting:",c)}try{if(7<=o){const c=s.getRangeByIndexes(b,6,m,1),N=ie.join(",");c.dataValidation.rule={list:{inCellDropDown:!0,source:N}},c.dataValidation.errorAlert={showAlert:!1,title:"–°—Ç–æ–π–Ω–æ—Å—Ç –∏–∑–≤—ä–Ω —Å–ø–∏—Å—ä–∫–∞",message:"–ú–æ–∂–µ—Ç–µ –¥–∞ –≤—ä–≤–µ–¥–µ—Ç–µ —Ä—ä—á–Ω–æ —Å—Ç–æ–π–Ω–æ—Å—Ç –∏–∑–≤—ä–Ω —Å–ø–∏—Å—ä–∫–∞.",style:"information"}}}catch(c){console.warn("Could not add column 7 validation:",c)}try{if(8<=o){const c=s.getRangeByIndexes(b,7,m,1),N=le.join(",");c.dataValidation.rule={list:{inCellDropDown:!0,source:N}},c.dataValidation.errorAlert={showAlert:!1,title:"–°—Ç–æ–π–Ω–æ—Å—Ç –∏–∑–≤—ä–Ω —Å–ø–∏—Å—ä–∫–∞",message:"–ú–æ–∂–µ—Ç–µ –¥–∞ –≤—ä–≤–µ–¥–µ—Ç–µ —Ä—ä—á–Ω–æ —Å—Ç–æ–π–Ω–æ—Å—Ç –∏–∑–≤—ä–Ω —Å–ø–∏—Å—ä–∫–∞.",style:"information"}}}catch(c){console.warn("Could not add column 8 validation:",c)}try{if(17<=o){for(let p=0;p<m;p++){const h=s.getRangeByIndexes(b+p,16,1,1),L=M[p]||[],S=(L[0]??"").toString().trim(),q=mt(L),A=gt(S,q);h.dataValidation.rule={list:{inCellDropDown:!0,source:A}}}await t.sync();const c=s.customProperties;c.load("items"),await t.sync(),((P=c.items)==null?void 0:P.some(p=>p.key==="vat_ddsvid_handler_installed"&&p.value==="1"))||(s.onChanged.add(async p=>{try{if(!p.address)return;await Excel.run(async h=>{var D,G;const S=h.workbook.worksheets.getActiveWorksheet().getRange(p.address);if(S.load(["columnIndex","values"]),await h.sync(),S.columnIndex!==16)return;const q=(G=(D=S.values)==null?void 0:D[0])==null?void 0:G[0],A=de(q);A&&A!==q&&ut.has(A)&&(S.values=[[A]],await h.sync())})}catch(h){console.warn("VAT onChanged handler error:",h)}}),c.add("vat_ddsvid_handler_installed","1"),await t.sync())}}catch(c){console.warn("Could not add column 17 validation:",c)}try{I.format.autofitColumns(),await t.sync()}catch(c){console.warn("Could not autofit columns:",c)}(V==="4"||V==="4-METRO")&&re(!0);const $=`–£—Å–ø–µ—Ö! ${m} —Ä–µ–¥–∞ —Å–∞ –¥–æ–±–∞–≤–µ–Ω–∏ –Ω–∞ —Ä–µ–¥ ${b+1}.`,v=document.createElement("div");v.className="fixed top-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-50",v.textContent=$,document.body.appendChild(v),setTimeout(()=>{document.body.removeChild(v)},3e3)})}catch(t){console.error(t),f(t instanceof Error?t.message:"–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –≤–º—ä–∫–≤–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ –≤ Excel.")}},De=(t,s,i)=>{E(o=>{if(!o)return o;const u=o.rows.map((m,y)=>y===t?[...m]:m);if(!u[t])return o;for(;u[t].length<=s;)u[t].push("");return u[t][s]=i,{...o,rows:u}})},Le=async()=>{try{const t=rt(k);if(!t.valid){f(t.errors.join(`
`));return}const s=await ct();if(s.length===0){f("–ù—è–º–∞ –Ω–∞–º–µ—Ä–µ–Ω–∏ —Ñ–∞–∫—Ç—É—Ä–∏ –∑–∞ –ø–æ–∫—É–ø–∫–∞ –≤ Excel —Ç–∞–±–ª–∏—Ü–∞—Ç–∞");return}const i=lt(s,k);await it(i),oe(!1),re(!1);const o=`–£—Å–ø–µ—Ö! ${i.length} —Ä–µ–¥–∞ —Å–∞ –¥–æ–±–∞–≤–µ–Ω–∏ –∫–∞—Ç–æ –ø—Ä–æ–¥–∞–∂–±–∏ (–æ—Ç ${s.length} –ø–æ–∫—É–ø–∫–∏).`,u=document.createElement("div");u.className="fixed top-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-50",u.textContent=o,document.body.appendChild(u),setTimeout(()=>{document.body.removeChild(u)},3e3)}catch(t){console.error(t),f(t instanceof Error?t.message:"–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ.")}};return te?e.jsx("div",{className:"max-w-xl mx-auto p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞ Gemini API"}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"–í—ä–≤–µ–¥–µ—Ç–µ Gemini API –∫–ª—é—á. –ö–ª—é—á—ä—Ç —Å–µ –∑–∞–ø–∞–∑–≤–∞ –≤ roaming settings (–≤ Excel) –∏–ª–∏ –≤ localStorage (–≤ –±—Ä–∞—É–∑—ä—Ä–∞)."}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-white font-medium mb-2",children:"Gemini API –∫–ª—é—á:"}),e.jsx("input",{type:"password",value:R,onChange:t=>W(t.target.value),className:"w-full px-3 py-2 rounded bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("button",{onClick:()=>xe(R,O),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-medium",children:"–ó–∞–ø–∞–∑–∏"}),R&&e.jsx("button",{onClick:()=>z(!1),className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg text-sm font-medium",children:"–ü—Ä–æ–¥—ä–ª–∂–∏"})]})]})}):e.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 shadow-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("div",{children:e.jsx("h2",{className:"text-2xl font-bold text-white",children:"–ò–∑–≤–ª–∏—á–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏ –æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∏"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative model-selector-container",children:[e.jsxs("button",{onClick:()=>J(!Q),className:"text-sm text-blue-400 hover:text-blue-300 flex items-center gap-1",children:["ü§ñ"," ",O==="gemini-2.0-flash"?"Gemini 2.0 Flash":O==="gemini-2.5-flash"?"Gemini 2.5 Flash":"Gemini 2.5 Pro",e.jsx("span",{className:"text-xs",children:"‚ñº"})]}),Q&&e.jsx("div",{className:"absolute right-0 top-full mt-1 bg-gray-700 border border-gray-600 rounded-lg shadow-lg z-50 min-w-[200px]",children:e.jsxs("div",{className:"p-2",children:[e.jsx("div",{className:"text-xs text-gray-300 mb-2 font-medium",children:"–ò–∑–±–µ—Ä–µ—Ç–µ –º–æ–¥–µ–ª:"}),[{value:"gemini-2.0-flash",label:"Gemini 2.0 Flash ‚Äì –±—ä—Ä–∑ –∏ –µ–≤—Ç–∏–Ω"},{value:"gemini-2.5-flash",label:"Gemini 2.5 Flash ‚Äì –ø–æ–¥–æ–±—Ä–µ–Ω–∞ —Ç–æ—á–Ω–æ—Å—Ç"},{value:"gemini-2.5-pro",label:"Gemini 2.5 Pro ‚Äì –Ω–∞–π-—Ç–æ—á–µ–Ω"}].map(t=>e.jsx("button",{onClick:()=>{const s=t.value;B(s),xe(R,s),J(!1)},className:`w-full text-left px-3 py-2 text-xs rounded hover:bg-gray-600 transition-colors ${O===t.value?"bg-blue-600 text-white":"text-gray-300"}`,children:t.label},t.value))]})})]}),e.jsx("button",{onClick:()=>z(!0),className:"text-sm text-blue-400 hover:text-blue-300",children:"‚öôÔ∏è API –Ω–∞—Å—Ç—Ä–æ–π–∫–∏"})]})]}),e.jsx("p",{className:"text-gray-400 mb-6",children:"–ö–∞—á–µ—Ç–µ –µ–¥–∏–Ω –∏–ª–∏ –ø–æ–≤–µ—á–µ PDF/–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å —Ñ–∞–∫—Ç—É—Ä–∏. –î–∞–Ω–Ω–∏—Ç–µ —â–µ –±—ä–¥–∞—Ç –ø—Ä–µ–æ–±—Ä–∞–∑—É–≤–∞–Ω–∏ –¥–æ —Ä–µ–¥–æ–≤–µ, –≥–æ—Ç–æ–≤–∏ –∑–∞ –≤–º—ä–∫–≤–∞–Ω–µ –≤ Excel."}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-white font-medium mb-2",children:["–¢–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç: ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("select",{value:V,onChange:t=>_e(t.target.value),className:"w-full px-4 py-3 bg-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:l,children:[e.jsx("option",{value:"1",children:"1 - –§–∞–∫—Ç—É—Ä–∞ –ø—Ä–æ–¥–∞–∂–±–∞"}),e.jsx("option",{value:"2",children:"2 - –î–µ–±–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø—Ä–æ–¥–∞–∂–±–∞"}),e.jsx("option",{value:"3",children:"3 - –ö—Ä–µ–¥–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø—Ä–æ–¥–∞–∂–±–∞"}),e.jsx("option",{value:"4",children:"4 - –§–∞–∫—Ç—É—Ä–∞ –ø–æ–∫—É–ø–∫–∞"}),e.jsx("option",{value:"4-METRO",children:"4 - –§–∞–∫—Ç—É—Ä–∞ –ø–æ–∫—É–ø–∫–∞ –ú–ï–¢–†–û"}),e.jsx("option",{value:"5",children:"5 - –î–µ–±–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø–æ–∫—É–ø–∫–∞"}),e.jsx("option",{value:"6",children:"6 - –ö—Ä–µ–¥–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø–æ–∫—É–ø–∫–∞"}),e.jsx("option",{value:"7",children:"7 - –ö–∞—Å–æ–≤–∏ –ø—Ä–æ–¥–∞–∂–±–∏"}),e.jsx("option",{value:"8",children:"8 - –¢—Ä–∞–Ω—Å—Ñ–µ—Ä"}),e.jsx("option",{value:"9",children:"9 - –ë—Ä–∞–∫ (–†–ê–ó–•–û–î)"}),e.jsx("option",{value:"10",children:"10 - –ë—Ä–∞–∫ (–ú–û–õ)"}),e.jsx("option",{value:"11",children:"11 - –°–∫–ª–∞–¥–æ–≤–æ –∏—Å–∫–∞–Ω–µ"}),e.jsx("option",{value:"12",children:"12 - –°—Ç–æ–∫–æ–≤–∞ —Ä–∞–∑–ø–∏—Å–∫–∞ (–°–¢)"}),e.jsx("option",{value:"13",children:"13 - –°–∫–ª–∞–¥–æ–≤–∞ —Ä–∞–∑–ø–∏—Å–∫–∞ (–°–†)"}),e.jsx("option",{value:"14",children:"14 - –î–∞–≤–∞–Ω–µ —Å—Ç–æ–∫–∏ –Ω–∞ –∫–æ–Ω—Å–∏–≥–Ω–∞—Ü–∏—è (–ö–î) —Å—ä—Å —Å—á–µ—Ç. –æ–ø–µ—Ä–∞—Ü–∏–∏"}),e.jsx("option",{value:"15",children:"15 - –î–∞–≤–∞–Ω–µ —Å—Ç–æ–∫–∏ –Ω–∞ –∫–æ–Ω—Å–∏–≥–Ω–∞—Ü–∏—è (–ö–î) –±–µ–∑ —Å—á–µ—Ç. –æ–ø–µ—Ä–∞—Ü–∏–∏"})]}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"–ò–∑–±–µ—Ä–µ—Ç–µ —Ç–∏–ø–∞ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞. –ù–æ–º–µ—Ä—ä—Ç —â–µ –±—ä–¥–µ –ø–æ—Å—Ç–∞–≤–µ–Ω –≤ –ø—ä—Ä–≤–∞—Ç–∞ –∫–æ–ª–æ–Ω–∞ –Ω–∞ –≤—Å–µ–∫–∏ —Ä–µ–¥."})]}),e.jsxs("div",{className:"mb-6 grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-white font-medium mb-1 text-sm",children:["–û–±–µ–∫—Ç–∏: ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("select",{value:K,onChange:t=>{const s=t.target.value;Ae(s),s!==U&&ge("")},className:"w-full px-3 py-2 bg-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",disabled:l,children:[ie.map(t=>e.jsx("option",{value:t,children:t},t)),e.jsx("option",{value:U,children:"–î—Ä—É–≥–æ (—Ä—ä—á–Ω–æ)‚Ä¶"})]}),K===U&&e.jsx("input",{value:se,onChange:t=>ge(t.target.value),placeholder:"–í—ä–≤–µ–¥–µ—Ç–µ —Ä—ä—á–Ω–æ –æ–±–µ–∫—Ç‚Ä¶",className:"mt-2 w-full px-3 py-2 bg-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",disabled:l}),e.jsx("p",{className:"text-gray-400 text-xs mt-1",children:"–°—Ç–æ–π–Ω–æ—Å—Ç—Ç–∞ —â–µ –±—ä–¥–µ –ø–æ—Å—Ç–∞–≤–µ–Ω–∞ –≤ –∫–æ–ª–æ–Ω–∞ 7 –Ω–∞ –≤—Å–µ–∫–∏ —Ä–µ–¥."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-white font-medium mb-1 text-sm",children:["–í–∏–¥ –Ω–∞ –∞—Ä—Ç–∏–∫—É–ª–∞: ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("select",{value:X,onChange:t=>{const s=t.target.value;Se(s),s!==U&&pe("")},className:"w-full px-3 py-2 bg-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",disabled:l,children:[le.map(t=>e.jsx("option",{value:t,children:t},t)),e.jsx("option",{value:U,children:"–î—Ä—É–≥–æ (—Ä—ä—á–Ω–æ)‚Ä¶"})]}),X===U&&e.jsx("input",{value:ne,onChange:t=>pe(t.target.value),placeholder:"–í—ä–≤–µ–¥–µ—Ç–µ —Ä—ä—á–Ω–æ –≤–∏–¥ –Ω–∞ –∞—Ä—Ç–∏–∫—É–ª–∞‚Ä¶",className:"mt-2 w-full px-3 py-2 bg-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",disabled:l}),e.jsx("p",{className:"text-gray-400 text-xs mt-1",children:"–°—Ç–æ–π–Ω–æ—Å—Ç—Ç–∞ —â–µ –±—ä–¥–µ –ø–æ—Å—Ç–∞–≤–µ–Ω–∞ –≤ –∫–æ–ª–æ–Ω–∞ 8 (–í–∏–¥) –Ω–∞ –≤—Å–µ–∫–∏ —Ä–µ–¥."})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("input",{ref:Z,type:"file",multiple:!0,accept:"image/*,.pdf,.rtf,.doc,.docx",onChange:Fe,className:"hidden"}),e.jsx("button",{onClick:()=>{var t;return(t=Z.current)==null?void 0:t.click()},disabled:l||d,className:"w-full py-3 px-4 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-colors",children:n.length>0?"–î–æ–±–∞–≤–∏ –æ—â–µ —Ñ–∞–π–ª–æ–≤–µ":"–ò–∑–±–µ—Ä–∏ —Ñ–∞–π–ª–æ–≤–µ"})]}),n.length>0&&e.jsxs("div",{className:"mb-6 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-white font-medium",children:["–ò–∑–±—Ä–∞–Ω–∏ —Ñ–∞–π–ª–æ–≤–µ (",n.length,")"]}),e.jsx("button",{onClick:fe,className:"text-red-400 hover:text-red-300 text-sm",children:"–ò–∑—á–∏—Å—Ç–∏ –≤—Å–∏—á–∫–∏"})]}),n.map((t,s)=>e.jsxs("div",{className:"p-4 bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:t.file.name}),e.jsxs("p",{className:"text-gray-400 text-sm",children:[(t.file.size/1024).toFixed(2)," KB"]})]}),e.jsx("button",{onClick:()=>Ie(s),className:"text-red-400 hover:text-red-300 text-sm",children:"–ü—Ä–µ–º–∞—Ö–Ω–∏"})]}),t.preview&&e.jsx("img",{src:t.preview,alt:"Preview",className:"max-w-full max-h-48 rounded-lg mx-auto"})]},s))]}),n.length>0&&!x&&e.jsxs(e.Fragment,{children:[V==="7"&&n.some(t=>t.file.name.toLowerCase().endsWith(".rtf")||t.file.name.toLowerCase().endsWith(".doc")||t.file.name.toLowerCase().endsWith(".docx"))?e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 mb-6",children:[e.jsx("button",{onClick:Pe,disabled:l||d,className:"py-3 px-4 bg-green-600 hover:bg-green-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-colors",children:d?"–û–±—Ä–∞–±–æ—Ç–≤–∞ RTF...":"üîß –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∏–∑–≤–ª–∏—á–∞–Ω–µ"}),e.jsx("button",{onClick:ye,disabled:l||d,className:"py-3 px-4 bg-orange-600 hover:bg-orange-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-colors",children:l?"–û–±—Ä–∞–±–æ—Ç–≤–∞ AI...":"ü§ñ AI –∏–∑–≤–ª–∏—á–∞–Ω–µ"})]}):e.jsx("button",{onClick:ye,disabled:l||d,className:"w-full py-3 px-4 bg-green-600 hover:bg-green-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-colors mb-6",children:l?"–û–±—Ä–∞–±–æ—Ç–≤–∞ —Å–µ‚Ä¶":"–ò–∑–≤–ª–µ—á–∏ –¥–∞–Ω–Ω–∏"}),V==="7"&&n.some(t=>t.file.name.toLowerCase().endsWith(".rtf")||t.file.name.toLowerCase().endsWith(".doc")||t.file.name.toLowerCase().endsWith(".docx"))&&e.jsxs("div",{className:"mb-6 p-4 bg-blue-900/30 border border-blue-500 rounded-lg",children:[e.jsxs("p",{className:"text-blue-200 text-sm",children:[e.jsx("strong",{children:"üîß –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∏–∑–≤–ª–∏—á–∞–Ω–µ:"})," –ë—ä—Ä–∑–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ RTF —Ç–∞–±–ª–∏—Ü–∏ –±–µ–∑ –∏–∑–ø–æ–ª–∑–≤–∞–Ω–µ –Ω–∞ AI –º–æ–¥–µ–ª–∏."]}),e.jsxs("p",{className:"text-blue-200 text-sm mt-1",children:[e.jsx("strong",{children:"ü§ñ AI –∏–∑–≤–ª–∏—á–∞–Ω–µ:"})," –ò–∑–ø–æ–ª–∑–≤–∞ AI –º–æ–¥–µ–ª–∏ –∑–∞ –ø–æ-—Å–ª–æ–∂–Ω–∏ —Å–ª—É—á–∞–∏, –Ω–æ –º–æ–∂–µ –¥–∞ –∏–º–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø—Ä–∏ –≥–æ–ª–µ–º–∏ —Ñ–∞–π–ª–æ–≤–µ."]})]})]}),x&&e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"p-4 bg-green-900/30 border border-green-500 rounded-lg",children:[e.jsx("p",{className:"text-green-200 font-medium",children:"‚úì –î–∞–Ω–Ω–∏—Ç–µ —Å–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏ —É—Å–ø–µ—à–Ω–æ!"}),e.jsxs("p",{className:"text-green-200 text-sm mt-1",children:["–ò–∑–≤–ª–µ—á–µ–Ω–∏ —Ä–µ–¥–æ–≤–µ: ",x.rows.length]})]}),e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-white font-medium mb-3",children:"–ü—Ä–µ–≥–ª–µ–¥ –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ (—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º–æ):"}),e.jsx("div",{className:"overflow-x-auto max-h-96 overflow-y-auto",children:e.jsxs("table",{className:"text-xs text-gray-300 w-full border-collapse",children:[e.jsx("thead",{className:"sticky top-0 bg-gray-800",children:e.jsx("tr",{children:Y(V).columns.slice(0,Math.max(...x.rows.map(t=>t.length))).map((t,s)=>e.jsx("th",{className:"border border-gray-600 px-2 py-2 text-left font-medium bg-gray-800",children:t.name},s))})}),e.jsx("tbody",{children:x.rows.map((t,s)=>e.jsxs("tr",{className:s%2===0?"bg-gray-800":"bg-gray-750",children:[t.map((i,o)=>e.jsx("td",{className:"border border-gray-600 px-1 py-1",children:e.jsx("input",{value:i??"",onChange:u=>De(s,o,u.target.value),className:"w-full bg-transparent text-gray-200 text-xs outline-none",title:i})},o)),Array.from({length:Math.max(...x.rows.map(i=>i.length))-t.length}).map((i,o)=>e.jsx("td",{className:"border border-gray-600 px-2 py-1",children:"-"},`empty-${o}`))]},s))})]})}),e.jsx("p",{className:"text-gray-400 text-xs mt-2",children:"–ú–æ–∂–µ—Ç–µ –¥–∞ –∫–æ—Ä–∏–≥–∏—Ä–∞—Ç–µ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ –¥–∏—Ä–µ–∫—Ç–Ω–æ –≤ —Ç–∞–±–ª–∏—Ü–∞—Ç–∞ –ø—Ä–µ–¥–∏ –≤–º—ä–∫–≤–∞–Ω–µ –≤ Excel."})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx("button",{onClick:$e,className:"flex-1 min-w-[150px] py-3 px-4 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:"üìã –í–º—ä–∫–Ω–∏ –≤ Excel"}),Re&&(V==="4"||V==="4-METRO")&&e.jsx("button",{onClick:()=>oe(!he),className:"flex-1 min-w-[150px] py-3 px-4 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-medium transition-colors",children:"üîÑ –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–∞–π –≤ –ø—Ä–æ–¥–∞–∂–±–∞"}),e.jsx("button",{onClick:Me,className:"flex-1 min-w-[150px] py-3 px-4 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium transition-colors",children:"üíæ –ó–∞–ø–∞–∑–∏ –∫–∞—Ç–æ CSV"}),e.jsx("button",{onClick:fe,className:"flex-1 min-w-[150px] py-3 px-4 bg-gray-700 hover:bg-gray-800 text-white rounded-lg font-medium transition-colors",children:"üîÑ –ù–æ–≤ –∞–Ω–∞–ª–∏–∑"})]}),he&&e.jsxs("div",{className:"mt-4 p-4 bg-gray-700 rounded-lg",children:[e.jsx("h3",{className:"text-white font-medium mb-3",children:"–î–∞–Ω–Ω–∏ –∑–∞ –ø—Ä–æ–¥–∞–∂–±–∞—Ç–∞:"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 mb-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-white text-sm mb-1",children:["–ù–æ–º–µ—Ä: ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",value:k.documentNumber,onChange:t=>H({...k,documentNumber:t.target.value}),className:"w-full px-3 py-2 bg-gray-600 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"–ù–æ–º–µ—Ä –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-white text-sm mb-1",children:["–ü–∞—Ä—Ç–Ω—å–æ—Ä: ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",value:k.partnerName,onChange:t=>H({...k,partnerName:t.target.value}),className:"w-full px-3 py-2 bg-gray-600 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"–ò–º–µ –Ω–∞ –ø–∞—Ä—Ç–Ω—å–æ—Ä–∞"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-white text-sm mb-1",children:"–ï–ò–ö:"}),e.jsx("input",{type:"text",value:k.partnerEIK,onChange:t=>H({...k,partnerEIK:t.target.value}),className:"w-full px-3 py-2 bg-gray-600 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"–ï–ò–ö (–æ–ø—Ü–∏–æ–Ω–∞–ª–Ω–æ)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-white text-sm mb-1",children:"–ò–ù –ø–æ –î–î–°:"}),e.jsx("input",{type:"text",value:k.partnerVAT,onChange:t=>H({...k,partnerVAT:t.target.value}),className:"w-full px-3 py-2 bg-gray-600 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"–ò–ù –ø–æ –î–î–° (–æ–ø—Ü–∏–æ–Ω–∞–ª–Ω–æ)"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-white text-sm mb-1",children:["–î–∞—Ç–∞: ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",value:k.documentDate,onChange:t=>H({...k,documentDate:t.target.value}),className:"w-full px-3 py-2 bg-gray-600 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"dd.mm.yyyy"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-white text-sm mb-1",children:["–ù–∞–¥—Ü–µ–Ω–∫–∞ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç: ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"number",value:k.profitMarkupPercent,onChange:t=>H({...k,profitMarkupPercent:parseFloat(t.target.value)||0}),className:"w-full px-3 py-2 bg-gray-600 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"40",min:"0",step:"0.1"})]})]}),e.jsx("button",{onClick:Le,className:"w-full py-3 px-4 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-medium transition-colors",children:"‚úì –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–∞–π"})]})]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-gray-800 rounded-lg",children:[e.jsx("h3",{className:"text-white font-medium mb-2",children:"–ü–æ–¥–¥—ä—Ä–∂–∞–Ω–∏ —Ñ–æ—Ä–º–∞—Ç–∏:"}),e.jsxs("ul",{className:"text-gray-400 text-sm space-y-1",children:[e.jsx("li",{children:"‚Ä¢ PDF –¥–æ–∫—É–º–µ–Ω—Ç–∏"}),e.jsx("li",{children:"‚Ä¢ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (JPG, PNG, WEBP)"}),e.jsx("li",{children:"‚Ä¢ RTF —Ñ–∞–π–ª–æ–≤–µ (–∑–∞ –∫–∞—Å–æ–≤–∏ –ø—Ä–æ–¥–∞–∂–±–∏)"}),e.jsx("li",{children:"‚Ä¢ Word –¥–æ–∫—É–º–µ–Ω—Ç–∏ (.doc, .docx)"}),e.jsx("li",{children:"‚Ä¢ –§–∞–∫—Ç—É—Ä–∏ –∑–∞ —É—Å–ª—É–≥–∏"}),e.jsx("li",{children:"‚Ä¢ –ú–Ω–æ–∂–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤–µ –Ω–∞–≤–µ–¥–Ω—ä–∂"})]})]}),Ce&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4 shadow-xl",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-red-600 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-sm font-bold",children:"!"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("h3",{className:"text-lg font-medium text-white",children:"–ì—Ä–µ—à–∫–∞"})})]}),e.jsx("div",{className:"mb-6",children:e.jsx("p",{className:"text-gray-300 text-sm",children:_})}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:ke,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:"–ó–∞—Ç–≤–æ—Ä–∏"})})]})})]})},xt=ze.createRoot(document.getElementById("root"));xt.render(e.jsx(Ke.StrictMode,{children:e.jsx("div",{className:"bg-gray-900 text-gray-200 h-full antialiased overflow-y-auto",children:e.jsx(ht,{})})}));
