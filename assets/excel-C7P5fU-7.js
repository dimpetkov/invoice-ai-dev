import{i as ee,r as w,j as e,p as Ye,c as He,G as Je,a as Xe,b as qe,R as Qe}from"./rtfParser-Dp1iI0vO.js";function Ze(s){const r=[];(!s.documentNumber||s.documentNumber.trim()==="")&&r.push("–ü–æ–ª–µ—Ç–æ –ù–æ–º–µ—Ä –µ –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–æ"),(!s.partnerName||s.partnerName.trim()==="")&&r.push("–ü–æ–ª–µ—Ç–æ –ü–∞—Ä—Ç–Ω—å–æ—Ä –µ –∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–Ω–æ");const a=/^\d{2}\.\d{2}\.\d{4}$/;if(!s.documentDate||!a.test(s.documentDate))r.push("–ù–µ–≤–∞–ª–∏–¥–µ–Ω —Ñ–æ—Ä–º–∞—Ç –Ω–∞ –¥–∞—Ç–∞. –ò–∑–ø–æ–ª–∑–≤–∞–π—Ç–µ dd.mm.yyyy");else{const[x,u,c]=s.documentDate.split(".").map(Number),p=new Date(c,u-1,x);(p.getDate()!==x||p.getMonth()!==u-1||p.getFullYear()!==c)&&r.push("–ù–µ–≤–∞–ª–∏–¥–Ω–∞ –¥–∞—Ç–∞")}return(typeof s.profitMarkupPercent!="number"||s.profitMarkupPercent<0)&&r.push("–ù–∞–¥—Ü–µ–Ω–∫–∞—Ç–∞ —Ç—Ä—è–±–≤–∞ –¥–∞ –±—ä–¥–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª–Ω–æ —á–∏—Å–ª–æ"),{valid:r.length===0,errors:r}}function je(s,r){const a=parseFloat(s);if(isNaN(a))return s;const x=a*(1+r/100);return(Math.round(x*100)/100).toFixed(2)}function et(s){let r=0;for(const u of s)if(u.length>15&&u[15]){const c=parseFloat(u[15]);isNaN(c)||(r+=c)}const a=0,x=r;return{totalValue:Math.round(r*100)/100,vatAmount:Math.round(a*100)/100,totalWithVAT:Math.round(x*100)/100}}function tt(s,r){const a=s.map(u=>[...u]);for(let u=0;u<a.length;u++){const c=a[u];for(;c.length<44;)c.push("");c[0]="1",c[1]=r.documentDate,c[2]=r.documentNumber,c[3]=r.partnerName,c[4]=r.partnerEIK||"",c[5]=r.partnerVAT||"",c[14]&&(c[14]=je(c[14],r.profitMarkupPercent)),c[15]&&(c[15]=je(c[15],r.profitMarkupPercent)),c[16]="–î–î–°0",c[17]="2"}const x=et(a);if(a.length>0){a[0][18]=x.totalWithVAT.toFixed(2),a[0][19]="0",a[0][20]=x.totalWithVAT.toFixed(2);for(let u=1;u<a.length;u++)a[u][18]="",a[u][19]="",a[u][20]=""}return a}async function st(s,r){try{return typeof Excel>"u"?(console.error("Excel environment not available"),[]):await Excel.run(async a=>{const x=a.workbook.worksheets.getActiveWorksheet(),u=44,c=s-1,p=x.getRangeByIndexes(c,0,r,u);p.load("values"),await a.sync();const C=p.values,B=[];for(let N=0;N<C.length;N++){const _=C[N],z=[];for(let I=0;I<_.length;I++){const U=_[I],te=U==null?"":String(U);z.push(te)}B.push(z)}return B})}catch(a){return console.error("Error reading purchase data from Excel:",a),[]}}async function nt(s){try{if(typeof Excel>"u")throw new Error("Excel environment not available");if(s.length===0)throw new Error("No sales data to append");await Excel.run(async r=>{const a=r.workbook.worksheets.getActiveWorksheet(),x=a.getUsedRange();x.load(["rowIndex","rowCount"]),await r.sync();const u=x.rowIndex+x.rowCount,c=Math.max(...s.map(B=>B.length)),p=s.map(B=>{const N=[...B];for(;N.length<c;)N.push("");return N}),C=a.getRangeByIndexes(u,0,s.length,c);C.values=p,await r.sync()})}catch(r){throw console.error("Error appending sales data to Excel:",r),new Error("–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤—è–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏ –≤ Excel")}}const J=s=>s==="7"?Xe:ee;var Ee;const le=((Ee=ee.columns.find(s=>s.columnNumber===8))==null?void 0:Ee.allowedValues)||["–°—Ç–æ–∫–∏","–ú–∞—Ç–µ—Ä–∏–∞–ª–∏","–ü—Ä–æ–¥—É–∫—Ü–∏—è","–£—Å–ª—É–≥–∏","–†–∞–∑—Ö–æ–¥–∏ –∑–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–∏","–ê–≤–∞–Ω—Å","–ü—Ä–∏—Å–ø–∞–¥–∞–Ω–µ –Ω–∞ –∞–≤–∞–Ω—Å","–î—ä–ª–≥–æ—Ç—Ä–∞–π–Ω–∏ –∞–∫—Ç–∏–≤–∏"];var Se;const ie=((Se=ee.columns.find(s=>s.columnNumber===7))==null?void 0:Se.allowedValues)||["–°–¢–û–ö–ò","–ú–ê–¢–ï–†–ò–ê–õ–ò","–ü–†–û–î–£–ö–¶–ò–Ø"],G="__MANUAL__",Ne=(s,r)=>s===G?r.trim():(s||"").trim(),Ce=(s,r)=>s===G?r.trim():(s||"").trim(),ue=[{code:"–ù–ï–†–ï–ì",desc:"–ù–µ—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–∞–Ω–æ –ª–∏—Ü–µ –ø–æ –î–î–°",group:"NO_VAT"},{code:"–î–î–°20",desc:"–û–±–ª. (20%)",group:"VAT_20"},{code:"–î–î–°9",desc:"–û–±–ª. (9%)",group:"VAT_9"},{code:"–î–î–°0",desc:"–û–î (0%)",group:"VAT_0"},{code:"–ë–î–ö",desc:"–ë–µ–∑ –ø—Ä–∞–≤–æ –Ω–∞ –î–ö",group:"NO_VAT"},{code:"–í–û–î",desc:"–í–û–î",group:"VAT_0"},{code:"–û–°–í",desc:"–û–î –∏ –û—Å–≤. –í–û–ü",group:"VAT_0"},{code:"–î–î–°20/9",desc:"–ö–æ–º–±–∏–Ω–∏—Ä–∞–Ω–∞ —Å–¥–µ–ª–∫–∞ 20%/9%/0%",group:"MIXED"},{code:"–î140",desc:"–î-–∫–∏ –ø–æ —á–ª. 140, 146, —á–ª. 173 –ó–î–î–°",group:"VAT_0"},{code:"–î21",desc:"–î-–∫–∏ –Ω–∞ —É-–≥–∏ –ø–æ —á–ª. 21(2) –ó–î–î–° (–ï–°)",group:"VAT_0"},{code:"–î69",desc:"–î-–∫–∏ –ø–æ —á–ª. 69(2) –∏ –¥–∏—Å—Ç. –ø—Ä–æ–¥-–±–∏ (–ï–°)",group:"VAT_0"},{code:"–î–ü–¢–û",desc:"–î-–∫–∏ –∫–∞—Ç–æ –ø–æ—Å—Ä–µ–¥–Ω–∏–∫ –≤ —Ç—Ä–∏—Å—Ç—Ä. –æ–ø–µ—Ä–∞—Ü–∏–∏",group:"VAT_0"},{code:"–ù20",desc:"–ù–∞—á–∏—Å–ª–µ–Ω –¥–∞–Ω—ä–∫ (20%) –≤ –¥—Ä. —Å–ª—É—á–∞–∏",group:"VAT_20"},{code:"–î143",desc:"–î-–∫–∏ –ø–æ —á–ª. 143 (1) –ó–î–î–°",group:"VAT_0"},{code:"–ù1139",desc:"–ù–µ–Ω–∞—á. –Ω–∞ –î–î–°, —Å—ä–≥–ª. —á–ª. 113 (9)",group:"NO_VAT"},{code:"–ü–¢–†",desc:"–ü—Ä–∏–¥–æ–±–∏–≤–∞–Ω–µ –∫–∞—Ç–æ –ø–æ—Å—Ä–µ–¥–Ω–∏–∫ –≤ —Ç—Ä–∏—Å—Ç—Ä–∞–Ω–Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏—è",group:"VAT_0"},{code:"–ü–†–ò–õ21",desc:"–ü—Ä–∏–ª. 2-–Ü/–î–æ—Å—Ç. –ø–æ –ø—Ä–∏–ª. 2 —á–∞—Å—Ç I",group:"NO_VAT"},{code:"–ü–†–ò–õ22",desc:"–ü—Ä–∏–ª. 2-II/–î–æ—Å—Ç. –ø–æ –ø—Ä–∏–ª. 2 —á–∞—Å—Ç II",group:"NO_VAT"},{code:"–ß–î–ö",desc:"–° –ø—Ä–∞–≤–æ –Ω–∞ —á–∞—Å—Ç–∏—á–µ–Ω –î–ö",group:"NO_VAT"}],ot=new Set(ue.map(s=>s.code)),de=s=>{const r=(s??"").toString().trim();return r?r.split("-")[0].trim():""},ce=s=>{if(s==null)return NaN;const r=String(s).trim().replace(",",".");if(!r)return NaN;const a=Number(r);return Number.isFinite(a)?a:NaN},Ae=s=>["1","2","3","7"].includes(s),Te=s=>["4","5","6"].includes(s),rt=s=>{const r=((s==null?void 0:s[0])??"").toString().trim(),a=((s==null?void 0:s[16])??"").toString().trim(),x=ce(s==null?void 0:s[19]),u=ce(s==null?void 0:s[25]),c=ce(s==null?void 0:s[26]),p=de(a),C=ue.find(N=>N.code===p);if(C)return C.group;if(Number.isFinite(x)&&x>0){const N=Number.isFinite(u)&&u>0,_=Number.isFinite(c)&&c>0;return N&&_?"MIXED":_?"VAT_9":"VAT_20"}return Number.isFinite(u)&&u>0||Number.isFinite(c)&&c>0?"ALL":Ae(r)?"VAT_0":(Te(r),"ALL")},at=(s,r)=>{const a=new Set(["–î140","–î21","–î69","–î–ü–¢–û","–ù20","–î143","–ù1139"]),x=new Set(["–ü–¢–†","–ü–†–ò–õ21","–ü–†–ò–õ22","–ß–î–ö"]),u=Ae(s),c=Te(s);return ue.filter(p=>(r==="ALL"?!0:p.group===r)?a.has(p.code)?u:x.has(p.code)?c:!0:!1)},lt=(s,r)=>at(s,r).map(x=>x.code).join(","),it=()=>{const[s,r]=w.useState([]),[a,x]=w.useState(!1),[u,c]=w.useState(!1),[p,C]=w.useState(null),[B,N]=w.useState(null),[_,z]=w.useState(""),[I,U]=w.useState("gemini-2.0-flash"),[te,K]=w.useState(!1),[X,q]=w.useState(!1),[ke,me]=w.useState(!1),[O,Re]=w.useState("4"),[Q,_e]=w.useState(le[0]||"–°—Ç–æ–∫–∏"),[Y,Fe]=w.useState(ie[0]||"–ú–ê–¢–ï–†–ò–ê–õ–ò"),[se,ge]=w.useState(""),[ne,he]=w.useState(""),[Ve,oe]=w.useState(!1),[Ie,xe]=w.useState(0),[Oe,pe]=w.useState(0),[fe,re]=w.useState(!1),[R,H]=w.useState({documentNumber:"",partnerName:"",partnerEIK:"",partnerVAT:"",documentDate:(()=>{const t=new Date,n=String(t.getDate()).padStart(2,"0"),l=String(t.getMonth()+1).padStart(2,"0"),o=t.getFullYear();return`${n}.${l}.${o}`})(),profitMarkupPercent:40}),Z=w.useRef(null);w.useEffect(()=>{if(typeof Office<"u")Office.onReady(()=>{$e()});else{const t=localStorage.getItem("gemini_api_key"),n=localStorage.getItem("gemini_model");t&&z(t),n&&U(n),t||K(!0)}},[]),w.useEffect(()=>{const t=n=>{X&&(n.target.closest(".model-selector-container")||q(!1))};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[X]);const $e=()=>{try{if(typeof Office<"u"&&Office.context&&Office.context.roamingSettings){const t=Office.context.roamingSettings.get("gemini_api_key"),n=Office.context.roamingSettings.get("gemini_model");t&&z(t),n&&U(n),t||K(!0)}else{const t=localStorage.getItem("gemini_api_key"),n=localStorage.getItem("gemini_model");t&&z(t),n&&U(n),t||K(!0)}}catch(t){console.error("Error loading API keys:",t),K(!0)}},f=t=>{N(t),me(!0)},Me=()=>{N(null),me(!1)},ye=(t,n)=>{try{typeof Office<"u"&&Office.context&&Office.context.roamingSettings?(t&&Office.context.roamingSettings.set("gemini_api_key",t),Office.context.roamingSettings.set("gemini_model",n),Office.context.roamingSettings.saveAsync()):(t&&localStorage.setItem("gemini_api_key",t),localStorage.setItem("gemini_model",n)),t&&z(t),U(n),K(!1),N(null)}catch(l){console.error("Error saving API keys:",l),f("–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –∑–∞–ø–∞–∑–≤–∞–Ω–µ –Ω–∞ API –∫–ª—é—á–∞. –û–ø–∏—Ç–∞–π—Ç–µ –æ—Ç–Ω–æ–≤–æ.")}},Le=t=>{const n=t.target.files;if(!n||n.length===0)return;const l=[];for(let o=0;o<n.length;o++){const d=n[o];let m=null;if(d.type.startsWith("image/")){const v=new FileReader;v.onload=y=>{var T;m=(T=y.target)==null?void 0:T.result,r(E=>[...E,{file:d,preview:m}])},v.readAsDataURL(d)}else l.push({file:d,preview:m})}l.length>0&&r(o=>[...o,...l]),C(null),N(null)},Pe=t=>{r(n=>n.filter((l,o)=>o!==t))},be=()=>{r([]),C(null),N(null),oe(!1),re(!1),xe(0),pe(0),Z.current&&(Z.current.value="")},De=(t,n,l)=>{var $,F;const o=J(t),d=(($=o.extractionSettings)==null?void 0:$.delimiter)||";",m=((F=o.extractionSettings)==null?void 0:F.minimumColumns)||44,v=o.columns.slice(0,m).map((V,j)=>`${j+1}. ${V.name} - ${V.description}`).join(`
`),T={1:"–§–∞–∫—Ç—É—Ä–∞ –ø—Ä–æ–¥–∞–∂–±–∞",2:"–î–µ–±–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø—Ä–æ–¥–∞–∂–±–∞",3:"–ö—Ä–µ–¥–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø—Ä–æ–¥–∞–∂–±–∞",4:"–§–∞–∫—Ç—É—Ä–∞ –ø–æ–∫—É–ø–∫–∞",5:"–î–µ–±–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø–æ–∫—É–ø–∫–∞",6:"–ö—Ä–µ–¥–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø–æ–∫—É–ø–∫–∞",7:"–ö–∞—Å–æ–≤–∏ –ø—Ä–æ–¥–∞–∂–±–∏",8:"–¢—Ä–∞–Ω—Å—Ñ–µ—Ä",9:"–ë—Ä–∞–∫ (–†–ê–ó–•–û–î)",10:"–ë—Ä–∞–∫ (–ú–û–õ)",11:"–°–∫–ª–∞–¥–æ–≤–æ –∏—Å–∫–∞–Ω–µ",12:"–°—Ç–æ–∫–æ–≤–∞ —Ä–∞–∑–ø–∏—Å–∫–∞ (–°–¢)",13:"–°–∫–ª–∞–¥–æ–≤–∞ —Ä–∞–∑–ø–∏—Å–∫–∞ (–°–†)",14:"–î–∞–≤–∞–Ω–µ —Å—Ç–æ–∫–∏ –Ω–∞ –∫–æ–Ω—Å–∏–≥–Ω–∞—Ü–∏—è (–ö–î) —Å—ä—Å —Å—á–µ—Ç. –æ–ø–µ—Ä–∞—Ü–∏–∏",15:"–î–∞–≤–∞–Ω–µ —Å—Ç–æ–∫–∏ –Ω–∞ –∫–æ–Ω—Å–∏–≥–Ω–∞—Ü–∏—è (–ö–î) –±–µ–∑ —Å—á–µ—Ç. –æ–ø–µ—Ä–∞—Ü–∏–∏"}[t]||"",E=`
–õ–û–ì–ò–ö–ê –ó–ê –û–ü–†–ï–î–ï–õ–Ø–ù–ï –ù–ê –ü–ê–†–¢–ù–¨–û–†–ê –°–ü–û–†–ï–î –í–ò–î. –î–û–ö–£–ú–ï–ù–¢ (${t}${T?` ‚Äì ${T}`:""}):

- –ê–∫–æ –í–∏–¥. –î–æ–∫—É–º–µ–Ω—Ç –µ 1, 2, 3 –∏–ª–∏ 7 (—Ñ–∞–∫—Ç—É—Ä–∞/–∏–∑–≤–µ—Å—Ç–∏–µ –ø—Ä–æ–¥–∞–∂–±–∞, –∫–∞—Å–æ–≤–∏ –ø—Ä–æ–¥–∞–∂–±–∏):
  ‚Ä¢ –ù–∞—à–∞—Ç–∞ —Ñ–∏—Ä–º–∞ –µ –ò–ó–î–ê–¢–ï–õ/–î–û–°–¢–ê–í–ß–ò–ö.
  ‚Ä¢ –ü–∞—Ä—Ç–Ω—å–æ—Ä (–∫–æ–ª–æ–Ω–∏ 4‚Äì6) –µ –ü–û–õ–£–ß–ê–¢–ï–õ/–ö–£–ü–£–í–ê–ß (–∫–ª–∏–µ–Ω—Ç—ä—Ç).

- –ê–∫–æ –í–∏–¥. –î–æ–∫—É–º–µ–Ω—Ç –µ 4, 5 –∏–ª–∏ 6 (—Ñ–∞–∫—Ç—É—Ä–∞/–∏–∑–≤–µ—Å—Ç–∏–µ –ø–æ–∫—É–ø–∫–∞):
  ‚Ä¢ –ù–∞—à–∞—Ç–∞ —Ñ–∏—Ä–º–∞ –µ –ü–û–õ–£–ß–ê–¢–ï–õ/–ö–£–ü–£–í–ê–ß.
  ‚Ä¢ –ü–∞—Ä—Ç–Ω—å–æ—Ä (–∫–æ–ª–æ–Ω–∏ 4‚Äì6) –µ –ò–ó–î–ê–¢–ï–õ/–î–û–°–¢–ê–í–ß–ò–ö (–¥–æ—Å—Ç–∞–≤—á–∏–∫—ä—Ç).

- –ê–∫–æ –í–∏–¥. –î–æ–∫—É–º–µ–Ω—Ç –µ –æ—Ç 8 –¥–æ 15:
  ‚Ä¢ –ê–∫–æ –¥–æ–∫—É–º–µ–Ω—Ç—ä—Ç —Å—ä–¥—ä—Ä–∂–∞ –≤—ä–Ω—à–µ–Ω –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç (–¥—Ä—É–≥–∞ —Ñ–∏—Ä–º–∞ –∏–∑–≤—ä–Ω –Ω–∞—à–∞—Ç–∞) ‚Äì –∏–∑–ø–æ–ª–∑–≤–∞–π –Ω–µ–≥–æ –∫–∞—Ç–æ –ü–∞—Ä—Ç–Ω—å–æ—Ä (–∫–æ–ª–æ–Ω–∏ 4‚Äì6).
  ‚Ä¢ –ê–∫–æ –¥–æ–∫—É–º–µ–Ω—Ç—ä—Ç –µ —á–∏—Å—Ç–æ –≤—ä—Ç—Ä–µ—à–µ–Ω (–º–µ–∂–¥—É –Ω–∞—à–∏ —Å–∫–ª–∞–¥–æ–≤–µ/–æ–±–µ–∫—Ç–∏) ‚Äì –æ—Å—Ç–∞–≤–∏ –∫–æ–ª–æ–Ω–∏ 4‚Äì6 –ø—Ä–∞–∑–Ω–∏.

–ö–æ–ª–æ–Ω–∞ 4 ‚Äû–ü–∞—Ä—Ç–Ω—å–æ—Ä‚Äú –∏ –∫–æ–ª–æ–Ω–∞ 5 ‚Äû–ï–ò–ö‚Äú –í–ò–ù–ê–ì–ò –æ–ø–∏—Å–≤–∞—Ç –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞ (–¥—Ä—É–≥–∞—Ç–∞ —Å—Ç—Ä–∞–Ω–∞ –ø–æ —Å–¥–µ–ª–∫–∞—Ç–∞), –∞ –Ω–µ –Ω–∞—à–∞—Ç–∞ —Ñ–∏—Ä–º–∞.
`.trim();return`–¢–∏ —Å–∏ –µ–∫—Å–ø–µ—Ä—Ç –ø–æ –∏–∑–≤–ª–∏—á–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏ –æ—Ç —Ñ–∞–∫—Ç—É—Ä–∏ –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –Ω–∞ CSV —Ñ–∞–π–ª–æ–≤–µ –∑–∞ –±—ä–ª–≥–∞—Ä—Å–∫–∞ —Å—á–µ—Ç–æ–≤–æ–¥–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –ü–ª—é—Å –ú–∏–Ω—É—Å.

–í–ê–ñ–ù–ê –ò–ù–§–û–†–ú–ê–¶–ò–Ø:
- –¢–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç (–∏–∑–±—Ä–∞–Ω –æ—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è): ${t}${T?` ‚Äì ${T}`:""}
- –¢–æ–∑–∏ –Ω–æ–º–µ—Ä –¢–†–Ø–ë–í–ê –¥–∞ –±—ä–¥–µ –ø–æ—Å—Ç–∞–≤–µ–Ω –≤ –ö–û–õ–û–ù–ê 1 (–ø—ä—Ä–≤–∞—Ç–∞ –∫–æ–ª–æ–Ω–∞) –Ω–∞ –í–°–ï–ö–ò —Ä–µ–¥ –æ—Ç –∏–∑–≤–ª–µ—á–µ–Ω–∏—Ç–µ –¥–∞–Ω–Ω–∏.
- –í–∏–¥ –Ω–∞ –∞—Ä—Ç–∏–∫—É–ª–∞ (–∏–∑–±—Ä–∞–Ω –æ—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è): ${n}
- –¢–∞–∑–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç –¢–†–Ø–ë–í–ê –¥–∞ –±—ä–¥–µ –ø–æ—Å—Ç–∞–≤–µ–Ω–∞ –≤ –ö–û–õ–û–ù–ê 8 (–í–∏–¥) –Ω–∞ –í–°–ï–ö–ò —Ä–µ–¥ –æ—Ç –∏–∑–≤–ª–µ—á–µ–Ω–∏—Ç–µ –¥–∞–Ω–Ω–∏.
- –û–±–µ–∫—Ç–∏ (–∏–∑–±—Ä–∞–Ω –æ—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è): ${l}
- –¢–∞–∑–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç –¢–†–Ø–ë–í–ê –¥–∞ –±—ä–¥–µ –ø–æ—Å—Ç–∞–≤–µ–Ω–∞ –≤ –ö–û–õ–û–ù–ê 7 –Ω–∞ –í–°–ï–ö–ò —Ä–µ–¥ –æ—Ç –∏–∑–≤–ª–µ—á–µ–Ω–∏—Ç–µ –¥–∞–Ω–Ω–∏.

${E}

–í –ï–î–ò–ù PDF –ú–û–ñ–ï –î–ê –ò–ú–ê –ù–Ø–ö–û–õ–ö–û –î–û–ö–£–ú–ï–ù–¢–ê:
- –û–±—Ä–∞–±–æ—Ç–≤–∞–π –≤—Å–µ–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç –ø–æ–æ—Ç–¥–µ–ª–Ω–æ.
- –ó–∞ –≤—Å–µ–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç —Å—ä–∑–¥–∞–≤–∞–π –æ—Ç–¥–µ–ª–Ω–∏ —Ä–µ–¥–æ–≤–µ –≤ CSV.

–ï–î–ò–ù CSV –†–ï–î = –ï–î–ù–ê –ü–û–ó–ò–¶–ò–Ø –û–¢ –î–û–ö–£–ú–ï–ù–¢–ê:
- –ó–∞ –í–°–Ø–ö–ê –ü–û–ó–ò–¶–ò–Ø (–∞—Ä—Ç–∏–∫—É–ª, —Ä–µ–¥ –æ—Ç —Ñ–∞–∫—Ç—É—Ä–∞—Ç–∞) —Å—ä–∑–¥–∞–π –æ—Ç–¥–µ–ª–µ–Ω —Ä–µ–¥.
- –ù–∞—á–∞–ª–Ω–∏—Ç–µ –ø–æ–ª–µ—Ç–∞ (–∫–æ–ª–æ–Ω–∏ 1‚Äì${m}) —Å–∞ –µ–¥–Ω–∞–∫–≤–∏ –∑–∞ –≤—Å–∏—á–∫–∏ —Ä–µ–¥–æ–≤–µ –æ—Ç –µ–¥–∏–Ω –¥–æ–∫—É–º–µ–Ω—Ç.
- –ü–æ–ª–µ—Ç–∞—Ç–∞ –∑–∞ –æ–±—â–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ (–û–±—â–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç, –î–î–°, –ü–ª–∞—Ç–µ–Ω–æ –∏ —Ç.–Ω.) —Å–µ –ø–æ–ø—ä–ª–≤–∞—Ç –°–ê–ú–û –Ω–∞ –ü–™–†–í–ò–Ø —Ä–µ–¥ –∑–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞.

CSV –§–û–†–ú–ê–¢:
- –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª –Ω–∞ –∫–æ–ª–æ–Ω–∏: "${d}"
- –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª –Ω–∞ —Ä–µ–¥–æ–≤–µ: CRLF (\\r\\n)
- –ë–ï–ó –∑–∞–≥–ª–∞–≤–µ–Ω —Ä–µ–¥.
- –í—Å–µ–∫–∏ —Ä–µ–¥ = –ï–î–ù–ê –ø–æ–∑–∏—Ü–∏—è (–∞—Ä—Ç–∏–∫—É–ª) –æ—Ç –¥–∞–¥–µ–Ω –¥–æ–∫—É–º–µ–Ω—Ç.

–ö–û–õ–û–ù–ò (–ú–ò–ù–ò–ú–£–ú ${m} –∫–æ–ª–æ–Ω–∏):
${v}

–í–ê–ñ–ù–ò –ü–†–ê–í–ò–õ–ê:
1. –ö–û–õ–û–ù–ê 1 –í–ò–ù–ê–ì–ò —Å—ä–¥—ä—Ä–∂–∞ –Ω–æ–º–µ—Ä–∞ –Ω–∞ —Ç–∏–ø–∞ –¥–æ–∫—É–º–µ–Ω—Ç: ${t}
2. –ö–û–õ–û–ù–ê 7 –í–ò–ù–ê–ì–ò —Å—ä–¥—ä—Ä–∂–∞ –æ–±–µ–∫—Ç–∞: ${l}
3. –ö–û–õ–û–ù–ê 8 –í–ò–ù–ê–ì–ò —Å—ä–¥—ä—Ä–∂–∞ –≤–∏–¥–∞ –Ω–∞ –∞—Ä—Ç–∏–∫—É–ª–∞: ${n}
4. –í–ò–ù–ê–ì–ò –∏–∑–≤–µ–∂–¥–∞–π –ú–ò–ù–ò–ú–£–ú ${m} –∫–æ–ª–æ–Ω–∏ (1‚Äì${m}).
3. –ê–∫–æ –∏–º–∞—à –Ω–∞–¥–µ–∂–¥–Ω–∏ –¥–∞–Ω–Ω–∏ –∑–∞ –∫–æ–ª–æ–Ω–∏ —Å–ª–µ–¥ ${m}, –¥–æ–±–∞–≤–∏ –≥–∏ (–¥–æ –º–∞–∫—Å–∏–º—É–º ${ee.columns.length} –∫–æ–ª–æ–Ω–∏).
4. –ê–∫–æ –∫–æ–ª–æ–Ω–∞ –Ω—è–º–∞ –¥–∞–Ω–Ω–∏, –æ—Å—Ç–∞–≤–∏ —è –ø—Ä–∞–∑–Ω–∞ (–¥–≤–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–Ω–∏ "${d}").
5. –ö–æ–ª–æ–Ω–∞ 4 ‚Äû–ü–∞—Ä—Ç–Ω—å–æ—Ä‚Äú –∏ –∫–æ–ª–æ–Ω–∞ 5 ‚Äû–ï–ò–ö‚Äú –æ–ø–∏—Å–≤–∞—Ç –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞ (–¥—Ä—É–≥–∞—Ç–∞ —Å—Ç—Ä–∞–Ω–∞ –ø–æ —Å–¥–µ–ª–∫–∞—Ç–∞).

6. –î–∞—Ç–∏—Ç–µ —Å–∞ –≤—ä–≤ —Ñ–æ—Ä–º–∞—Ç dd.mm.yyyy.
7. –ß–∏—Å–ª–∞—Ç–∞ —Å–∞ –±–µ–∑ –≤–∞–ª—É—Ç–Ω–∏ —Å–∏–º–≤–æ–ª–∏.
8. –ù–µ –∏–∑–ø–æ–ª–∑–≤–∞–π —Å–∏–º–≤–æ–ª–∏ " ' / \\ & –≤ —Ç–µ–∫—Å—Ç–æ–≤–∏ –ø–æ–ª–µ—Ç–∞.

–î–û–ü–™–õ–ù–ò–¢–ï–õ–ù–ò –ò–ù–°–¢–†–£–ö–¶–ò–ò:
${o.extractionInstructions?o.extractionInstructions.map((V,j)=>`${j+1}. ${V}`).join(`
`):"–ù—è–º–∞ –¥–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∑–∞ —Ç–æ–∑–∏ —Ç–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç."}

–ò–ó–•–û–î:
–í—ä—Ä–Ω–∏ –°–ê–ú–û CSV –¥–∞–Ω–Ω–∏—Ç–µ, –±–µ–∑ –¥–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–µ–Ω —Ç–µ–∫—Å—Ç, –æ–±—è—Å–Ω–µ–Ω–∏—è –∏–ª–∏ markdown.
–ó–∞–ø–æ—á–Ω–∏ –¥–∏—Ä–µ–∫—Ç–Ω–æ —Å —Ä–µ–¥/—Ä–µ–¥–æ–≤–µ —Å –¥–∞–Ω–Ω–∏ (–ë–ï–ó –∑–∞–≥–ª–∞–≤–∏—è).
–í—Å–µ–∫–∏ —Ä–µ–¥ –¢–†–Ø–ë–í–ê –¥–∞ –∏–º–∞ –ú–ò–ù–ò–ú–£–ú ${m} —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ (–∫–æ–ª–æ–Ω–∏), —Ä–∞–∑–¥–µ–ª–µ–Ω–∏ —Å "${d}".
–ö–û–õ–û–ù–ê 1 –Ω–∞ –≤—Å–µ–∫–∏ —Ä–µ–¥ –¢–†–Ø–ë–í–ê –¥–∞ —Å—ä–¥—ä—Ä–∂–∞: ${t}
–ö–û–õ–û–ù–ê 7 –Ω–∞ –≤—Å–µ–∫–∏ —Ä–µ–¥ –¢–†–Ø–ë–í–ê –¥–∞ —Å—ä–¥—ä—Ä–∂–∞: ${l}
–ö–û–õ–û–ù–ê 8 –Ω–∞ –≤—Å–µ–∫–∏ —Ä–µ–¥ –¢–†–Ø–ë–í–ê –¥–∞ —Å—ä–¥—ä—Ä–∂–∞: ${n}`},we=async()=>{var m,v,y,T,E,$,F,V;if(s.length===0)return;if(!O){f("–ú–æ–ª—è, –∏–∑–±–µ—Ä–µ—Ç–µ —Ç–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç.");return}if(!_){f("–ú–æ–ª—è, –≤—ä–≤–µ–¥–µ—Ç–µ Gemini API –∫–ª—é—á."),K(!0);return}const t=Ne(Q,se),n=Ce(Y,ne);if(!t){f('–ú–æ–ª—è, –∏–∑–±–µ—Ä–µ—Ç–µ "–í–∏–¥ –Ω–∞ –∞—Ä—Ç–∏–∫—É–ª–∞" –∏–ª–∏ –≤—ä–≤–µ–¥–µ—Ç–µ —Ä—ä—á–Ω–æ —Å—Ç–æ–π–Ω–æ—Å—Ç.');return}if(Y!==G&&!n){f('–ú–æ–ª—è, –∏–∑–±–µ—Ä–µ—Ç–µ "–û–±–µ–∫—Ç–∏" –∏–ª–∏ –≤—ä–≤–µ–¥–µ—Ç–µ —Ä—ä—á–Ω–æ —Å—Ç–æ–π–Ω–æ—Å—Ç.');return}x(!0),N(null),C(null),q(!1);const l=J(O),o=(m=l.extractionSettings)==null?void 0:m.delimiter,d=(v=l.extractionSettings)==null?void 0:v.minimumColumns;try{const j=[];for(let k=0;k<s.length;k++){const{file:M}=s[k],i=new FileReader,b=await new Promise((A,L)=>{i.onload=W=>{var ve;const ae=((ve=W.target)==null?void 0:ve.result).split(",")[1];A(ae)},i.onerror=L,i.readAsDataURL(M)}),g=De(O,t,n);let h="";if(I==="gemini-2.5-flash"||I==="gemini-2.5-pro"){const A=`https://generativelanguage.googleapis.com/v1/models/${I}:generateContent?key=${_}`,L={contents:[{parts:[{text:g},{inline_data:{mime_type:M.type,data:b}}]}]},W=await fetch(A,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(L)});if(!W.ok){const ae=await W.json();throw new Error(`Gemini API error: ${((y=ae.error)==null?void 0:y.message)||W.statusText}`)}h=((V=(F=($=(E=(T=(await W.json()).candidates)==null?void 0:T[0])==null?void 0:E.content)==null?void 0:$.parts)==null?void 0:F[0])==null?void 0:V.text)||""}else h=((await new Je({apiKey:_}).chats.create({model:I}).sendMessage({message:[{text:g},{inlineData:{mimeType:M.type,data:b}}]})).text||"").trim();let S=h.trim();S.startsWith("```")&&(S=S.replace(/```csv\n?/gi,"").replace(/```\n?/g,"").trim());const D=S.split(/\r?\n/).map(A=>A.trim()).filter(A=>A.length>0);for(const A of D){const L=A.split(o);for(;L.length<d;)L.push("");j.push(L)}}if(j.length===0)f("–ù–µ –±—è—Ö–∞ –Ω–∞–º–µ—Ä–µ–Ω–∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏ –¥–∞–Ω–Ω–∏ –æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ç–µ –∏–ª–∏ —Ä–µ–∑—É–ª—Ç–∞—Ç—ä—Ç –µ –ø—Ä–∞–∑–µ–Ω."),C(null);else{const k=`invoices_${Date.now()}.csv`;C({rows:j,fileName:k})}}catch(j){console.error(j),f(j instanceof Error?j.message:"–í—ä–∑–Ω–∏–∫–Ω–∞ –≥—Ä–µ—à–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞—Ç–∞ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ç–µ.")}finally{x(!1)}},We=async()=>{if(s.length===0)return;if(O!=="7"){f("RTF –æ–±—Ä–∞–±–æ—Ç–∫–∞—Ç–∞ –µ –¥–æ—Å—Ç—ä–ø–Ω–∞ —Å–∞–º–æ –∑–∞ –¥–æ–∫—É–º–µ–Ω—Ç —Ç–∏–ø 7 - –ö–∞—Å–æ–≤–∏ –ø—Ä–æ–¥–∞–∂–±–∏.");return}const t=Ne(Q,se),n=Ce(Y,ne);if(!t){f('–ú–æ–ª—è, –∏–∑–±–µ—Ä–µ—Ç–µ "–í–∏–¥ –Ω–∞ –∞—Ä—Ç–∏–∫—É–ª–∞" –∏–ª–∏ –≤—ä–≤–µ–¥–µ—Ç–µ —Ä—ä—á–Ω–æ —Å—Ç–æ–π–Ω–æ—Å—Ç.');return}if(Y!==G&&!n){f('–ú–æ–ª—è, –∏–∑–±–µ—Ä–µ—Ç–µ "–û–±–µ–∫—Ç–∏" –∏–ª–∏ –≤—ä–≤–µ–¥–µ—Ç–µ —Ä—ä—á–Ω–æ —Å—Ç–æ–π–Ω–æ—Å—Ç.');return}c(!0),N(null),C(null);try{const l=[];for(let o=0;o<s.length;o++){const{file:d}=s[o],m=d.name.toLowerCase().endsWith(".rtf")||d.type==="application/rtf"||d.type==="text/rtf",v=d.name.toLowerCase().endsWith(".doc")||d.name.toLowerCase().endsWith(".docx")||d.type==="application/msword"||d.type==="application/vnd.openxmlformats-officedocument.wordprocessingml.document";if(!m&&!v){f(`–§–∞–π–ª—ä—Ç "${d.name}" –Ω–µ –µ RTF –∏–ª–∏ Word —Ñ–æ—Ä–º–∞—Ç. –ú–æ–ª—è, –∏–∑–±–µ—Ä–µ—Ç–µ .rtf –∏–ª–∏ .doc/.docx —Ñ–∞–π–ª.`);continue}const y=new FileReader,T=await new Promise((F,V)=>{y.onload=j=>{var M;const k=(M=j.target)==null?void 0:M.result;F(k)},y.onerror=V,y.readAsText(d,"utf-8")}),E=Ye(T),$=He(E,O,t,n);l.push(...$)}if(l.length===0)f("–ù–µ –±—è—Ö–∞ –Ω–∞–º–µ—Ä–µ–Ω–∏ –¥–∞–Ω–Ω–∏ –∑–∞ –∏–∑–≤–ª–∏—á–∞–Ω–µ –æ—Ç RTF —Ñ–∞–π–ª–æ–≤–µ—Ç–µ."),C(null);else{const o=`cash_sales_rtf_${Date.now()}.csv`;C({rows:l,fileName:o})}}catch(l){console.error(l),f(l instanceof Error?l.message:"–í—ä–∑–Ω–∏–∫–Ω–∞ –≥—Ä–µ—à–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞—Ç–∞ –Ω–∞ RTF —Ñ–∞–π–ª–æ–≤–µ—Ç–µ.")}finally{c(!1)}},Ge=async()=>{try{if(typeof Excel>"u"){f("Excel –æ–±–∫—Ä—ä–∂–µ–Ω–∏–µ—Ç–æ –Ω–µ –µ –Ω–∞–ª–∏—á–Ω–æ. –¢–∞–∑–∏ —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞–±–æ—Ç–∏ —Å–∞–º–æ –∫–∞—Ç–æ Excel Add-in.");return}await Excel.run(async t=>{var g;const l=t.workbook.worksheets.getActiveWorksheet().getUsedRangeOrNullObject();if(l.load(["isNullObject","values","rowCount","columnCount"]),await t.sync(),l.isNullObject||l.rowCount===0){f("–ù—è–º–∞ –¥–∞–Ω–Ω–∏ –≤ Excel —Ç–∞–±–ª–∏—Ü–∞—Ç–∞ –∑–∞ –µ–∫—Å–ø–æ—Ä—Ç–∏—Ä–∞–Ω–µ.");return}const o=l.values,m=((g=J("4").extractionSettings)==null?void 0:g.delimiter)||";",v=[],y=o[0],E=y&&y.some(h=>typeof h=="string"&&(h.includes("–í–∏–¥")||h.includes("–î–æ–∫—É–º–µ–Ω—Ç")||h.includes("–î–∞—Ç–∞")||h.includes("–ü–∞—Ä—Ç–Ω—å–æ—Ä")))?1:0;for(let h=E;h<o.length;h++){const S=o[h].map(D=>D==null?"":String(D)).join(m);v.push(S)}if(v.length===0){f("–ù—è–º–∞ –¥–∞–Ω–Ω–∏ –∑–∞ –µ–∫—Å–ø–æ—Ä—Ç–∏—Ä–∞–Ω–µ (—Å–∞–º–æ –∑–∞–≥–ª–∞–≤–µ–Ω —Ä–µ–¥).");return}const $=v.join(`\r
`),F=`excel_export_${Date.now()}.csv`,V="\uFEFF",j=new Blob([V+$],{type:"text/csv;charset=utf-8;"}),k=document.createElement("a"),M=URL.createObjectURL(j);k.setAttribute("href",M),k.setAttribute("download",F),k.style.visibility="hidden",document.body.appendChild(k),k.click(),document.body.removeChild(k),URL.revokeObjectURL(M);const i=`–£—Å–ø–µ—Ö! –ï–∫—Å–ø–æ—Ä—Ç–∏—Ä–∞–Ω–∏ ${v.length} —Ä–µ–¥–∞ –≤ ${F}`,b=document.createElement("div");b.className="fixed top-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-50",b.textContent=i,document.body.appendChild(b),setTimeout(()=>{document.body.removeChild(b)},3e3)})}catch(t){console.error(t),f(t instanceof Error?t.message:"–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –µ–∫—Å–ø–æ—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ –æ—Ç Excel.")}},Be=async()=>{if(!(!p||!p.rows.length))try{if(typeof Excel>"u"){f("Excel –æ–±–∫—Ä—ä–∂–µ–Ω–∏–µ—Ç–æ –Ω–µ –µ –Ω–∞–ª–∏—á–Ω–æ. –¢–∞–∑–∏ —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞–±–æ—Ç–∏ —Å–∞–º–æ –∫–∞—Ç–æ Excel Add-in.");return}await Excel.run(async t=>{var k,M;const n=t.workbook.worksheets.getActiveWorksheet(),l=J(O),o=Math.min(l.columns.length,100),d=p.rows,m=d.length;if(m===0){f("–ù—è–º–∞ –¥–∞–Ω–Ω–∏ –∑–∞ –≤–º—ä–∫–≤–∞–Ω–µ.");return}if(m>1e6){f("–¢–≤—ä—Ä–¥–µ –º–Ω–æ–≥–æ —Ä–µ–¥–æ–≤–µ –¥–∞–Ω–Ω–∏. Excel –ø–æ–¥–¥—ä—Ä–∂–∞ –º–∞–∫—Å–∏–º—É–º 1,048,576 —Ä–µ–¥–∞.");return}const v=l.columns.slice(0,o).map(i=>i.name);let y=0,T=!1;const E=n.getUsedRangeOrNullObject();if(E.load(["isNullObject","rowCount","columnCount","rowIndex"]),await t.sync(),E.isNullObject||E.rowCount===0)T=!0,y=1;else{const i=Math.max(3,Math.min(o,E.columnCount||o)),b=n.getRangeByIndexes(0,0,1,i);b.load("values"),await t.sync();const g=(((k=b.values)==null?void 0:k[0])||[]).map(P=>String(P??"").trim());T=!(g[0]===v[0]&&g[1]===v[1]&&g[2]===v[2])&&E.rowCount===0,y=E.rowIndex+E.rowCount}const $=d.map((i,b)=>{const g=[...i];for(;g.length<o;)g.push("");return g.length>o&&(g.length=o),g.map((h,P)=>{if(h==null)return"";const S=String(h);return S.length>32767?(console.warn(`Cell [${b}][${P}] truncated - too long for Excel`),S.substring(0,32767)):P===16?de(S):S})});if(T){const i=n.getRangeByIndexes(0,0,1,o);i.values=[v],i.format.font.bold=!0,i.format.fill.color="#4472C4",i.format.font.color="#FFFFFF",await t.sync(),y=1}const F=n.getRangeByIndexes(y,0,m,o);try{[3,5,6,12].forEach(b=>{if(b<=o){const g=n.getRangeByIndexes(y,b-1,m,1);g.numberFormat="@"}}),await t.sync()}catch(i){console.warn("Could not apply text formatting:",i)}try{F.values=$,await t.sync()}catch(i){throw console.error("Error setting values:",i),new Error("–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –∑–∞–ø–∏—Å–≤–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ –≤ Excel. –ú–æ–ª—è, –ø—Ä–æ–≤–µ—Ä–µ—Ç–µ —Ñ–æ—Ä–º–∞—Ç–∞ –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ.")}try{[15,16,19,20,21,26,27,33,34,35,39,40,41].forEach(b=>{if(b<=o){const g=n.getRangeByIndexes(y,b-1,m,1);g.numberFormat="0.00##########"}}),await t.sync()}catch(i){console.warn("Could not apply money formatting:",i)}try{if(7<=o){const i=n.getRangeByIndexes(y,6,m,1),b=ie.join(",");i.dataValidation.rule={list:{inCellDropDown:!0,source:b}},i.dataValidation.errorAlert={showAlert:!1,title:"–°—Ç–æ–π–Ω–æ—Å—Ç –∏–∑–≤—ä–Ω —Å–ø–∏—Å—ä–∫–∞",message:"–ú–æ–∂–µ—Ç–µ –¥–∞ –≤—ä–≤–µ–¥–µ—Ç–µ —Ä—ä—á–Ω–æ —Å—Ç–æ–π–Ω–æ—Å—Ç –∏–∑–≤—ä–Ω —Å–ø–∏—Å—ä–∫–∞.",style:"information"}}}catch(i){console.warn("Could not add column 7 validation:",i)}try{if(8<=o){const i=n.getRangeByIndexes(y,7,m,1),b=le.join(",");i.dataValidation.rule={list:{inCellDropDown:!0,source:b}},i.dataValidation.errorAlert={showAlert:!1,title:"–°—Ç–æ–π–Ω–æ—Å—Ç –∏–∑–≤—ä–Ω —Å–ø–∏—Å—ä–∫–∞",message:"–ú–æ–∂–µ—Ç–µ –¥–∞ –≤—ä–≤–µ–¥–µ—Ç–µ —Ä—ä—á–Ω–æ —Å—Ç–æ–π–Ω–æ—Å—Ç –∏–∑–≤—ä–Ω —Å–ø–∏—Å—ä–∫–∞.",style:"information"}}}catch(i){console.warn("Could not add column 8 validation:",i)}try{if(17<=o){for(let g=0;g<m;g++){const h=n.getRangeByIndexes(y+g,16,1,1),P=$[g]||[],S=(P[0]??"").toString().trim(),D=rt(P),A=lt(S,D);h.dataValidation.rule={list:{inCellDropDown:!0,source:A}}}await t.sync();const i=n.customProperties;i.load("items"),await t.sync(),((M=i.items)==null?void 0:M.some(g=>g.key==="vat_ddsvid_handler_installed"&&g.value==="1"))||(n.onChanged.add(async g=>{try{if(!g.address)return;await Excel.run(async h=>{var L,W;const S=h.workbook.worksheets.getActiveWorksheet().getRange(g.address);if(S.load(["columnIndex","values"]),await h.sync(),S.columnIndex!==16)return;const D=(W=(L=S.values)==null?void 0:L[0])==null?void 0:W[0],A=de(D);A&&A!==D&&ot.has(A)&&(S.values=[[A]],await h.sync())})}catch(h){console.warn("VAT onChanged handler error:",h)}}),i.add("vat_ddsvid_handler_installed","1"),await t.sync())}}catch(i){console.warn("Could not add column 17 validation:",i)}try{F.format.autofitColumns(),await t.sync()}catch(i){console.warn("Could not autofit columns:",i)}pe(y+1),xe(m),O==="4"&&oe(!0);const V=`–£—Å–ø–µ—Ö! ${m} —Ä–µ–¥–∞ —Å–∞ –¥–æ–±–∞–≤–µ–Ω–∏ –Ω–∞ —Ä–µ–¥ ${y+1}.`,j=document.createElement("div");j.className="fixed top-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-50",j.textContent=V,document.body.appendChild(j),setTimeout(()=>{document.body.removeChild(j)},3e3)})}catch(t){console.error(t),f(t instanceof Error?t.message:"–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –≤–º—ä–∫–≤–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ –≤ Excel.")}},Ue=(t,n,l)=>{C(o=>{if(!o)return o;const d=o.rows.map((m,v)=>v===t?[...m]:m);if(!d[t])return o;for(;d[t].length<=n;)d[t].push("");return d[t][n]=l,{...o,rows:d}})},ze=async()=>{try{const t=Ze(R);if(!t.valid){f(t.errors.join(`
`));return}const n=await st(Oe,Ie);if(n.length===0){f("–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ —á–µ—Ç–µ–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏ –æ—Ç Excel");return}const l=tt(n,R);await nt(l),re(!1),oe(!1);const o=`–£—Å–ø–µ—Ö! ${l.length} —Ä–µ–¥–∞ —Å–∞ –¥–æ–±–∞–≤–µ–Ω–∏ –∫–∞—Ç–æ –ø—Ä–æ–¥–∞–∂–±–∏.`,d=document.createElement("div");d.className="fixed top-4 right-4 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg z-50",d.textContent=o,document.body.appendChild(d),setTimeout(()=>{document.body.removeChild(d)},3e3)}catch(t){console.error(t),f(t instanceof Error?t.message:"–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ.")}};return te?e.jsx("div",{className:"max-w-xl mx-auto p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞ Gemini API"}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"–í—ä–≤–µ–¥–µ—Ç–µ Gemini API –∫–ª—é—á. –ö–ª—é—á—ä—Ç —Å–µ –∑–∞–ø–∞–∑–≤–∞ –≤ roaming settings (–≤ Excel) –∏–ª–∏ –≤ localStorage (–≤ –±—Ä–∞—É–∑—ä—Ä–∞)."}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-white font-medium mb-2",children:"Gemini API –∫–ª—é—á:"}),e.jsx("input",{type:"password",value:_,onChange:t=>z(t.target.value),className:"w-full px-3 py-2 rounded bg-gray-700 text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("button",{onClick:()=>ye(_,I),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-medium",children:"–ó–∞–ø–∞–∑–∏"}),_&&e.jsx("button",{onClick:()=>K(!1),className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg text-sm font-medium",children:"–ü—Ä–æ–¥—ä–ª–∂–∏"})]})]})}):e.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 shadow-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("div",{children:e.jsx("h2",{className:"text-2xl font-bold text-white",children:"–ò–∑–≤–ª–∏—á–∞–Ω–µ –Ω–∞ –¥–∞–Ω–Ω–∏ –æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∏"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative model-selector-container",children:[e.jsxs("button",{onClick:()=>q(!X),className:"text-sm text-blue-400 hover:text-blue-300 flex items-center gap-1",children:["ü§ñ"," ",I==="gemini-2.0-flash"?"Gemini 2.0 Flash":I==="gemini-2.5-flash"?"Gemini 2.5 Flash":"Gemini 2.5 Pro",e.jsx("span",{className:"text-xs",children:"‚ñº"})]}),X&&e.jsx("div",{className:"absolute right-0 top-full mt-1 bg-gray-700 border border-gray-600 rounded-lg shadow-lg z-50 min-w-[200px]",children:e.jsxs("div",{className:"p-2",children:[e.jsx("div",{className:"text-xs text-gray-300 mb-2 font-medium",children:"–ò–∑–±–µ—Ä–µ—Ç–µ –º–æ–¥–µ–ª:"}),[{value:"gemini-2.0-flash",label:"Gemini 2.0 Flash ‚Äì –±—ä—Ä–∑ –∏ –µ–≤—Ç–∏–Ω"},{value:"gemini-2.5-flash",label:"Gemini 2.5 Flash ‚Äì –ø–æ–¥–æ–±—Ä–µ–Ω–∞ —Ç–æ—á–Ω–æ—Å—Ç"},{value:"gemini-2.5-pro",label:"Gemini 2.5 Pro ‚Äì –Ω–∞–π-—Ç–æ—á–µ–Ω"}].map(t=>e.jsx("button",{onClick:()=>{const n=t.value;U(n),ye(_,n),q(!1)},className:`w-full text-left px-3 py-2 text-xs rounded hover:bg-gray-600 transition-colors ${I===t.value?"bg-blue-600 text-white":"text-gray-300"}`,children:t.label},t.value))]})})]}),e.jsx("button",{onClick:()=>K(!0),className:"text-sm text-blue-400 hover:text-blue-300",children:"‚öôÔ∏è API –Ω–∞—Å—Ç—Ä–æ–π–∫–∏"})]})]}),e.jsx("p",{className:"text-gray-400 mb-6",children:"–ö–∞—á–µ—Ç–µ –µ–¥–∏–Ω –∏–ª–∏ –ø–æ–≤–µ—á–µ PDF/–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å —Ñ–∞–∫—Ç—É—Ä–∏. –î–∞–Ω–Ω–∏—Ç–µ —â–µ –±—ä–¥–∞—Ç –ø—Ä–µ–æ–±—Ä–∞–∑—É–≤–∞–Ω–∏ –¥–æ —Ä–µ–¥–æ–≤–µ, –≥–æ—Ç–æ–≤–∏ –∑–∞ –≤–º—ä–∫–≤–∞–Ω–µ –≤ Excel."}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-white font-medium mb-2",children:["–¢–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç: ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("select",{value:O,onChange:t=>Re(t.target.value),className:"w-full px-4 py-3 bg-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:a,children:[e.jsx("option",{value:"1",children:"1 - –§–∞–∫—Ç—É—Ä–∞ –ø—Ä–æ–¥–∞–∂–±–∞"}),e.jsx("option",{value:"2",children:"2 - –î–µ–±–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø—Ä–æ–¥–∞–∂–±–∞"}),e.jsx("option",{value:"3",children:"3 - –ö—Ä–µ–¥–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø—Ä–æ–¥–∞–∂–±–∞"}),e.jsx("option",{value:"4",children:"4 - –§–∞–∫—Ç—É—Ä–∞ –ø–æ–∫—É–ø–∫–∞"}),e.jsx("option",{value:"5",children:"5 - –î–µ–±–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø–æ–∫—É–ø–∫–∞"}),e.jsx("option",{value:"6",children:"6 - –ö—Ä–µ–¥–∏—Ç–Ω–æ –∏–∑–≤–µ—Å—Ç–∏–µ –ø–æ–∫—É–ø–∫–∞"}),e.jsx("option",{value:"7",children:"7 - –ö–∞—Å–æ–≤–∏ –ø—Ä–æ–¥–∞–∂–±–∏"}),e.jsx("option",{value:"8",children:"8 - –¢—Ä–∞–Ω—Å—Ñ–µ—Ä"}),e.jsx("option",{value:"9",children:"9 - –ë—Ä–∞–∫ (–†–ê–ó–•–û–î)"}),e.jsx("option",{value:"10",children:"10 - –ë—Ä–∞–∫ (–ú–û–õ)"}),e.jsx("option",{value:"11",children:"11 - –°–∫–ª–∞–¥–æ–≤–æ –∏—Å–∫–∞–Ω–µ"}),e.jsx("option",{value:"12",children:"12 - –°—Ç–æ–∫–æ–≤–∞ —Ä–∞–∑–ø–∏—Å–∫–∞ (–°–¢)"}),e.jsx("option",{value:"13",children:"13 - –°–∫–ª–∞–¥–æ–≤–∞ —Ä–∞–∑–ø–∏—Å–∫–∞ (–°–†)"}),e.jsx("option",{value:"14",children:"14 - –î–∞–≤–∞–Ω–µ —Å—Ç–æ–∫–∏ –Ω–∞ –∫–æ–Ω—Å–∏–≥–Ω–∞—Ü–∏—è (–ö–î) —Å—ä—Å —Å—á–µ—Ç. –æ–ø–µ—Ä–∞—Ü–∏–∏"}),e.jsx("option",{value:"15",children:"15 - –î–∞–≤–∞–Ω–µ —Å—Ç–æ–∫–∏ –Ω–∞ –∫–æ–Ω—Å–∏–≥–Ω–∞—Ü–∏—è (–ö–î) –±–µ–∑ —Å—á–µ—Ç. –æ–ø–µ—Ä–∞—Ü–∏–∏"})]}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"–ò–∑–±–µ—Ä–µ—Ç–µ —Ç–∏–ø–∞ –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞. –ù–æ–º–µ—Ä—ä—Ç —â–µ –±—ä–¥–µ –ø–æ—Å—Ç–∞–≤–µ–Ω –≤ –ø—ä—Ä–≤–∞—Ç–∞ –∫–æ–ª–æ–Ω–∞ –Ω–∞ –≤—Å–µ–∫–∏ —Ä–µ–¥."})]}),e.jsxs("div",{className:"mb-6 grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-white font-medium mb-1 text-sm",children:["–û–±–µ–∫—Ç–∏: ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("select",{value:Y,onChange:t=>{const n=t.target.value;Fe(n),n!==G&&he("")},className:"w-full px-3 py-2 bg-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",disabled:a,children:[ie.map(t=>e.jsx("option",{value:t,children:t},t)),e.jsx("option",{value:G,children:"–î—Ä—É–≥–æ (—Ä—ä—á–Ω–æ)‚Ä¶"})]}),Y===G&&e.jsx("input",{value:ne,onChange:t=>he(t.target.value),placeholder:"–í—ä–≤–µ–¥–µ—Ç–µ —Ä—ä—á–Ω–æ –æ–±–µ–∫—Ç‚Ä¶",className:"mt-2 w-full px-3 py-2 bg-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",disabled:a}),e.jsx("p",{className:"text-gray-400 text-xs mt-1",children:"–°—Ç–æ–π–Ω–æ—Å—Ç—Ç–∞ —â–µ –±—ä–¥–µ –ø–æ—Å—Ç–∞–≤–µ–Ω–∞ –≤ –∫–æ–ª–æ–Ω–∞ 7 –Ω–∞ –≤—Å–µ–∫–∏ —Ä–µ–¥."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-white font-medium mb-1 text-sm",children:["–í–∏–¥ –Ω–∞ –∞—Ä—Ç–∏–∫—É–ª–∞: ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("select",{value:Q,onChange:t=>{const n=t.target.value;_e(n),n!==G&&ge("")},className:"w-full px-3 py-2 bg-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",disabled:a,children:[le.map(t=>e.jsx("option",{value:t,children:t},t)),e.jsx("option",{value:G,children:"–î—Ä—É–≥–æ (—Ä—ä—á–Ω–æ)‚Ä¶"})]}),Q===G&&e.jsx("input",{value:se,onChange:t=>ge(t.target.value),placeholder:"–í—ä–≤–µ–¥–µ—Ç–µ —Ä—ä—á–Ω–æ –≤–∏–¥ –Ω–∞ –∞—Ä—Ç–∏–∫—É–ª–∞‚Ä¶",className:"mt-2 w-full px-3 py-2 bg-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",disabled:a}),e.jsx("p",{className:"text-gray-400 text-xs mt-1",children:"–°—Ç–æ–π–Ω–æ—Å—Ç—Ç–∞ —â–µ –±—ä–¥–µ –ø–æ—Å—Ç–∞–≤–µ–Ω–∞ –≤ –∫–æ–ª–æ–Ω–∞ 8 (–í–∏–¥) –Ω–∞ –≤—Å–µ–∫–∏ —Ä–µ–¥."})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("input",{ref:Z,type:"file",multiple:!0,accept:"image/*,.pdf,.rtf,.doc,.docx",onChange:Le,className:"hidden"}),e.jsx("button",{onClick:()=>{var t;return(t=Z.current)==null?void 0:t.click()},disabled:a||u,className:"w-full py-3 px-4 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-colors",children:s.length>0?"–î–æ–±–∞–≤–∏ –æ—â–µ —Ñ–∞–π–ª–æ–≤–µ":"–ò–∑–±–µ—Ä–∏ —Ñ–∞–π–ª–æ–≤–µ"})]}),s.length>0&&e.jsxs("div",{className:"mb-6 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"text-white font-medium",children:["–ò–∑–±—Ä–∞–Ω–∏ —Ñ–∞–π–ª–æ–≤–µ (",s.length,")"]}),e.jsx("button",{onClick:be,className:"text-red-400 hover:text-red-300 text-sm",children:"–ò–∑—á–∏—Å—Ç–∏ –≤—Å–∏—á–∫–∏"})]}),s.map((t,n)=>e.jsxs("div",{className:"p-4 bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:t.file.name}),e.jsxs("p",{className:"text-gray-400 text-sm",children:[(t.file.size/1024).toFixed(2)," KB"]})]}),e.jsx("button",{onClick:()=>Pe(n),className:"text-red-400 hover:text-red-300 text-sm",children:"–ü—Ä–µ–º–∞—Ö–Ω–∏"})]}),t.preview&&e.jsx("img",{src:t.preview,alt:"Preview",className:"max-w-full max-h-48 rounded-lg mx-auto"})]},n))]}),s.length>0&&!p&&e.jsxs(e.Fragment,{children:[O==="7"&&s.some(t=>t.file.name.toLowerCase().endsWith(".rtf")||t.file.name.toLowerCase().endsWith(".doc")||t.file.name.toLowerCase().endsWith(".docx"))?e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 mb-6",children:[e.jsx("button",{onClick:We,disabled:a||u,className:"py-3 px-4 bg-green-600 hover:bg-green-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-colors",children:u?"–û–±—Ä–∞–±–æ—Ç–≤–∞ RTF...":"üîß –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∏–∑–≤–ª–∏—á–∞–Ω–µ"}),e.jsx("button",{onClick:we,disabled:a||u,className:"py-3 px-4 bg-orange-600 hover:bg-orange-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-colors",children:a?"–û–±—Ä–∞–±–æ—Ç–≤–∞ AI...":"ü§ñ AI –∏–∑–≤–ª–∏—á–∞–Ω–µ"})]}):e.jsx("button",{onClick:we,disabled:a||u,className:"w-full py-3 px-4 bg-green-600 hover:bg-green-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-colors mb-6",children:a?"–û–±—Ä–∞–±–æ—Ç–≤–∞ —Å–µ‚Ä¶":"–ò–∑–≤–ª–µ—á–∏ –¥–∞–Ω–Ω–∏"}),O==="7"&&s.some(t=>t.file.name.toLowerCase().endsWith(".rtf")||t.file.name.toLowerCase().endsWith(".doc")||t.file.name.toLowerCase().endsWith(".docx"))&&e.jsxs("div",{className:"mb-6 p-4 bg-blue-900/30 border border-blue-500 rounded-lg",children:[e.jsxs("p",{className:"text-blue-200 text-sm",children:[e.jsx("strong",{children:"üîß –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∏–∑–≤–ª–∏—á–∞–Ω–µ:"})," –ë—ä—Ä–∑–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ RTF —Ç–∞–±–ª–∏—Ü–∏ –±–µ–∑ –∏–∑–ø–æ–ª–∑–≤–∞–Ω–µ –Ω–∞ AI –º–æ–¥–µ–ª–∏."]}),e.jsxs("p",{className:"text-blue-200 text-sm mt-1",children:[e.jsx("strong",{children:"ü§ñ AI –∏–∑–≤–ª–∏—á–∞–Ω–µ:"})," –ò–∑–ø–æ–ª–∑–≤–∞ AI –º–æ–¥–µ–ª–∏ –∑–∞ –ø–æ-—Å–ª–æ–∂–Ω–∏ —Å–ª—É—á–∞–∏, –Ω–æ –º–æ–∂–µ –¥–∞ –∏–º–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø—Ä–∏ –≥–æ–ª–µ–º–∏ —Ñ–∞–π–ª–æ–≤–µ."]})]})]}),p&&e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"p-4 bg-green-900/30 border border-green-500 rounded-lg",children:[e.jsx("p",{className:"text-green-200 font-medium",children:"‚úì –î–∞–Ω–Ω–∏—Ç–µ —Å–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏ —É—Å–ø–µ—à–Ω–æ!"}),e.jsxs("p",{className:"text-green-200 text-sm mt-1",children:["–ò–∑–≤–ª–µ—á–µ–Ω–∏ —Ä–µ–¥–æ–≤–µ: ",p.rows.length]})]}),e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-white font-medium mb-3",children:"–ü—Ä–µ–≥–ª–µ–¥ –Ω–∞ –¥–∞–Ω–Ω–∏—Ç–µ (—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º–æ):"}),e.jsx("div",{className:"overflow-x-auto max-h-96 overflow-y-auto",children:e.jsxs("table",{className:"text-xs text-gray-300 w-full border-collapse",children:[e.jsx("thead",{className:"sticky top-0 bg-gray-800",children:e.jsx("tr",{children:J(O).columns.slice(0,Math.max(...p.rows.map(t=>t.length))).map((t,n)=>e.jsx("th",{className:"border border-gray-600 px-2 py-2 text-left font-medium bg-gray-800",children:t.name},n))})}),e.jsx("tbody",{children:p.rows.map((t,n)=>e.jsxs("tr",{className:n%2===0?"bg-gray-800":"bg-gray-750",children:[t.map((l,o)=>e.jsx("td",{className:"border border-gray-600 px-1 py-1",children:e.jsx("input",{value:l??"",onChange:d=>Ue(n,o,d.target.value),className:"w-full bg-transparent text-gray-200 text-xs outline-none",title:l})},o)),Array.from({length:Math.max(...p.rows.map(l=>l.length))-t.length}).map((l,o)=>e.jsx("td",{className:"border border-gray-600 px-2 py-1",children:"-"},`empty-${o}`))]},n))})]})}),e.jsx("p",{className:"text-gray-400 text-xs mt-2",children:"–ú–æ–∂–µ—Ç–µ –¥–∞ –∫–æ—Ä–∏–≥–∏—Ä–∞—Ç–µ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ –¥–∏—Ä–µ–∫—Ç–Ω–æ –≤ —Ç–∞–±–ª–∏—Ü–∞—Ç–∞ –ø—Ä–µ–¥–∏ –≤–º—ä–∫–≤–∞–Ω–µ –≤ Excel."})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx("button",{onClick:Be,className:"flex-1 min-w-[150px] py-3 px-4 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:"üìã –í–º—ä–∫–Ω–∏ –≤ Excel"}),Ve&&O==="4"&&e.jsx("button",{onClick:()=>re(!fe),className:"flex-1 min-w-[150px] py-3 px-4 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-medium transition-colors",children:"üîÑ –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–∞–π –≤ –ø—Ä–æ–¥–∞–∂–±–∞"}),e.jsx("button",{onClick:Ge,className:"flex-1 min-w-[150px] py-3 px-4 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium transition-colors",children:"üíæ –ó–∞–ø–∞–∑–∏ –∫–∞—Ç–æ CSV"}),e.jsx("button",{onClick:be,className:"flex-1 min-w-[150px] py-3 px-4 bg-gray-700 hover:bg-gray-800 text-white rounded-lg font-medium transition-colors",children:"üîÑ –ù–æ–≤ –∞–Ω–∞–ª–∏–∑"})]}),fe&&e.jsxs("div",{className:"mt-4 p-4 bg-gray-700 rounded-lg",children:[e.jsx("h3",{className:"text-white font-medium mb-3",children:"–î–∞–Ω–Ω–∏ –∑–∞ –ø—Ä–æ–¥–∞–∂–±–∞—Ç–∞:"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 mb-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-white text-sm mb-1",children:["–ù–æ–º–µ—Ä: ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",value:R.documentNumber,onChange:t=>H({...R,documentNumber:t.target.value}),className:"w-full px-3 py-2 bg-gray-600 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"–ù–æ–º–µ—Ä –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-white text-sm mb-1",children:["–ü–∞—Ä—Ç–Ω—å–æ—Ä: ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",value:R.partnerName,onChange:t=>H({...R,partnerName:t.target.value}),className:"w-full px-3 py-2 bg-gray-600 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"–ò–º–µ –Ω–∞ –ø–∞—Ä—Ç–Ω—å–æ—Ä–∞"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-white text-sm mb-1",children:"–ï–ò–ö:"}),e.jsx("input",{type:"text",value:R.partnerEIK,onChange:t=>H({...R,partnerEIK:t.target.value}),className:"w-full px-3 py-2 bg-gray-600 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"–ï–ò–ö (–æ–ø—Ü–∏–æ–Ω–∞–ª–Ω–æ)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-white text-sm mb-1",children:"–ò–ù –ø–æ –î–î–°:"}),e.jsx("input",{type:"text",value:R.partnerVAT,onChange:t=>H({...R,partnerVAT:t.target.value}),className:"w-full px-3 py-2 bg-gray-600 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"–ò–ù –ø–æ –î–î–° (–æ–ø—Ü–∏–æ–Ω–∞–ª–Ω–æ)"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-white text-sm mb-1",children:["–î–∞—Ç–∞: ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",value:R.documentDate,onChange:t=>H({...R,documentDate:t.target.value}),className:"w-full px-3 py-2 bg-gray-600 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"dd.mm.yyyy"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-white text-sm mb-1",children:["–ù–∞–¥—Ü–µ–Ω–∫–∞ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç: ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"number",value:R.profitMarkupPercent,onChange:t=>H({...R,profitMarkupPercent:parseFloat(t.target.value)||0}),className:"w-full px-3 py-2 bg-gray-600 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"40",min:"0",step:"0.1"})]})]}),e.jsx("button",{onClick:ze,className:"w-full py-3 px-4 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-medium transition-colors",children:"‚úì –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–∞–π"})]})]})]}),e.jsxs("div",{className:"mt-6 p-4 bg-gray-800 rounded-lg",children:[e.jsx("h3",{className:"text-white font-medium mb-2",children:"–ü–æ–¥–¥—ä—Ä–∂–∞–Ω–∏ —Ñ–æ—Ä–º–∞—Ç–∏:"}),e.jsxs("ul",{className:"text-gray-400 text-sm space-y-1",children:[e.jsx("li",{children:"‚Ä¢ PDF –¥–æ–∫—É–º–µ–Ω—Ç–∏"}),e.jsx("li",{children:"‚Ä¢ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (JPG, PNG, WEBP)"}),e.jsx("li",{children:"‚Ä¢ RTF —Ñ–∞–π–ª–æ–≤–µ (–∑–∞ –∫–∞—Å–æ–≤–∏ –ø—Ä–æ–¥–∞–∂–±–∏)"}),e.jsx("li",{children:"‚Ä¢ Word –¥–æ–∫—É–º–µ–Ω—Ç–∏ (.doc, .docx)"}),e.jsx("li",{children:"‚Ä¢ –§–∞–∫—Ç—É—Ä–∏ –∑–∞ —É—Å–ª—É–≥–∏"}),e.jsx("li",{children:"‚Ä¢ –ú–Ω–æ–∂–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤–µ –Ω–∞–≤–µ–¥–Ω—ä–∂"})]})]}),ke&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4 shadow-xl",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-red-600 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-sm font-bold",children:"!"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("h3",{className:"text-lg font-medium text-white",children:"–ì—Ä–µ—à–∫–∞"})})]}),e.jsx("div",{className:"mb-6",children:e.jsx("p",{className:"text-gray-300 text-sm",children:B})}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:Me,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:"–ó–∞—Ç–≤–æ—Ä–∏"})})]})})]})},ct=qe.createRoot(document.getElementById("root"));ct.render(e.jsx(Qe.StrictMode,{children:e.jsx("div",{className:"bg-gray-900 text-gray-200 h-full antialiased overflow-y-auto",children:e.jsx(it,{})})}));
